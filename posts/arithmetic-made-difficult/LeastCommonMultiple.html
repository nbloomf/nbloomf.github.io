<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>nbloomf.blog - Least Common Multiple</title>
<link rel="stylesheet" type="text/css" href="../../css/default.css" />
<link rel="icon" href="../../raw/gfx/icon/favicon-32.png" />
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../raw/gfx/icon/favicon-57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../raw/gfx/icon/favicon-114.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../raw/gfx/icon/favicon-152.png" />
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>

<body>
<div id="header">
  <div id="logo">
    <a href="../../index.html">nbloomf</a>
  </div>
  <div id="navigation">
    <a href="../../index.html">Home</a>
    <a href="../../pages/about.html">About</a>
    <a href="../../pages/projects.html">Projects</a>
    <a href="../../archive.html">Blog</a>
  </div>
</div>

<div id="content">
<h1>Least Common Multiple</h1>
<!-- BEGIN BODY -->


<div class="info">
Posted on 2017-04-12 by nbloomf
</div>


<div class="info tags">Tags: <a href="../../tag/arithmetic-made-difficult.html">arithmetic-made-difficult</a>, <a href="../../tag/literate-haskell.html">literate-haskell</a></div>


<!-- LaTeX Macros for Arithmetic Made Difficult -->
<div class="invisible">
<!-- basic maps -->
\(\newcommand{\id}{\mathsf{id}}\)
\(\newcommand{\const}{\mathsf{const}}\)

<!-- booleans -->
\(\newcommand{\bool}{\mathbb{B}}\)
\(\newcommand{\btrue}{\mathsf{true}}\)
\(\newcommand{\bfalse}{\mathsf{false}}\)
\(\newcommand{\bnot}{\mathsf{not}}\)
\(\newcommand{\band}{\mathbin{\mathsf{and}}}\)
\(\newcommand{\bor}{\mathbin{\mathsf{or}}}\)
\(\newcommand{\bimpl}{\mathbin{\mathsf{impl}}}\)
\(\newcommand{\beq}{\mathsf{eq}}\)
\(\newcommand{\bif}[3]{\mathsf{if}\left(#1,#2,#3\right)}\)

<!-- predicates -->
\(\newcommand{\ptrue}{\mathsf{ptrue}}\)
\(\newcommand{\pfalse}{\mathsf{pfalse}}\)
\(\newcommand{\pnot}{\mathsf{pnot}}\)
\(\newcommand{\pand}{\mathbin{\mathsf{pand}}}\)
\(\newcommand{\por}{\mathbin{\mathsf{por}}}\)
\(\newcommand{\pimpl}{\mathbin{\mathsf{pimpl}}}\)

<!-- tuples -->
\(\newcommand{\fst}{\mathsf{first}}\)
\(\newcommand{\snd}{\mathsf{second}}\)
\(\newcommand{\dup}{\mathsf{dup}}\)
\(\newcommand{\tSwap}{\mathsf{swap}_{\times}}\)
\(\newcommand{\tPair}{\mathsf{pair}_{\times}}\)
\(\newcommand{\tAssocL}{\mathsf{assocL}_{\times}}\)
\(\newcommand{\tAssocR}{\mathsf{assocR}_{\times}}\)
\(\newcommand{\tupL}{\mathsf{tupL}}\)
\(\newcommand{\tupR}{\mathsf{tupR}}\)

<!-- disjoint unions -->
\(\newcommand{\lft}{\mathsf{left}}\)
\(\newcommand{\rgt}{\mathsf{right}}\)
\(\newcommand{\either}{\mathsf{either}}\)
\(\newcommand{\uSwap}{\mathsf{swap}_{+}}\)
\(\newcommand{\uPair}{\mathsf{pair}_{+}}\)
\(\newcommand{\uAssocL}{\mathsf{assocL}_{+}}\)
\(\newcommand{\uAssocR}{\mathsf{assocR}_{+}}\)
\(\newcommand{\isLft}{\mathsf{isLeft}}\)
\(\newcommand{\isRgt}{\mathsf{isRight}}\)

<!-- natural numbers -->
\(\newcommand{\nats}{\mathbb{N}}\)
\(\newcommand{\zero}{\mathsf{0}}\)
\(\newcommand{\next}{\mathsf{next}}\)
\(\newcommand{\unnext}{\mathsf{unnext}}\)
\(\newcommand{\iszero}{\mathsf{isZero}}\)
\(\newcommand{\prev}{\mathsf{prev}}\)

<!-- natural number recursion -->
\(\newcommand{\natrec}[2]{\mathsf{natrec}(#1,#2)}\)
\(\newcommand{\simprec}[2]{\mathsf{simprec}(#1,#2)}\)
\(\newcommand{\bailrec}[4]{\mathsf{bailrec}(#1,#2,#3,#4)}\)
\(\newcommand{\mutrec}[3]{\mathsf{mutrec}(#1,#2,#3)}\)
\(\newcommand{\dnatrec}[3]{\mathsf{dnatrec}(#1,#2,#3)}\)
\(\newcommand{\normrec}[3]{\mathsf{normrec}(#1,#2,#3)}\)
\(\newcommand{\findsmallest}[1]{\mathsf{findsmallest}(#1)}\)

<!-- natural number arithmetic -->
\(\newcommand{\nequal}{\mathsf{eq}}\)
\(\newcommand{\nplus}{\mathsf{plus}}\)
\(\newcommand{\ntimes}{\mathsf{times}}\)
\(\newcommand{\nleq}{\mathsf{leq}}\)
\(\newcommand{\ngeq}{\mathsf{geq}}\)
\(\newcommand{\nminus}{\mathsf{minus}}\)
\(\newcommand{\nmax}{\mathsf{max}}\)
\(\newcommand{\nmin}{\mathsf{min}}\)
\(\newcommand{\ndivalg}{\mathsf{divalg}}\)
\(\newcommand{\nquo}{\mathsf{quo}}\)
\(\newcommand{\nrem}{\mathsf{rem}}\)
\(\newcommand{\ndiv}{\mathsf{div}}\)
\(\newcommand{\ngcd}{\mathsf{gcd}}\)
\(\newcommand{\ncoprime}{\mathsf{coprime}}\)
\(\newcommand{\nlcm}{\mathsf{lcm}}\)
\(\newcommand{\nmindiv}{\mathsf{mindiv}}\)
\(\newcommand{\nisprime}{\mathsf{isPrime}}\)
\(\newcommand{\npower}{\mathsf{power}}\)
\(\newcommand{\nchoose}{\mathsf{choose}}\)

<!-- categories -->
\(\newcommand{\dom}{\mathsf{dom}}\)
\(\newcommand{\cod}{\mathsf{cod}}\)

<!-- lists -->
\(\newcommand{\lists}[1]{\mathsf{List}(#1)}\)
\(\newcommand{\nil}{\mathsf{nil}}\)
\(\newcommand{\cons}{\mathsf{cons}}\)
\(\newcommand{\uncons}{\mathsf{uncons}}\)
\(\newcommand{\isnil}{\mathsf{isNil}}\)
\(\newcommand{\tail}{\mathsf{tail}}\)
\(\newcommand{\head}{\mathsf{head}}\)

<!-- list recursion -->
\(\newcommand{\foldr}[2]{\mathsf{foldr}(#1,#2)}\)
\(\newcommand{\foldl}[1]{\mathsf{foldl}(#1)}\)
\(\newcommand{\tacunfoldN}[1]{\mathsf{tacunfoldN}(#1)}\)
\(\newcommand{\unfoldN}[1]{\mathsf{unfoldN}(#1)}\)
\(\newcommand{\dfoldr}[3]{\mathsf{dfoldr}(#1,#2,#3)}\)
\(\newcommand{\cfoldr}[2]{\mathsf{cfoldr}(#1,#2)}\)
\(\newcommand{\bfoldr}[4]{\mathsf{bfoldr}(#1,#2,#3,#4)}\)
\(\newcommand{\dbfoldr}[5]{\mathsf{dbfoldr}(#1,#2,#3,#4,#5)}\)

<!-- list arithmetic -->
\(\newcommand{\snoc}{\mathsf{snoc}}\)
\(\newcommand{\revcat}{\mathsf{revcat}}\)
\(\newcommand{\rev}{\mathsf{rev}}\)
\(\newcommand{\cat}{\mathsf{cat}}\)
\(\newcommand{\addlength}{\mathsf{addlength}}\)
\(\newcommand{\length}{\mathsf{length}}\)
\(\newcommand{\head}{\mathsf{head}}\)
\(\newcommand{\at}{\mathsf{at}}\)
\(\newcommand{\map}{\mathsf{map}}\)
\(\newcommand{\range}{\mathsf{range}}\)
\(\newcommand{\zip}{\mathsf{zip}}\)
\(\newcommand{\zipPad}{\mathsf{zipPad}}\)
\(\newcommand{\unzip}{\mathsf{unzip}}\)
\(\newcommand{\prefix}{\mathsf{prefix}}\)
\(\newcommand{\suffix}{\mathsf{suffix}}\)
\(\newcommand{\lcp}{\mathsf{lcp}}\)
\(\newcommand{\lcs}{\mathsf{lcs}}\)
\(\newcommand{\all}{\mathsf{all}}\)
\(\newcommand{\any}{\mathsf{any}}\)
\(\newcommand{\tails}{\mathsf{tails}}\)
\(\newcommand{\inits}{\mathsf{inits}}\)
\(\newcommand{\filter}{\mathsf{filter}}\)
\(\newcommand{\elt}{\mathsf{elt}}\)
\(\newcommand{\addcount}{\mathsf{addcount}}\)
\(\newcommand{\count}{\mathsf{count}}\)
\(\newcommand{\repeat}{\mathsf{repeat}}\)
\(\newcommand{\sublist}{\mathsf{sublist}}\)
\(\newcommand{\infix}{\mathsf{infix}}\)
\(\newcommand{\select}{\mathsf{select}}\)
\(\newcommand{\unique}{\mathsf{unique}}\)
\(\newcommand{\delete}{\mathsf{delete}}\)
\(\newcommand{\dedupeL}{\mathsf{dedupeL}}\)
\(\newcommand{\dedupeR}{\mathsf{dedupeR}}\)
\(\newcommand{\take}{\mathsf{take}}\)
\(\newcommand{\drop}{\mathsf{drop}}\)
\(\newcommand{\takeBut}{\mathsf{takeBut}}\)
\(\newcommand{\dropBut}{\mathsf{dropBut}}\)
\(\newcommand{\takeWhile}{\mathsf{takeWhile}}\)
\(\newcommand{\dropWhile}{\mathsf{dropWhile}}\)
</div>
<!-- End LaTeX Macros for Arithmetic Made Difficult -->

<p class="post-info">This page is part of a series on <a href="../../pages/amd.html">Arithmetic Made Difficult</a>.</p>

<p class="post-info">This post is literate Haskell; you can load <a href="https://raw.githubusercontent.com/nbloomf/nbloomf.md/master/posts/arithmetic-made-difficult/LeastCommonMultiple.lhs">the source</a> into GHCi and play along.</p>

<hr />

<div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">module</span> <span class="dt">LeastCommonMultiple</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  ( lcm, _test_lcm, main_lcm</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  ) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">import</span> <span class="dt">Prelude</span> ()</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">import</span> <span class="dt">Booleans</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">import</span> <span class="dt">NaturalNumbers</span></a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">import</span> <span class="dt">Plus</span></a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">import</span> <span class="dt">Times</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">import</span> <span class="dt">Minus</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">import</span> <span class="dt">LessThanOrEqualTo</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">import</span> <span class="dt">DivisionAlgorithm</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"><span class="kw">import</span> <span class="dt">Divides</span></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="kw">import</span> <span class="dt">GreatestCommonDivisor</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15"><span class="kw">import</span> <span class="dt">CoprimeTo</span></a></code></pre></div>
<p>Recall the following property of <span class="math inline">\(\nmax\)</span>: if <span class="math inline">\(\nleq(c,a)\)</span> and <span class="math inline">\(\nleq(c,b)\)</span>, then <span class="math inline">\(\nleq(c,\nmax(a,b))\)</span>. This statement fell out of the definition of <span class="math inline">\(\nmax\)</span> without much fuss, and may seem anticlimactic. But compare it to this analogous statement about <span class="math inline">\(\ngcd\)</span>: if <span class="math inline">\(\ndiv(c,a)\)</span> and <span class="math inline">\(\ndiv(c,b)\)</span>, then <span class="math inline">\(\ndiv(c,\ngcd(a,b))\)</span>. Now <span class="math inline">\(\nmax\)</span> and <span class="math inline">\(\ngcd\)</span> seem to play very similar roles. Where <span class="math inline">\(\nleq\)</span> is a kind of “additive order” on <span class="math inline">\(\nats\)</span> and <span class="math inline">\(\nmax\)</span> gives an additive ceiling to <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>, <span class="math inline">\(\ndiv\)</span> is a kind of “multiplicative order” and <span class="math inline">\(\ngcd\)</span> gives a multiplicative ceiling to <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>. When an analogy this strong holds between two concepts in mathematics, it is frequently useful to see how far the analogy goes. To that end, today we will define the multiplicative counterpart to <span class="math inline">\(\nmin\)</span>.</p>
<p>We don’t need recursion for this.</p>
<div class="result">
<div class="defn">
<p>
<p>Define <span class="math inline">\(\nlcm : \nats \times \nats \rightarrow \nats\)</span> by <span class="math display">\[\nlcm(a,b) = \nquo(\ntimes(a,b),\ngcd(a,b)).\]</span></p>
<p>In Haskell:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1">lcm<span class="ot"> ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n) <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> n</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">lcm a b <span class="fu">=</span> quo (times a b) (gcd a b)</a></code></pre></div>
</p>
</div>
</div>
<p>woo special cases!</p>
<div class="result">
<div class="lemma">
<p>For all <span class="math inline">\(a \in \nats\)</span> we have the following.</p>
<ol type="1">
<li><span class="math inline">\(\nlcm(a,\zero) = \zero\)</span>.</li>
<li><span class="math inline">\(\nlcm(a,\next(\zero)) = a\)</span>.</li>
</ol>
</div>
<div class="proof">
<p>
<ol type="1">
<li>Note that <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(a,\zero) \\
 &amp; = &amp; \nquo(\ntimes(a,\zero),\ngcd(a,\zero)) \\
 &amp; = &amp; \nquo(\zero,a) \\
 &amp; = &amp; \zero.
\end{eqnarray*}\]</span></li>
<li>Note that <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(a,\next(\zero)) \\
 &amp; = &amp; \nquo(\ntimes(a,\next(\zero)),\ngcd(a,\next(\zero))) \\
 &amp; = &amp; \nquo(a,\next(\zero)) \\
 &amp; = &amp; a.
\end{eqnarray*}\]</span></li>
</ol>
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb3"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="ot">_test_lcm_zero ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">_test_lcm_zero _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">  testName <span class="st">&quot;lcm(a,0) == 0&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">  \a <span class="ot">-&gt;</span> eq zero (lcm a zero)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="ot">_test_lcm_one ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb3-9" data-line-number="9">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb3-10" data-line-number="10">_test_lcm_one _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11">  testName <span class="st">&quot;lcm(a,next(0)) == a&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  \a <span class="ot">-&gt;</span> eq a (lcm a (next zero))</a></code></pre></div>
</p>
</div>
</div>
<p>As we might expect, <span class="math inline">\(\nlcm\)</span> enjoys many properties analogous to those of <span class="math inline">\(\ngcd\)</span>. It is idempotent and commutative.</p>
<div class="result">
<div class="thm">
<p>Let <span class="math inline">\(a,b \in \nats\)</span>. Then we have the following.</p>
<ol type="1">
<li><span class="math inline">\(\nlcm(a,a) = a\)</span>.</li>
<li><span class="math inline">\(\nlcm(a,b) = \nlcm(b,a)\)</span>.</li>
</ol>
</div>
<div class="proof">
<p>
<ol type="1">
<li>We consider two cases: <span class="math inline">\(a = \zero\)</span> and <span class="math inline">\(a \neq \zero\)</span>. If <span class="math inline">\(a = \zero\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(a,a) \\
 &amp; = &amp; \nquo(\ntimes(a,a),\ngcd(a,a)) \\
 &amp; = &amp; \nquo(\zero,\zero) \\
 &amp; = &amp; \zero \\
 &amp; = &amp; a
\end{eqnarray*}\]</span> as claimed. If <span class="math inline">\(a \neq \zero\)</span>, say <span class="math inline">\(a = \next(t)\)</span>, then we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(a,a) \\
 &amp; = &amp; \nquo(\ntimes(a,a),\ngcd(a,a)) \\
 &amp; = &amp; \nquo(\ntimes(a,a),a) \\
 &amp; = &amp; a
\end{eqnarray*}\]</span> as claimed.</li>
<li>Note that <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(a,b) \\
 &amp; = &amp; \nquo(\ntimes(a,b),\ngcd(a,b)) \\
 &amp; = &amp; \nquo(\ntimes(b,a),\ngcd(b,a)) \\
 &amp; = &amp; \nlcm(b,a)
\end{eqnarray*}\]</span> as claimed.</li>
</ol>
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb4"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="ot">_test_lcm_idempotent ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3">_test_lcm_idempotent _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  testName <span class="st">&quot;lcm(a,a) == a&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5">  \a <span class="ot">-&gt;</span> eq (lcm a a) a</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="ot">_test_lcm_commutative ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb4-10" data-line-number="10">_test_lcm_commutative _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">  testName <span class="st">&quot;lcm(a,b) == lcm(b,a)&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12">  \a b <span class="ot">-&gt;</span> eq (lcm a b) (lcm b a)</a></code></pre></div>
</p>
</div>
</div>
<p>And the universal property:</p>
<div class="result">
<div class="thm">
<p>Let <span class="math inline">\(a,b,c \in \nats\)</span>. Then we have the following.</p>
<ol type="1">
<li><span class="math inline">\(\ndiv(a,\nlcm(a,b))\)</span> and <span class="math inline">\(\ndiv(b,\nlcm(a,b))\)</span>.</li>
<li>If <span class="math inline">\(\ndiv(a,c)\)</span> and <span class="math inline">\(\ndiv(b,c)\)</span>, then <span class="math inline">\(\ndiv(\nlcm(a,b),c)\)</span>.</li>
</ol>
</div>
<div class="proof">
<p>
<ol type="1">
<li>We consider two cases: <span class="math inline">\(\ngcd(a,b) = \zero\)</span> and <span class="math inline">\(\ngcd(a,b) \neq \zero\)</span>. If <span class="math inline">\(\ngcd(a,b) = \zero\)</span>, then we have <span class="math inline">\(a = b = \zero\)</span>. Now <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(\zero,\zero) \\
 &amp; = &amp; \nquo(\ntimes(\zero,\zero),\ngcd(\zero,\zero)) \\
 &amp; = &amp; \nquo(\zero,\zero) \\
 &amp; = &amp; \zero
\end{eqnarray*}\]</span> and <span class="math inline">\(\ndiv(\zero,\zero)\)</span> as needed. Suppose instead that <span class="math inline">\(\ngcd(a,b) \neq \zero\)</span>. Say <span class="math inline">\(b = \ntimes(k,\ngcd(a,b))\)</span>. Now <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(a,b) \\
 &amp; = &amp; \nquo(\ntimes(a,b),\ngcd(a,b)) \\
 &amp; = &amp; \nquo(\ntimes(\ntimes(a,k),\ngcd(a,b)),\ngcd(a,b)) \\
 &amp; = &amp; \ntimes(a,k),
\end{eqnarray*}\]</span> so that <span class="math inline">\(\ndiv(a,\nlcm(a,b))\)</span>. A similar argument shows that <span class="math inline">\(\ndiv(b,\nlcm(a,b))\)</span> as claimed.</li>
<li>Suppose we have <span class="math inline">\(\ndiv(a,c)\)</span> and <span class="math inline">\(\ndiv(b,c)\)</span>. We consider two cases: either <span class="math inline">\((a,b) = (\zero,\zero)\)</span> or <span class="math inline">\((a,b) \neq (\zero,\zero)\)</span>. First suppose <span class="math inline">\((a,b) = (\zero,\zero)\)</span>. Now <span class="math inline">\(c = \zero\)</span>, and we have <span class="math inline">\(\ndiv(\nlcm(a,b),\zero)\)</span> as claimed. Suppose instead that <span class="math inline">\((a,b) \neq (\zero,\zero)\)</span>. Say <span class="math inline">\(c = \ntimes(a,u)\)</span> and <span class="math inline">\(c = \ntimes(b,v)\)</span>. Now let <span class="math inline">\(d = \ngcd(a,b)\)</span> (note that <span class="math inline">\(d \neq \zero\)</span>) and say <span class="math inline">\(a = \ntimes(d,s)\)</span> and <span class="math inline">\(b = \ntimes(d,t)\)</span>. Note that <span class="math inline">\(\ncoprime(s,t)\)</span>. Now we have <span class="math display">\[\begin{eqnarray*}
c &amp; = &amp; c \\
\ntimes(a,u) &amp; = &amp; \ntimes(b,v) \\
\ntimes(\ntimes(d,s),u) &amp; = &amp; \ntimes(\ntimes(d,t),v) \\
\ntimes(d,\ntimes(s,u)) &amp; = &amp; \ntimes(d,\ntimes(d,t)) \\
\ntimes(s,u) &amp; = &amp; \ntimes(t,v). \\
\end{eqnarray*}\]</span> That is, <span class="math inline">\(\ndiv(t,\ntimes(s,u))\)</span>. By Euclid’s lemma, we have <span class="math inline">\(\ndiv(t,u)\)</span>. Next, note that <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(a,b) \\
 &amp; = &amp; \nquo(\ntimes(a,b),\ngcd(a,b)) \\
 &amp; = &amp; \nquo(\ntimes(a,\ntimes(t,d)),d) \\
 &amp; = &amp; \nquo(\ntimes(\ntimes(a,t),d),d) \\
 &amp; = &amp; \ntimes(a,t).
\end{eqnarray*}\]</span> Since <span class="math inline">\(c = \ntimes(a,u)\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \btrue \\
 &amp; = &amp; \ndiv(t,u) \\
 &amp; = &amp; \ndiv(\ntimes(a,t),\ntimes(a,u)) \\
 &amp; = &amp; \ndiv(\nlcm(a,b),c)
\end{eqnarray*}\]</span> as claimed.</li>
</ol>
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb5"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="ot">_test_lcm_div_args ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">_test_lcm_div_args _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4">  testName <span class="st">&quot;div(a,lcm(a,b)) and div(b,lcm(a,b))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">  \a b <span class="ot">-&gt;</span> and (div a (lcm a b)) (div b (lcm a b))</a>
<a class="sourceLine" id="cb5-6" data-line-number="6"></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="ot">_test_lcm_least_common ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb5-9" data-line-number="9">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb5-10" data-line-number="10">_test_lcm_least_common _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11">  testName <span class="st">&quot;if div(a,c) and div(b,c) then div(lcm(a,b),c)&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12">  \a b c <span class="ot">-&gt;</span> <span class="kw">if</span> and (div a c) (div b c)</a>
<a class="sourceLine" id="cb5-13" data-line-number="13">    <span class="kw">then</span> div (lcm a b) c</a>
<a class="sourceLine" id="cb5-14" data-line-number="14">    <span class="kw">else</span> <span class="dt">True</span></a></code></pre></div>
</p>
</div>
</div>
<p>And <span class="math inline">\(\nlcm(a,b)\)</span> is unique with this property.</p>
<div class="result">
<div class="corollary">
<p>Let <span class="math inline">\(a,b,c \in \nats\)</span>. Suppose <span class="math inline">\(m \in \nats\)</span> satisfies the following.</p>
<ol type="1">
<li><span class="math inline">\(\ndiv(a,m)\)</span> and <span class="math inline">\(\ndiv(b,m)\)</span>.</li>
<li>If <span class="math inline">\(\ndiv(a,c)\)</span> and <span class="math inline">\(\ndiv(b,c)\)</span>, then <span class="math inline">\(\ndiv(m,c)\)</span>.</li>
</ol>
<p>Then <span class="math inline">\(m = \nlcm(a,b)\)</span>.</p>
</div>
<div class="proof">
<p>
Since <span class="math inline">\(\ndiv(a,m)\)</span> and <span class="math inline">\(\ndiv(b,m)\)</span>, we have <span class="math inline">\(\ndiv(\nlcm(a,b),m)\)</span>. But likewise we have <span class="math inline">\(\ndiv(m,\nlcm(a,b))\)</span>. By antisymmetry, we have <span class="math inline">\(m = \nlcm(a,b)\)</span> as claimed.
</p>
</div>
</div>
<p><span class="math inline">\(\nlcm\)</span> is associative:</p>
<div class="result">
<div class="thm">
<p>Let <span class="math inline">\(a,b,c \in \nats\)</span>. Then <span class="math inline">\(\nlcm(\nlcm(a,b),c) = \nlcm(a,\nlcm(b,c))\)</span>.</p>
</div>
<div class="proof">
<p>
Note that <span class="math inline">\(\ndiv(a,\nlcm(a,\nlcm(b,c)))\)</span>. We also have <span class="math inline">\(\ndiv(b,\nlcm(b,c))\)</span>, so that <span class="math display">\[\ndiv(b,\nlcm(a,\nlcm(b,c))\]</span> by transitivity; similarly, <span class="math display">\[\ndiv(c,\nlcm(a,\nlcm(b,c))).\]</span> By the universal property of <span class="math inline">\(\nlcm\)</span>, we thus have <span class="math display">\[\ndiv(\nlcm(a,b),\nlcm(a,\nlcm(b,c))),\]</span> so that <span class="math display">\[\ndiv(\nlcm(\nlcm(a,b),c),\nlcm(a,\nlcm(b,c))).\]</span> A similar argument shows that <span class="math display">\[\ndiv(\nlcm(a,\nlcm(b,c)),\nlcm(\nlcm(a,b),c)).\]</span> By antisymmetry, we thus have <span class="math display">\[\nlcm(a,\nlcm(b,c)) = \nlcm(\nlcm(a,b),c)\]</span> as claimed.
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb6"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="ot">_test_lcm_associative ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb6-3" data-line-number="3">_test_lcm_associative _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  testName <span class="st">&quot;lcm(lcm(a,b),c) == lcm(a,lcm(b,c))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5">  \a b c <span class="ot">-&gt;</span> eq (lcm (lcm a b) c) (lcm a (lcm b c))</a></code></pre></div>
</p>
</div>
</div>
<p><span class="math inline">\(\nlcm\)</span> detects <span class="math inline">\(\ndiv\)</span>.</p>
<div class="result">
<div class="thm">
<p>Let <span class="math inline">\(a,b \in \nats\)</span>. Then <span class="math inline">\(\nlcm(a,b) = a\)</span> if and only if <span class="math inline">\(\ndiv(b,a)\)</span>.</p>
</div>
<div class="proof">
<p>
<ol start="2" type="1">
<li>First suppose <span class="math inline">\(\ndiv(b,a)\)</span>; say <span class="math inline">\(a = \ntimes(b,d)\)</span>. Now <span class="math inline">\(\ndiv(a,a)\)</span> and <span class="math inline">\(\ndiv(b,a)\)</span>, and if <span class="math inline">\(\ndiv(c,a)\)</span> and <span class="math inline">\(\ndiv(c,b)\)</span> then <span class="math inline">\(\ndiv(c,a)\)</span>. By the universal property of <span class="math inline">\(\nlcm\)</span> we have <span class="math inline">\(a = \nlcm(a,b)\)</span>. Conversely, suppose <span class="math inline">\(a = \nlcm(a,b)\)</span>. We consider two cases: either <span class="math inline">\((a,b) = (\zero,\zero)\)</span> or <span class="math inline">\((a,b) \neq (\zero,\zero)\)</span>. If <span class="math inline">\((a,b) = (\zero,\zero)\)</span> then <span class="math inline">\(\ndiv(b,a)\)</span> as needed. Suppose then that <span class="math inline">\((a,b) \neq (\zero,\zero)\)</span>. If <span class="math inline">\(a = \zero\)</span>, then <span class="math inline">\(\ndiv(b,a)\)</span> as claimed. Suppose <span class="math inline">\(a \neq \zero\)</span>. Now let <span class="math inline">\(d = \ngcd(a,b)\)</span>; note that <span class="math inline">\(d \neq \zero\)</span>. Say <span class="math inline">\(b = \ntimes(k,d)\)</span>. Now <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \ntimes(a,\next(\zero)) \\
 &amp; = &amp; a \\
 &amp; = &amp; \nlcm(a,b) \\
 &amp; = &amp; \nquo(\ntimes(a,b),\ngcd(a,b)) \\
 &amp; = &amp; \nquo(\ntimes(\ntimes(a,k),d),d) \\
 &amp; = &amp; \ntimes(a,k).
\end{eqnarray*}\]</span> Since <span class="math inline">\(a \neq \zero\)</span>, we have <span class="math inline">\(k = \next(\zero)\)</span>, and thus <span class="math inline">\(b = \ngcd(a,b)\)</span>. Hence <span class="math inline">\(\ndiv(b,a)\)</span> as claimed.</li>
</ol>
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb7"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="ot">_test_lcm_div ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">_test_lcm_div _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">  testName <span class="st">&quot;lcm(a,b) == a if and only if ndiv(b,a)&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  \a b <span class="ot">-&gt;</span> eq (eq a (lcm a b)) (div b a)</a></code></pre></div>
</p>
</div>
</div>
<p><span class="math inline">\(\ntimes\)</span> distributes over <span class="math inline">\(\nlcm\)</span>.</p>
<div class="result">
<div class="thm">
<p>Let <span class="math inline">\(a,b,c \in \nats\)</span>. Then we have <span class="math display">\[\nlcm(\ntimes(c,a),ntimes(c,b)) = \ntimes(c,\nlcm(a,b)).\]</span></p>
</div>
<div class="proof">
<p>
We consider two cases: either <span class="math inline">\(c = \zero\)</span> or <span class="math inline">\(c \neq \zero\)</span>. If <span class="math inline">\(c = \zero\)</span> we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(\ntimes(c,a),\ntimes(c,b)) \\
 &amp; = &amp; \nlcm(\zero,\zero) \\
 &amp; = &amp; \zero \\
 &amp; = &amp; \ntimes(\zero,\nlcm(a,b)) \\
 &amp; = &amp; \ntimes(c,\nlcm(a,b))
\end{eqnarray*}\]</span> as claimed. Suppose then that <span class="math inline">\(c \neq \zero\)</span>. Now we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(\ntimes(c,a),\ntimes(c,b)) \\
 &amp; = &amp; \nquo(\ntimes(\ntimes(c,a),\ntimes(c,b)),\ngcd(\ntimes(c,a),\ntimes(c,b)) \\
 &amp; = &amp; \nquo(\ntimes(\ntimes(c,\ntimes(a,b)),c),\ngcd(\ntimes(a,b),c)) \\
 &amp; = &amp; \nquo(\ntimes(c,\ntimes(a,b)),\ngcd(a,b)) \\
 &amp; = &amp; \ntimes(c,\nquo(\ntimes(a,b),\ngcd(a,b))) \\
 &amp; = &amp; \ntimes(c,\nlcm(a,b))
\end{eqnarray*}\]</span> as claimed.
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb8"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="ot">_test_lcm_distributive_times ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">_test_lcm_distributive_times _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  testName <span class="st">&quot;lcm(times(c,a),times(c,b)) == times(c,lcm(a,b))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5">  \a b c <span class="ot">-&gt;</span> eq (lcm (times c a) (times c b)) (times c (lcm a b))</a></code></pre></div>
</p>
</div>
</div>
<p><span class="math inline">\(\nlcm\)</span> is compatible with <span class="math inline">\(\ndiv\)</span>.</p>
<div class="result">
<div class="thm">
<p>Let <span class="math inline">\(a,b,c \in \nats\)</span>. If <span class="math inline">\(\ndiv(a,b)\)</span>, then <span class="math inline">\(\ndiv(\nlcm(a,c),\nlcm(b,c))\)</span>.</p>
</div>
<div class="proof">
<p>
We have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(\nlcm(a,c),\nlcm(b,c)) \\
 &amp; = &amp; \nlcm(\nlcm(a,b),\nlcm(c,c)) \\
 &amp; = &amp; \nlcm(b,c) \\
\end{eqnarray*}\]</span> so that <span class="math inline">\(\ndiv(\nlcm(a,c),\nlcm(b,c))\)</span> as claimed.
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb9"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="ot">_test_lcm_div_compatible ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">_test_lcm_div_compatible _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  testName <span class="st">&quot;if div(a,b) then div(lcm(a,c),lcm(b,c))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">  \a b c <span class="ot">-&gt;</span> <span class="kw">if</span> div a b</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">    <span class="kw">then</span> div (lcm a c) (lcm b c)</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    <span class="kw">else</span> <span class="dt">True</span></a></code></pre></div>
</p>
</div>
</div>
<p>Finally, <span class="math inline">\(\ngcd\)</span> and <span class="math inline">\(\nlcm\)</span> distribute over each other.</p>
<div class="result">
<div class="thm">
<p>Let <span class="math inline">\(a,b,c \in \nats\)</span>. Then we have the following.</p>
<ol type="1">
<li><span class="math inline">\(\ngcd(a,\nlcm(b,c)) = \nlcm(\ngcd(a,b),\ngcd(a,c))\)</span>.</li>
<li><span class="math inline">\(\nlcm(a,\ngcd(b,c)) = \ngcd(\nlcm(a,b),\nlcm(a,c))\)</span>.</li>
</ol>
</div>
<div class="proof">
<p>
<p>The proofs of these two results will not be painful, but they are a little tedious, especially with the notation we’re using for arithmetic. So for this proof – and this proof only! – I’ll make two concessions to readability. Because <span class="math inline">\(\ngcd\)</span> is associative, there is no ambiguity in an expression like <span class="math display">\[\ngcd(a,b,c).\]</span> Also, we will denote <span class="math inline">\(\ntimes(a,b)\)</span> by juxtaposition (like we’re used to anyway, but have been avoiding).</p>
<ol type="1">
<li>First suppose <span class="math inline">\(a = \zero\)</span>; note that <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \ngcd(a,\nlcm(b,c)) \\
 &amp; = &amp; \ngcd(\zero,\nlcm(b,c)) \\
 &amp; = &amp; \nlcm(b,c) \\
 &amp; = &amp; \nlcm(\ngcd(\zero,b),\ngcd(\zero,c)) \\
 &amp; = &amp; \nlcm(\ngcd(a,b),\ngcd(a,c))
\end{eqnarray*}\]</span> as claimed. Next suppose <span class="math inline">\(b = \zero\)</span>. Now we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \ngcd(a,\nlcm(b,c)) \\
 &amp; = &amp; \ngcd(a,\nlcm(\zero,c)) \\
 &amp; = &amp; \ngcd(a,\zero) \\
 &amp; = &amp; a \\
 &amp; = &amp; \nlcm(\ngcd(a,b),a) \\
 &amp; = &amp; \nlcm(\ngcd(a,b),\ngcd(a,\zero)) \\
 &amp; = &amp; \nlcm(\ngcd(a,b),\ngcd(a,c))
\end{eqnarray*}\]</span> as claimed. Similarly, if <span class="math inline">\(c = \zero\)</span> we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \ngcd(a,\nlcm(b,c)) \\
 &amp; = &amp; \ngcd(a,\nlcm(b,\zero)) \\
 &amp; = &amp; \ngcd(a,\zero) \\
 &amp; = &amp; a \\
 &amp; = &amp; \nlcm(a,\ngcd(a,c)) \\
 &amp; = &amp; \nlcm(\ngcd(a,\zero),\ngcd(b,c)) \\
 &amp; = &amp; \nlcm(\ngcd(a,c),\ngcd(b,c))
\end{eqnarray*}\]</span> as claimed. We can now assume that <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span> are not zero; in particular, <span class="math inline">\(\ngcd(b,c)\)</span> and <span class="math inline">\(\ngcd(a,\ngcd(b,c))\)</span> are not zero. We begin with a sub-result. Note that <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \ngcd(a\ngcd(b,c),bc)\ngcd(a,\ngcd(b,c)) \\
 &amp; = &amp; \ngcd(\ngcd(ab,ac),bc)\ngcd(a,b,c) \\
 &amp; = &amp; \ngcd(ab,ac,bc)\ngcd(a,b,c) \\
 &amp; = &amp; \ngcd(ab\ngcd(a,b,c),ac\ngcd(a,b,c),bc\ngcd(a,b,c)) \\
 &amp; = &amp; \ngcd(aba,abb,abc,aca,acb,acc,bca,bcb,bcc) \\
 &amp; = &amp; \ngcd(aab,aac,acb,acc,bab,bac,bcb,bcc) \\
 &amp; = &amp; \ngcd(aa\ngcd(b,c),ac\ngcd(b,c),ba\ngcd(b,c),bc\ngcd(b,c)) \\
 &amp; = &amp; \ngcd(aa,ac,ba,bc)\ngcd(b,c) \\
 &amp; = &amp; \ngcd(a\ngcd(a,c),b\ngcd(a,c))\ngcd(b,c) \\
 &amp; = &amp; \ngcd(a,b)\ngcd(a,c)\ngcd(b,c).
\end{eqnarray*}\]</span> Note that <span class="math display">\[\ndiv(\ngcd(b,c),a\ngcd(b,c))\]</span> and <span class="math display">\[\ndiv(\ngcd(b,c),bc),\]</span> so that <span class="math display">\[\ndiv(\ngcd(b,c),\ngcd(a\ngcd(b,c),bc));\]</span> thus we also have <span class="math display">\[\ndiv(\ngcd(a,\ngcd(b,c)),\ngcd(a,b)\ngcd(a,c)).\]</span> By cross-multiplication, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nquo(\ngcd(a\ngcd(b,c),bc),\ngcd(b,c)) \\
 &amp; = &amp; \nquo(\ngcd(a,b)\ngcd(a,c)),\ngcd(a,\ngcd(b,c))).
\end{eqnarray*}\]</span> Thus we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \ngcd(a,\nlcm(b,c)) \\
 &amp; = &amp; \ngcd(a,\nquo(bc,\ngcd(b,c))) \\
 &amp; = &amp; \ngcd(\nquo(a\ngcd(b,c),\ngcd(b,c)),\nquo(bc,\ngcd(b,c))) \\
 &amp; = &amp; \nquo(\ngcd(a\ngcd(b,c),bc),\ngcd(b,c)) \\
 &amp; = &amp; \nquo(\ngcd(a,b)\ngcd(a,c),\ngcd(a,\ngcd(b,c)) \\
 &amp; = &amp; \nquo(\ngcd(a,b)\ngcd(a,c),\ngcd(\ngcd(a,b),\ngcd(a,c))) \\
 &amp; = &amp; \nlcm(\ngcd(a,b),\ngcd(a,c))
\end{eqnarray*}\]</span> as claimed.</li>
<li>First suppose <span class="math inline">\(a = \zero\)</span>. Then we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(a,\ngcd(b,c)) \\
 &amp; = &amp; \nlcm(\zero,\ngcd(b,c)) \\
 &amp; = &amp; \zero \\
 &amp; = &amp; \ngcd(\zero,\zero) \\
 &amp; = &amp; \ngcd(\nlcm(\zero,b),\nlcm(\zero,c)) \\
 &amp; = &amp; \ngcd(\nlcm(a,b),\nlcm(a,c))
\end{eqnarray*}\]</span> as claimed. Next suppose <span class="math inline">\(b = \zero\)</span>. Then we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(a,\ngcd(b,c)) \\
 &amp; = &amp; \nlcm(a,\ngcd(\zero,c)) \\
 &amp; = &amp; \nlcm(a,c) \\
 &amp; = &amp; \ngcd(\zero,\nlcm(a,c)) \\
 &amp; = &amp; \ngcd(\nlcm(a,\zero),\nlcm(a,c)) \\
 &amp; = &amp; \ngcd(\nlcm(a,b),\nlcm(a,c))
\end{eqnarray*}\]</span> as claimed. Similarly, if <span class="math inline">\(c = \zero\)</span> we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nlcm(a,\ngcd(b,c)) \\
 &amp; = &amp; \nlcm(a,\ngcd(b,\zero)) \\
 &amp; = &amp; \nlcm(a,b) \\
 &amp; = &amp; \ngcd(\nlcm(a,b),\zero) \\
 &amp; = &amp; \ngcd(\nlcm(a,b),\nlcm(a,\zero)) \\
 &amp; = &amp; \ngcd(\nlcm(a,b),\nlcm(a,c))
\end{eqnarray*}\]</span> as claimed. We can now assume that <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span> are not zero; in particular, <span class="math inline">\(\ngcd(a,b)\ngcd(a,c)\)</span> and <span class="math inline">\(\ngcd(a,\ngcd(b,c))\)</span> are not zero; in particular, <span class="math inline">\(\ngcd(a,b)\ngcd(a,c)\)</span> and <span class="math inline">\(\ngcd(a,\ngcd(b,c))\)</span> are not zero. We begin with a sub-result. Note that <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; a\ngcd(a,\ngcd(b,c))\ngcd(ba,bc,ca,cb) \\
 &amp; = &amp; a\ngcd(a,b,c)\ngcd(ba,bc,ca,cb) \\
 &amp; = &amp; a\ngcd(a\ngcd(ba,bc,ca,cb),b\ngcd(ba,bc,ca,cb),c\ngcd(ba,bc,ca,cb)) \\
 &amp; = &amp; a\ngcd(\ngcd(aba,abc,aca,acb),\ngcd(bba,bbc,bca,bcb),\ngcd(cba,cbc,cca,ccb)) \\
 &amp; = &amp; a\ngcd(aba,abc,aca,acb,bba,bbc,bca,bcb,cba,cbc,cca,ccb) \\
 &amp; = &amp; a\ngcd(aab,aac,acb,acc,bab,bac,bcb,bcc) \\
 &amp; = &amp; a\ngcd(aa\ngcd(b,c),ac\ngcd(b,c),ba\ngcd(b,c),bc\ngcd(b,c)) \\
 &amp; = &amp; a\ngcd(aa,ac,ba,bc)\ngcd(b,c) \\
 &amp; = &amp; a\ngcd(a\ngcd(a,c),b\ngcd(a,c))\ngcd(b,c) \\
 &amp; = &amp; a\ngcd(a,b)\ngcd(a,c)\ngcd(b,c).
\end{eqnarray*}\]</span> Note that <span class="math display">\[\ndiv(\ngcd(a,\ngcd(b,c)),a\ngcd(b,c)),\]</span> so that <span class="math display">\[\ndiv(\ngcd(a,b)\ngcd(a,c),a\ngcd(ba,bc,ca,cb)).\]</span> By cross-multiplication, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nquo(a\ngcd(ba,bc,ca,cb),\ngcd(a,b)\ngcd(a,c)) \\
 &amp; = &amp; \nquo(a\ngcd(b,c),\ngcd(a,\ngcd(b,c)).
\end{eqnarray*}\]</span> Thus we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \ngcd(\nlcm(a,b),\nlcm(a,c)) \\
 &amp; = &amp; \ngcd(\nquo(ab,\ngcd(a,b)),\nquo(ac,\ngcd(a,c))) \\
 &amp; = &amp; \ngcd(\nquo(ab\ngcd(a,c),\ngcd(a,b)\ngcd(a,c)),\nquo(ac\ngcd(a,b),\ngcd(a,b)\ngcd(a,c))) \\
 &amp; = &amp; \nquo(\ngcd(ab\ngcd(a,c),ac\ngcd(a,b)),\ngcd(a,b)\ngcd(a,c)) \\
 &amp; = &amp; \nquo(a\ngcd(b\ngcd(a,c),c\ngcd(a,b)),\ngcd(a,b)\ngcd(a,c)) \\
 &amp; = &amp; \nquo(a\ngcd(ba,bc,ca,cb),\ngcd(a,b)\ngcd(a,c)) \\
 &amp; = &amp; \nquo(a\ngcd(b,c),\ngcd(a,\ngcd(b,c)) \\
 &amp; = &amp; \nlcm(a,\ngcd(b,c))
\end{eqnarray*}\]</span> as claimed.</li>
</ol>
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb10"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="ot">_test_lcm_distributive_gcd ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb10-3" data-line-number="3">_test_lcm_distributive_gcd _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">  testName <span class="st">&quot;lcm(gcd(c,a),gcd(c,b)) == gcd(c,lcm(a,b))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">  \a b c <span class="ot">-&gt;</span> eq (lcm (gcd c a) (gcd c b)) (gcd c (lcm a b))</a>
<a class="sourceLine" id="cb10-6" data-line-number="6"></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="ot">_test_gcd_distributive_lcm ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n)</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">  <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Test</span> (n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">_test_gcd_distributive_lcm _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11">  testName <span class="st">&quot;gcd(lcm(c,a),lcm(c,b)) == lcm(c,gcd(a,b))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12">  \a b c <span class="ot">-&gt;</span> eq (gcd (lcm c a) (lcm c b)) (lcm c (gcd a b))</a></code></pre></div>
</p>
</div>
</div>
<h2 id="testing">Testing</h2>
<p>Suite:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="ot">_test_lcm ::</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  ( <span class="dt">TypeName</span> n, <span class="dt">Natural</span> n, <span class="dt">Equal</span> n, <span class="dt">Arbitrary</span> n, <span class="dt">Show</span> n</a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  ) <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb11-4" data-line-number="4">_test_lcm n maxSize numCases <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5">  testLabel (<span class="st">&quot;lcm: &quot;</span> <span class="fu">++</span> typeName n)</a>
<a class="sourceLine" id="cb11-6" data-line-number="6"></a>
<a class="sourceLine" id="cb11-7" data-line-number="7">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb11-8" data-line-number="8">    args <span class="fu">=</span> stdArgs</a>
<a class="sourceLine" id="cb11-9" data-line-number="9">      { maxSuccess <span class="fu">=</span> numCases</a>
<a class="sourceLine" id="cb11-10" data-line-number="10">      , maxSize    <span class="fu">=</span> maxSize</a>
<a class="sourceLine" id="cb11-11" data-line-number="11">      }</a>
<a class="sourceLine" id="cb11-12" data-line-number="12"></a>
<a class="sourceLine" id="cb11-13" data-line-number="13">  runTest args (_test_lcm_zero n)</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">  runTest args (_test_lcm_one n)</a>
<a class="sourceLine" id="cb11-15" data-line-number="15">  runTest args (_test_lcm_idempotent n)</a>
<a class="sourceLine" id="cb11-16" data-line-number="16">  runTest args (_test_lcm_commutative n)</a>
<a class="sourceLine" id="cb11-17" data-line-number="17">  runTest args (_test_lcm_div_args n)</a>
<a class="sourceLine" id="cb11-18" data-line-number="18">  runTest args (_test_lcm_least_common n)</a>
<a class="sourceLine" id="cb11-19" data-line-number="19">  runTest args (_test_lcm_associative n)</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">  runTest args (_test_lcm_div n)</a>
<a class="sourceLine" id="cb11-21" data-line-number="21">  runTest args (_test_lcm_distributive_times n)</a>
<a class="sourceLine" id="cb11-22" data-line-number="22">  runTest args (_test_lcm_div_compatible n)</a>
<a class="sourceLine" id="cb11-23" data-line-number="23">  runTest args (_test_lcm_distributive_gcd n)</a>
<a class="sourceLine" id="cb11-24" data-line-number="24">  runTest args (_test_gcd_distributive_lcm n)</a></code></pre></div>
<p>Main:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="ot">main_lcm ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">main_lcm <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  _test_lcm (<span class="ot">zero ::</span> <span class="dt">Unary</span>) <span class="dv">20</span> <span class="dv">100</span></a></code></pre></div>



<!-- END BODY -->
</div>

<div id="footer">
  Site generated by
  <a href="http://jaspervdj.be/hakyll">Hakyll</a>
</div>
</body>
</html>
