<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>nbloomf.github.io - Is Prime</title>
<link rel="stylesheet" type="text/css" href="../../css/default.css" />
<link rel="icon" href="../../raw/gfx/icon/favicon-32.png" />
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../raw/gfx/icon/favicon-57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../raw/gfx/icon/favicon-114.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../raw/gfx/icon/favicon-152.png" />
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>

<body>
<div id="header">
  <div id="logo">
    <a href="../../index.html">nbloomf</a>
  </div>
  <div id="navigation">
    <a href="../../index.html">Home</a>
    <a href="../../pages/about.html">About</a>
    <a href="../../pages/projects.html">Projects</a>
    <a href="../../pages/contact.html">Contact</a>
    <a href="../../archive.html">Blog</a>
  </div>
</div>

<div id="content">
<h1>Is Prime</h1>
<!-- BEGIN BODY -->


<div class="info">
Posted on 2017-04-20 by nbloomf
</div>


<div class="info tags">Tags: <a href="../../tag/arithmetic-made-difficult.html">arithmetic-made-difficult</a>, <a href="../../tag/literate-haskell.html">literate-haskell</a></div>


<!-- LaTeX Macros for Arithmetic Made Difficult -->
<div class="invisible">
<!-- basic maps -->
\(\newcommand{\id}{\mathsf{id}}\)
\(\newcommand{\const}{\mathsf{const}}\)

<!-- booleans -->
\(\newcommand{\bool}{\mathbb{B}}\)
\(\newcommand{\btrue}{\mathsf{true}}\)
\(\newcommand{\bfalse}{\mathsf{false}}\)
\(\newcommand{\bnot}{\mathsf{not}}\)
\(\newcommand{\band}{\mathbin{\mathsf{and}}}\)
\(\newcommand{\bor}{\mathbin{\mathsf{or}}}\)
\(\newcommand{\beq}{\mathsf{eq}}\)
\(\newcommand{\bif}[3]{\mathsf{if}\left(#1,#2,#3\right)}\)

<!-- tuples -->
\(\newcommand{\fst}{\mathsf{first}}\)
\(\newcommand{\snd}{\mathsf{second}}\)
\(\newcommand{\dup}{\mathsf{dup}}\)
\(\newcommand{\swap}{\mathsf{swap}}\)
\(\newcommand{\pair}{\mathsf{pair}}\)
\(\newcommand{\assocL}{\mathsf{assocL}}\)
\(\newcommand{\assocR}{\mathsf{assocR}}\)

<!-- natural numbers -->
\(\newcommand{\nats}{\mathbb{N}}\)
\(\newcommand{\zero}{\mathsf{0}}\)
\(\newcommand{\next}{\mathsf{next}}\)
\(\newcommand{\iszero}{\mathsf{isZero}}\)
\(\newcommand{\prev}{\mathsf{prev}}\)
\(\newcommand{\natrec}[2]{\left\langle\!\left\vert #1, #2 \right\vert\!\right\rangle}\)
\(\newcommand{\simprec}[2]{\left[\!\left[ #1, #2 \right]\!\right]}\)
\(\newcommand{\bailrec}[4]{\left(\!\left[ #1, #2, #3, #4 \right]\!\right)}\)

<!--- natural number arithmetic ---->
\(\newcommand{\nequal}{\mathsf{eq}}\)
\(\newcommand{\nplus}{\mathsf{plus}}\)
\(\newcommand{\ntimes}{\mathsf{times}}\)
\(\newcommand{\nleq}{\mathsf{leq}}\)
\(\newcommand{\ngeq}{\mathsf{geq}}\)
\(\newcommand{\nminus}{\mathsf{minus}}\)
\(\newcommand{\nmax}{\mathsf{max}}\)
\(\newcommand{\nmin}{\mathsf{min}}\)
\(\newcommand{\ndivalg}{\mathsf{divalg}}\)
\(\newcommand{\nquo}{\mathsf{quo}}\)
\(\newcommand{\nrem}{\mathsf{rem}}\)
\(\newcommand{\ndiv}{\mathsf{div}}\)
\(\newcommand{\ngcd}{\mathsf{gcd}}\)
\(\newcommand{\ncoprime}{\mathsf{coprime}}\)
\(\newcommand{\nlcm}{\mathsf{lcm}}\)
\(\newcommand{\nmindiv}{\mathsf{mindiv}}\)
\(\newcommand{\nisprime}{\mathsf{isPrime}}\)
\(\newcommand{\npower}{\mathsf{power}}\)

<!-- categories -->
\(\newcommand{\dom}{\mathsf{dom}}\)
\(\newcommand{\cod}{\mathsf{cod}}\)

<!-- list -->
\(\newcommand{\nil}{\mathsf{nil}}\)
\(\newcommand{\cons}{\mathsf{cons}}\)
\(\newcommand{\lists}[1]{\mathsf{List}(#1)}\)
\(\newcommand{\foldr}[2]{\mathsf{foldr}(#1,#2)}\)
\(\newcommand{\isnil}{\mathsf{isNil}}\)
\(\newcommand{\tail}{\mathsf{tail}}\)
\(\newcommand{\snoc}{\mathsf{snoc}}\)
\(\newcommand{\rev}{\mathsf{rev}}\)
\(\newcommand{\foldl}[2]{\mathsf{foldl}(#1,#2)}\)
\(\newcommand{\cat}{\mathsf{cat}}\)
\(\newcommand{\length}{\mathsf{length}}\)
\(\newcommand{\head}{\mathsf{head}}\)
\(\newcommand{\at}{\mathsf{at}}\)
\(\newcommand{\map}{\mathsf{map}}\)
\(\newcommand{\unfoldN}{\mathsf{unfoldN}}\)
\(\newcommand{\range}{\mathsf{range}}\)
\(\newcommand{\zip}{\mathsf{zip}}\)
\(\newcommand{\zipPad}{\mathsf{zipPad}}\)
\(\newcommand{\unzip}{\mathsf{unzip}}\)
\(\newcommand{\prefix}{\mathsf{prefix}}\)
\(\newcommand{\suffix}{\mathsf{suffix}}\)
\(\newcommand{\lcp}{\mathsf{lcp}}\)
\(\newcommand{\lcs}{\mathsf{lcs}}\)
\(\newcommand{\all}{\mathsf{all}}\)
\(\newcommand{\any}{\mathsf{any}}\)
\(\newcommand{\tails}{\mathsf{tails}}\)
\(\newcommand{\inits}{\mathsf{inits}}\)
\(\newcommand{\filter}{\mathsf{filter}}\)
\(\newcommand{\elt}{\mathsf{elt}}\)
</div>
<!-- End LaTeX Macros for Arithmetic Made Difficult -->

<p>This page is part of a series on <a href="../../pages/amd.html">Arithmetic Made Difficult</a>.</p>

<p>This post is literate Haskell; you can load <a href="https://raw.githubusercontent.com/nbloomf/nbloomf.md/master/posts/arithmetic-made-difficult/IsPrime.lhs">the source</a> into GHCi and play along.</p>

<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> <span class="kw">module</span> <span class="dt">IsPrime</span>
<span class="ot">&gt;</span>   ( mindiv, prime, _test_prime, main_prime
<span class="ot">&gt;</span>   ) <span class="kw">where</span>
<span class="ot">&gt;</span> 
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Booleans</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">NaturalNumbers</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Plus</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Times</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Minus</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">LessThanOrEqualTo</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">DivisionAlgorithm</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Divides</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">GreatestCommonDivisor</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">CoprimeTo</span>
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">LeastCommonMultiple</span>
<span class="ot">&gt;</span> 
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Prelude</span> (<span class="dt">Show</span>, <span class="dt">Int</span>, <span class="dt">IO</span>, sequence_)
<span class="ot">&gt;</span> <span class="kw">import </span><span class="dt">Test.QuickCheck</span></code></pre></div>
<p>Today we’ll nail down what it means for a natural number to be <em>prime</em>. Typically this is done by saying something like “a natural number other than 0 or 1 is prime if it is not divisible by any natural number besides itself and 1” and from there, arguing that this property can be checked using trial division. As is typical in this series, we will turn this around – <em>defining</em> primes to be those numbers which are detected by trial division (i.e. an algorithm) and then proving that such numbers have the divisibility properties we expect.</p>
<p>In fact we’ll do a little more: instead of simply using trial division to detect whether a natural number <span class="math inline">\(n\)</span> is prime, we can use it to find the smallest divisor of <span class="math inline">\(n\)</span>. If the smallest divisor is <span class="math inline">\(n\)</span> itself, then <span class="math inline">\(n\)</span> is prime. To make this work we have to define “smallest divisor” in such a way that the trivial divisor <span class="math inline">\(\next(\zero)\)</span> is excluded. We will call this function that finds the smallest divisor <span class="math inline">\(\nmindiv\)</span>, and intuitively it should have the signature <span class="math inline">\(\nats \rightarrow \nats\)</span>.</p>
<div class="result">
<div class="defn">
<p>
Define <span class="math inline">\(\varphi : \nats \rightarrow \nats \rightarrow \bool\)</span> by <span class="math display">\[\varphi(a)(b) = a,\]</span> <span class="math inline">\(\beta : \nats \rightarrow \nats \times \nats \rightarrow \bool\)</span> by <span class="math display">\[\beta(a)(k,b) = \ndiv(b,a),\]</span> <span class="math inline">\(\psi : \nats \rightarrow \nats \times \nats \rightarrow \nats\)</span> by <span class="math display">\[\psi(a)(k,b) = b,\]</span> and <span class="math inline">\(\omega : \nats \rightarrow \nats \times \nats \rightarrow \nats\)</span> by <span class="math display">\[\omega(a)(k,b) = \next(b).\]</span> Now define <span class="math inline">\(\nmindiv : \nats \rightarrow \bool\)</span> by <span class="math display">\[\nmindiv(a) = \bailrec{\varphi(a)}{\beta(a)}{\psi(a)}{\omega(a)}(a,\next(\next(a))).\]</span>
</p>
</div>
</div>
<p>For brevity we will define <span class="math inline">\(\Theta : \nats \times \nats \rightarrow \nats\)</span> by <span class="math display">\[\Theta = \bailrec{\varphi(a)}{\beta(a)}{\psi(a)}{\omega(a)}\]</span> as in the definition of <span class="math inline">\(\nmindiv\)</span>.</p>
<div class="result">
<div class="lemma">
<p>Let <span class="math inline">\(a \in \nats\)</span>. Suppose <span class="math inline">\(t \in \nats\)</span> has the property that <span class="math inline">\(t \neq \zero\)</span>, <span class="math inline">\(t \neq \next(\zero)\)</span>, and <span class="math inline">\(\ndiv(t,a) = \btrue\)</span>, and if <span class="math inline">\(k \in \nats\)</span> with <span class="math inline">\(\nleq(k,t)\)</span>, <span class="math inline">\(k \neq \zero\)</span>, <span class="math inline">\(k \neq \next(\zero)\)</span>, and <span class="math inline">\(k \neq t\)</span>, then <span class="math inline">\(\ndiv(k,a) = \bfalse\)</span>.</p>
<p>Then for all <span class="math inline">\(u \in \nats\)</span>, if <span class="math display">\[\nleq(\next(\next(\next(u))),t) = \btrue\]</span> then <span class="math display">\[\Theta(a,\next(\next(\zero))) = \Theta(\nminus(a,u),\next(\next(u))).\]</span></p>
</div>
<div class="proof">
<p>
<p>We proceed by induction on <span class="math inline">\(u\)</span>. For the base case <span class="math inline">\(u = \zero\)</span>, the implication is either vacuous (if <span class="math inline">\(\nleq(\next(\next(\next(\zero))),t)\)</span> is false) or trivial (otherwise, since in this case we have <span class="math inline">\(\nminus(a,\zero) = a\)</span>).</p>
For the inductive step, suppose the implication holds for some <span class="math inline">\(u \in \nats\)</span>. Suppose further that <span class="math display">\[\nleq(\next(\next(\next(\next(u)))),t).\]</span> Now <span class="math display">\[\nleq(\next(\next(\next(u))),t).\]</span> Say <span class="math inline">\(t = \nplus(\next(u),h)\)</span> and <span class="math inline">\(t = \nplus(u,k)\)</span>; then we have <span class="math inline">\(k = \next(h)\)</span>. Using the induction hypothesis, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \Theta(a,\next(\next(\zero))) \\
 &amp; = &amp; \Theta(\nminus(a,u),\next(\next(u))) \\
 &amp; = &amp; \Theta(k,\next(\next(u))) \\
 &amp; = &amp; \Theta(\next(h),\next(\next(u))) \\
 &amp; = &amp; Q
\end{eqnarray*}\]</span> Note that <span class="math inline">\(\next(\next(u))\)</span> is not <span class="math inline">\(\zero\)</span>, <span class="math inline">\(\next(\zero)\)</span>, or <span class="math inline">\(t\)</span>. Thus <span class="math inline">\(\ndiv(\next(\next(u)),a) = \bfalse\)</span>, and we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; Q \\
 &amp; = &amp; \Theta(h,\next(\next(\next(u)))) \\
 &amp; = &amp; \Theta(\nminus(a,\next(u)),\next(\next(\next(u))))
\end{eqnarray*}\]</span> as needed.
</p>
</div>
</div>
<p>We can show that <span class="math inline">\(\nmindiv(a)\)</span> is the smallest divisor of <span class="math inline">\(a\)</span> in an appropriate sense.</p>
<div class="result">
<div class="thm">
<p>
<p>Let <span class="math inline">\(a \in \nats\)</span> with <span class="math inline">\(a \neq \zero\)</span> and <span class="math inline">\(a \neq \next(\zero)\)</span>. Then we have the following.</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\nmindiv(a) \neq \zero\)</span> and <span class="math inline">\(\nmindiv(a) \neq \next(\zero)\)</span> and <span class="math inline">\(\ndiv(\nmindiv(a),a)\)</span>.</li>
<li>If <span class="math inline">\(k \neq \zero\)</span> and <span class="math inline">\(k \neq \next(\zero)\)</span> and <span class="math inline">\(\ndiv(k,a)\)</span>, then <span class="math inline">\(\nleq(\nmindiv(a),k)\)</span>.</li>
</ol>
</p>
</div>
<div class="proof">
<p>
<p>Let <span class="math inline">\(a \in \nats\)</span> with <span class="math inline">\(a \neq \zero\)</span> and <span class="math inline">\(a \neq \next(\zero)\)</span>. Now define a set <span class="math inline">\(D(a) \subseteq \nats\)</span> by <span class="math display">\[D(a) = \{ k \in \nats \mid k \neq \zero, k \neq \next(\zero), \ndiv(k,a) \}.\]</span> Now <span class="math inline">\(D(a)\)</span> is not empty, since <span class="math inline">\(a \in D(a)\)</span>. By the Well-Ordering Property, then, <span class="math inline">\(D(a)\)</span> has a least element; we call this element <span class="math inline">\(\mu_a\)</span>. Certainly <span class="math inline">\(\mu_a\)</span> satisfies conditions (1) and (2); thus it suffices to show that <span class="math inline">\(\nmindiv(a) = \mu_a\)</span>. We consider two possibilities: either <span class="math inline">\(\mu_a = \next(\next(\zero))\)</span> or <span class="math inline">\(\mu_a = \next(\next(\next(m)))\)</span> for some <span class="math inline">\(m\)</span>. (Note that <span class="math inline">\(\mu_a\)</span> is not <span class="math inline">\(\zero\)</span> or <span class="math inline">\(\next(\zero)\)</span> by definition.</p>
First suppose <span class="math inline">\(\mu_a = \next(\next(\zero))\)</span>. Note that <span class="math inline">\(a = \next(b)\)</span> for some <span class="math inline">\(b\)</span> (since <span class="math inline">\(a \neq \zero\)</span>). Now <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nmindiv(a) \\
 &amp; = &amp; \Theta(a,\next(\next(\zero))) \\
 &amp; = &amp; \Theta(\next(b),\next(\next(\zero))) \\
 &amp; = &amp; \next(\next(\zero)) \\
 &amp; = &amp; \mu_a
\end{eqnarray*}\]</span> since <span class="math inline">\(\ndiv(\next(\next(\zero)),a)\)</span>. Now suppose <span class="math inline">\(\mu_a = \next(\next(\next(m)))\)</span>. Note that <span class="math inline">\(\nminus(a,m) = \next(\next(q))\)</span>. By the lemma, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \nmindiv(a) \\
 &amp; = &amp; \Theta(a,\next(\next(\zero))) \\
 &amp; = &amp; \Theta(\nminus(a,m),\next(\next(m)))) \\
 &amp; = &amp; \Theta(\next(\next(q)),\next(\next(m))) \\
 &amp; = &amp; R. \\
\end{eqnarray*}\]</span> Now <span class="math inline">\(\ndiv(\next(\next(m)),a) = \bfalse\)</span>, since <span class="math inline">\(\next(\next(m))\)</span> is not <span class="math inline">\(\zero\)</span>, <span class="math inline">\(\next(\zero)\)</span>, or <span class="math inline">\(\mu_a\)</span>, and <span class="math inline">\(\mu_a\)</span> is minimal in <span class="math inline">\(D(a)\)</span>. Thus we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; R \\
 &amp; = &amp; \Theta(\next(q),\next(\next(\next(m)))) \\
 &amp; = &amp; \next(\next(\next(m))) \\
 &amp; = &amp; \mu_a
\end{eqnarray*}\]</span> as claimed.
</p>
</div>
</div>
<p>Now we define a boolean function <span class="math inline">\(\nisprime\)</span> as follows.</p>
<div class="result">
<div class="defn">
<p>
Define <span class="math inline">\(\nisprime : \nats \rightarrow \bool\)</span> by <span class="math display">\[\nisprime(a) = \left\{ \begin{array}{ll} \bfalse &amp; \mathrm{if} a = \zero\ \mathrm{or}\ a = \next(\zero) \\ \nequal(a,\nmindiv(a)) &amp; \mathrm{otherwise}. \end{array} \right.\]</span>
</p>
</div>
</div>
<p>It is straightforward to show that <span class="math inline">\(\nisprime\)</span> is equivalent to the usual definition.</p>
<div class="result">
<div class="thm">
<p>Let <span class="math inline">\(a \in \nats\)</span>. Then the following are equivalent.</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\nisprime(a) = \btrue\)</span>.</li>
<li><span class="math inline">\(a \neq \zero\)</span> and <span class="math inline">\(a \neq \next(\zero)\)</span>, and if <span class="math inline">\(u,v \in \nats\)</span> such that <span class="math inline">\(a = \ntimes(u,v)\)</span>, then <span class="math inline">\((u,v)\)</span> is either <span class="math inline">\((\next(\zero),a)\)</span> or <span class="math inline">\((a,\next(\zero))\)</span>.</li>
<li><span class="math inline">\(a \neq \zero\)</span> and <span class="math inline">\(a \neq \next(\zero)\)</span>, and if <span class="math inline">\(u,v \in \nats\)</span> such that <span class="math inline">\(\ndiv(a,\ntimes(u,v))\)</span>, then either <span class="math inline">\(\ndiv(a,u)\)</span> or <span class="math inline">\(\ndiv(a,v)\)</span>.</li>
</ol>
</div>
<div class="proof">
<p>
<p><span class="math inline">\((1)\)</span> implies <span class="math inline">\((2)\)</span>: Suppose <span class="math inline">\(\nisprime(a) = \btrue\)</span>. Certainly <span class="math inline">\(a \neq \zero\)</span> and <span class="math inline">\(a \neq \next(\zero)\)</span> (by definition), and we have <span class="math inline">\(a = \nmindiv(a)\)</span>. Suppose now that <span class="math inline">\(a = \ntimes(u,v)\)</span>; we consider three cases for <span class="math inline">\(u\)</span>. If <span class="math inline">\(u = \zero\)</span> we have <span class="math inline">\(a = \zero\)</span>, a contradiction. If <span class="math inline">\(u = \next(\zero)\)</span>, then <span class="math inline">\(v = a\)</span>. If <span class="math inline">\(a \neq \zero\)</span> and <span class="math inline">\(a \neq \next(\zero)\)</span>, we have <span class="math inline">\(\ndiv(u,a)\)</span>, so that <span class="math inline">\(\nleq(\nmindiv(a),u)\)</span>; thus <span class="math inline">\(\nleq(a,u)\)</span>. But also <span class="math inline">\(\nleq(u,a)\)</span>, so that <span class="math inline">\(u = a\)</span>, and thus <span class="math inline">\(v = \next(\zero)\)</span> as claimed.</p>
<p><span class="math inline">\((2)\)</span> implies <span class="math inline">\((3)\)</span>: Of course <span class="math inline">\(a \neq \zero\)</span> and <span class="math inline">\(a \neq \next(\zero)\)</span>. Say <span class="math inline">\(\ndiv(a,\ntimes(u,v))\)</span>, and consider <span class="math inline">\(\ngcd(a,u)\)</span>. In particular, we have <span class="math inline">\(a = \ntimes(k,\ngcd(a,u))\)</span> for some <span class="math inline">\(k\)</span>. There are two possibilities: if <span class="math inline">\(\ngcd(a,u) = a\)</span>, then <span class="math inline">\(\ndiv(a,u)\)</span>, and if <span class="math inline">\(\ngcd(a,u) = \next(\zero)\)</span>, then <span class="math inline">\(\ndiv(a,v)\)</span> by Euclid’s lemma.</p>
<span class="math inline">\((3)\)</span> implies <span class="math inline">\((1)\)</span>: It suffices to show that if <span class="math inline">\(a \neq \zero\)</span> and <span class="math inline">\(a \neq \next(\zero)\)</span> then <span class="math inline">\(\nmindiv(a) = a\)</span>. To this end, let <span class="math inline">\(d = \nmindiv(a)\)</span> and write <span class="math inline">\(a = \ntimes(\nmindiv(a),k)\)</span>. Suppose <span class="math inline">\(\ndiv(a,k)\)</span>, with <span class="math inline">\(k = \ntimes(a,w)\)</span>. Since <span class="math inline">\(a \neq \zero\)</span>, by cancellation we have <span class="math inline">\(\next(\zero) = \ntimes(\nmindiv(a),w)\)</span>, so that <span class="math inline">\(\nmindiv(a) = \next(\zero)\)</span>, a contradiction. Thus <span class="math inline">\(\ndiv(a,\nmindiv(a))\)</span>, so we have <span class="math inline">\(a = \nmindiv(a)\)</span> as needed.
</p>
</div>
</div>
<p>Minimal divisors are prime.</p>
<div class="result">
<div class="thm">
<p>Let <span class="math inline">\(a \in \nats\)</span> with <span class="math inline">\(a \neq \zero\)</span> and <span class="math inline">\(a \neq \next(\zero)\)</span>. Then <span class="math display">\[\nisprime(\nmindiv(a)) = \btrue.\]</span></p>
</div>
<div class="proof">
<p>
Let <span class="math inline">\(a \in \nats\)</span> with <span class="math inline">\(a \neq \zero\)</span> and <span class="math inline">\(a \neq \next(\zero)\)</span>, and let <span class="math inline">\(d = \nmindiv(a)\)</span>. Suppose now that <span class="math inline">\(d = \ntimes(u,v)\)</span>. Since <span class="math inline">\(d \neq \zero\)</span>, we have <span class="math inline">\(u \neq \zero\)</span>. If <span class="math inline">\(u = \next(\zero)\)</span>, we have <span class="math inline">\(v = d\)</span>. If <span class="math inline">\(u \neq \next(\zero)\)</span>, we have <span class="math inline">\(\ndiv(u,a)\)</span> and thus <span class="math inline">\(\nleq(d,u)\)</span>; but <span class="math inline">\(\nleq(u,d)\)</span>, so that <span class="math inline">\(d = u\)</span> by antisymmetry and thus <span class="math inline">\(v = \next(\zero)\)</span>. Thus <span class="math inline">\(\nisprime(\nmindiv(a))\)</span> as claimed.
</p>
</div>
</div>
<p>Primes interact with <span class="math inline">\(\ngcd\)</span> as expected.</p>
<div class="result">
<div class="thm">
<p>Let <span class="math inline">\(p,a \in \nats\)</span> with <span class="math inline">\(\nisprime(p)\)</span>. Then <span class="math display">\[\ngcd(a,p) = \left\{ \begin{array}{ll} p &amp; \mathrm{if}\ \ndiv(p,a) \\ \next(\zero) &amp; \mathrm{otherwise}. \end{array} \right.\]</span></p>
</div>
<div class="proof">
<p>
Let <span class="math inline">\(d = \ngcd(a,p)\)</span>. Now <span class="math inline">\(\ndiv(d,p)\)</span>, so that either <span class="math inline">\(d = \next(\zero)\)</span> or <span class="math inline">\(d = p\)</span>. If <span class="math inline">\(\ndiv(p,a) = \bfalse\)</span>, we thus have <span class="math inline">\(d = \next(\zero)\)</span>.
</p>
</div>
</div>
<h2 id="implementation-and-testing">Implementation and Testing</h2>
<p>Here’s <code>mindiv</code> and <code>prime</code>:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; mindiv ::</span> (<span class="dt">Natural</span> t) <span class="ot">=&gt;</span> t <span class="ot">-&gt;</span> t
<span class="ot">&gt;</span> mindiv a <span class="fu">=</span> theta a (next (next zero))
<span class="ot">&gt;</span>   <span class="kw">where</span>
<span class="ot">&gt;</span>     theta <span class="fu">=</span> bailoutRec (phi a) (beta a) (psi a) (omega a)
<span class="ot">&gt;</span> 
<span class="ot">&gt;</span>     phi   a   _ <span class="fu">=</span> a
<span class="ot">&gt;</span>     beta  a _ b <span class="fu">=</span> div b a
<span class="ot">&gt;</span>     psi   _ _ b <span class="fu">=</span> b
<span class="ot">&gt;</span>     omega a _ b <span class="fu">=</span> next b
<span class="ot">&gt;</span> 
<span class="ot">&gt;</span> 
<span class="ot">&gt; prime ::</span> (<span class="dt">Natural</span> n, <span class="dt">Equal</span> n) <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>
<span class="ot">&gt;</span> prime a <span class="fu">=</span> <span class="kw">if</span> leq a (next zero)
<span class="ot">&gt;</span>   <span class="kw">then</span> <span class="dt">False</span>
<span class="ot">&gt;</span>   <span class="kw">else</span> a <span class="fu">====</span> mindiv a</code></pre></div>
<p>Property tests:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> <span class="co">-- div(mindiv(a),a) == true</span>
<span class="ot">&gt;</span> _<span class="ot">test_mindiv_div ::</span> (<span class="dt">Natural</span> n)
<span class="ot">&gt;</span>   <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Nat</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>
<span class="ot">&gt;</span> _test_mindiv_div _ a <span class="fu">=</span>
<span class="ot">&gt;</span>   (div (mindiv a) a) <span class="fu">====</span> <span class="dt">True</span>
<span class="ot">&gt;</span> 
<span class="ot">&gt;</span> 
<span class="ot">&gt;</span> <span class="co">-- prime(mindiv(a)) == true</span>
<span class="ot">&gt;</span> _<span class="ot">test_prime_mindiv ::</span> (<span class="dt">Natural</span> n)
<span class="ot">&gt;</span>   <span class="ot">=&gt;</span> n <span class="ot">-&gt;</span> <span class="dt">Nat</span> n <span class="ot">-&gt;</span> <span class="dt">Bool</span>
<span class="ot">&gt;</span> _test_prime_mindiv _ a <span class="fu">=</span>
<span class="ot">&gt;</span>   <span class="kw">if</span> (a <span class="fu">====</span> zero) <span class="fu">|||</span> (a <span class="fu">====</span> next zero)
<span class="ot">&gt;</span>     <span class="kw">then</span> <span class="dt">True</span>
<span class="ot">&gt;</span>     <span class="kw">else</span> (prime (mindiv a)) <span class="fu">====</span> <span class="dt">True</span></code></pre></div>
<p>And the suite:</p>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt;</span> <span class="co">-- run all tests for prime</span>
<span class="ot">&gt;</span> _<span class="ot">test_prime ::</span> (<span class="dt">Natural</span> t, <span class="dt">Arbitrary</span> t, <span class="dt">Show</span> t)
<span class="ot">&gt;</span>   <span class="ot">=&gt;</span> t <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()
<span class="ot">&gt;</span> _test_prime t maxSize numCases <span class="fu">=</span> sequence_
<span class="ot">&gt;</span>   [ quickCheckWith args (_test_mindiv_div t)
<span class="ot">&gt;</span>   , quickCheckWith args (_test_prime_mindiv t)
<span class="ot">&gt;</span>   ]
<span class="ot">&gt;</span>   <span class="kw">where</span>
<span class="ot">&gt;</span>     args <span class="fu">=</span> stdArgs
<span class="ot">&gt;</span>       { maxSuccess <span class="fu">=</span> numCases
<span class="ot">&gt;</span>       , maxSize    <span class="fu">=</span> maxSize
<span class="ot">&gt;</span>       }</code></pre></div>
<div class="sourceCode"><pre class="sourceCode literate literatehaskell"><code class="sourceCode literatehaskell"><span class="ot">&gt; main_prime ::</span> <span class="dt">IO</span> ()
<span class="ot">&gt;</span> main_prime <span class="fu">=</span> _test_prime (<span class="ot">zero ::</span> <span class="dt">Unary</span>) <span class="dv">20</span> <span class="dv">100</span></code></pre></div>


<!-- END BODY -->
</div>

<div id="footer">
  Site generated by
  <a href="http://jaspervdj.be/hakyll">Hakyll</a>
</div>
</body>
</html>
