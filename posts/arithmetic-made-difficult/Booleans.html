<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>nbloomf.blog - Booleans</title>
<link rel="stylesheet" type="text/css" href="../../css/default.css" />
<link rel="icon" href="../../raw/gfx/icon/favicon-32.png" />
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../raw/gfx/icon/favicon-57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../raw/gfx/icon/favicon-114.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../raw/gfx/icon/favicon-152.png" />
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>

<body>
<div id="header">
  <div id="logo">
    <a href="../../index.html">nbloomf</a>
  </div>
  <div id="navigation">
    <a href="../../index.html">Home</a>
    <a href="../../pages/about.html">About</a>
    <a href="../../pages/projects.html">Projects</a>
    <a href="../../archive.html">Blog</a>
  </div>
</div>

<div id="content">
<h1>Booleans</h1>
<!-- BEGIN BODY -->


<div class="info">
Posted on 2014-04-01 by nbloomf
</div>


<div class="info tags">Tags: <a href="../../tag/arithmetic-made-difficult.html">arithmetic-made-difficult</a>, <a href="../../tag/literate-haskell.html">literate-haskell</a></div>


<!-- LaTeX Macros for Arithmetic Made Difficult -->
<div class="invisible">
<!-- basic maps -->
\(\newcommand{\id}{\mathsf{id}}\)
\(\newcommand{\const}{\mathsf{const}}\)

<!-- booleans -->
\(\newcommand{\bool}{\mathbb{B}}\)
\(\newcommand{\btrue}{\mathsf{true}}\)
\(\newcommand{\bfalse}{\mathsf{false}}\)
\(\newcommand{\bnot}{\mathsf{not}}\)
\(\newcommand{\band}{\mathbin{\mathsf{and}}}\)
\(\newcommand{\bor}{\mathbin{\mathsf{or}}}\)
\(\newcommand{\bimpl}{\mathbin{\mathsf{impl}}}\)
\(\newcommand{\beq}{\mathsf{eq}}\)
\(\newcommand{\bif}[3]{\mathsf{if}\left(#1,#2,#3\right)}\)

<!-- predicates -->
\(\newcommand{\ptrue}{\mathsf{ptrue}}\)
\(\newcommand{\pfalse}{\mathsf{pfalse}}\)
\(\newcommand{\pnot}{\mathsf{pnot}}\)
\(\newcommand{\pand}{\mathbin{\mathsf{pand}}}\)
\(\newcommand{\por}{\mathbin{\mathsf{por}}}\)
\(\newcommand{\pimpl}{\mathbin{\mathsf{pimpl}}}\)

<!-- tuples -->
\(\newcommand{\fst}{\mathsf{first}}\)
\(\newcommand{\snd}{\mathsf{second}}\)
\(\newcommand{\dup}{\mathsf{dup}}\)
\(\newcommand{\tSwap}{\mathsf{swap}_{\times}}\)
\(\newcommand{\tPair}{\mathsf{pair}_{\times}}\)
\(\newcommand{\tAssocL}{\mathsf{assocL}_{\times}}\)
\(\newcommand{\tAssocR}{\mathsf{assocR}_{\times}}\)
\(\newcommand{\tupL}{\mathsf{tupL}}\)
\(\newcommand{\tupR}{\mathsf{tupR}}\)

<!-- disjoint unions -->
\(\newcommand{\lft}{\mathsf{left}}\)
\(\newcommand{\rgt}{\mathsf{right}}\)
\(\newcommand{\either}{\mathsf{either}}\)
\(\newcommand{\uSwap}{\mathsf{swap}_{+}}\)
\(\newcommand{\uPair}{\mathsf{pair}_{+}}\)
\(\newcommand{\uAssocL}{\mathsf{assocL}_{+}}\)
\(\newcommand{\uAssocR}{\mathsf{assocR}_{+}}\)
\(\newcommand{\isLft}{\mathsf{isLeft}}\)
\(\newcommand{\isRgt}{\mathsf{isRight}}\)

<!-- natural numbers -->
\(\newcommand{\nats}{\mathbb{N}}\)
\(\newcommand{\zero}{\mathsf{0}}\)
\(\newcommand{\next}{\mathsf{next}}\)
\(\newcommand{\unnext}{\mathsf{unnext}}\)
\(\newcommand{\iszero}{\mathsf{isZero}}\)
\(\newcommand{\prev}{\mathsf{prev}}\)

<!-- natural number recursion -->
\(\newcommand{\natrec}[2]{\mathsf{natrec}(#1,#2)}\)
\(\newcommand{\simprec}[2]{\mathsf{simprec}(#1,#2)}\)
\(\newcommand{\bailrec}[4]{\mathsf{bailrec}(#1,#2,#3,#4)}\)
\(\newcommand{\mutrec}[3]{\mathsf{mutrec}(#1,#2,#3)}\)
\(\newcommand{\dnatrec}[3]{\mathsf{dnatrec}(#1,#2,#3)}\)
\(\newcommand{\normrec}[3]{\mathsf{normrec}(#1,#2,#3)}\)
\(\newcommand{\findsmallest}[1]{\mathsf{findsmallest}(#1)}\)

<!-- natural number arithmetic -->
\(\newcommand{\nequal}{\mathsf{eq}}\)
\(\newcommand{\nplus}{\mathsf{plus}}\)
\(\newcommand{\ntimes}{\mathsf{times}}\)
\(\newcommand{\nleq}{\mathsf{leq}}\)
\(\newcommand{\ngeq}{\mathsf{geq}}\)
\(\newcommand{\nminus}{\mathsf{minus}}\)
\(\newcommand{\nmax}{\mathsf{max}}\)
\(\newcommand{\nmin}{\mathsf{min}}\)
\(\newcommand{\ndivalg}{\mathsf{divalg}}\)
\(\newcommand{\nquo}{\mathsf{quo}}\)
\(\newcommand{\nrem}{\mathsf{rem}}\)
\(\newcommand{\ndiv}{\mathsf{div}}\)
\(\newcommand{\ngcd}{\mathsf{gcd}}\)
\(\newcommand{\ncoprime}{\mathsf{coprime}}\)
\(\newcommand{\nlcm}{\mathsf{lcm}}\)
\(\newcommand{\nmindiv}{\mathsf{mindiv}}\)
\(\newcommand{\nisprime}{\mathsf{isPrime}}\)
\(\newcommand{\npower}{\mathsf{power}}\)
\(\newcommand{\nchoose}{\mathsf{choose}}\)

<!-- categories -->
\(\newcommand{\dom}{\mathsf{dom}}\)
\(\newcommand{\cod}{\mathsf{cod}}\)

<!-- lists -->
\(\newcommand{\lists}[1]{\mathsf{List}(#1)}\)
\(\newcommand{\nil}{\mathsf{nil}}\)
\(\newcommand{\cons}{\mathsf{cons}}\)
\(\newcommand{\uncons}{\mathsf{uncons}}\)
\(\newcommand{\isnil}{\mathsf{isNil}}\)
\(\newcommand{\tail}{\mathsf{tail}}\)
\(\newcommand{\head}{\mathsf{head}}\)

<!-- list recursion -->
\(\newcommand{\foldr}[2]{\mathsf{foldr}(#1,#2)}\)
\(\newcommand{\foldl}[1]{\mathsf{foldl}(#1)}\)
\(\newcommand{\tacunfoldN}[1]{\mathsf{tacunfoldN}(#1)}\)
\(\newcommand{\unfoldN}[1]{\mathsf{unfoldN}(#1)}\)
\(\newcommand{\dfoldr}[3]{\mathsf{dfoldr}(#1,#2,#3)}\)
\(\newcommand{\cfoldr}[2]{\mathsf{cfoldr}(#1,#2)}\)
\(\newcommand{\bfoldr}[4]{\mathsf{bfoldr}(#1,#2,#3,#4)}\)
\(\newcommand{\dbfoldr}[5]{\mathsf{dbfoldr}(#1,#2,#3,#4,#5)}\)

<!-- list arithmetic -->
\(\newcommand{\snoc}{\mathsf{snoc}}\)
\(\newcommand{\revcat}{\mathsf{revcat}}\)
\(\newcommand{\rev}{\mathsf{rev}}\)
\(\newcommand{\cat}{\mathsf{cat}}\)
\(\newcommand{\addlength}{\mathsf{addlength}}\)
\(\newcommand{\length}{\mathsf{length}}\)
\(\newcommand{\head}{\mathsf{head}}\)
\(\newcommand{\at}{\mathsf{at}}\)
\(\newcommand{\map}{\mathsf{map}}\)
\(\newcommand{\range}{\mathsf{range}}\)
\(\newcommand{\zip}{\mathsf{zip}}\)
\(\newcommand{\zipPad}{\mathsf{zipPad}}\)
\(\newcommand{\unzip}{\mathsf{unzip}}\)
\(\newcommand{\prefix}{\mathsf{prefix}}\)
\(\newcommand{\suffix}{\mathsf{suffix}}\)
\(\newcommand{\lcp}{\mathsf{lcp}}\)
\(\newcommand{\lcs}{\mathsf{lcs}}\)
\(\newcommand{\all}{\mathsf{all}}\)
\(\newcommand{\any}{\mathsf{any}}\)
\(\newcommand{\tails}{\mathsf{tails}}\)
\(\newcommand{\inits}{\mathsf{inits}}\)
\(\newcommand{\filter}{\mathsf{filter}}\)
\(\newcommand{\elt}{\mathsf{elt}}\)
\(\newcommand{\addcount}{\mathsf{addcount}}\)
\(\newcommand{\count}{\mathsf{count}}\)
\(\newcommand{\repeat}{\mathsf{repeat}}\)
\(\newcommand{\sublist}{\mathsf{sublist}}\)
\(\newcommand{\infix}{\mathsf{infix}}\)
\(\newcommand{\select}{\mathsf{select}}\)
\(\newcommand{\unique}{\mathsf{unique}}\)
\(\newcommand{\delete}{\mathsf{delete}}\)
\(\newcommand{\dedupeL}{\mathsf{dedupeL}}\)
\(\newcommand{\dedupeR}{\mathsf{dedupeR}}\)
\(\newcommand{\take}{\mathsf{take}}\)
\(\newcommand{\drop}{\mathsf{drop}}\)
\(\newcommand{\takeBut}{\mathsf{takeBut}}\)
\(\newcommand{\dropBut}{\mathsf{dropBut}}\)
\(\newcommand{\takeWhile}{\mathsf{takeWhile}}\)
\(\newcommand{\dropWhile}{\mathsf{dropWhile}}\)
</div>
<!-- End LaTeX Macros for Arithmetic Made Difficult -->

<p class="post-info">This page is part of a series on <a href="../../pages/amd.html">Arithmetic Made Difficult</a>.</p>

<p class="post-info">This post is literate Haskell; you can load <a href="https://raw.githubusercontent.com/nbloomf/nbloomf.md/master/posts/arithmetic-made-difficult/Booleans.lhs">the source</a> into GHCi and play along.</p>

<hr />

<div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">module</span> <span class="dt">Booleans</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">  ( <span class="dt">Bool</span>(<span class="fu">..</span>), not, and, or, impl, ifThenElse</a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  , <span class="dt">Equal</span>, eq</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  , _test_boolean, main_boolean</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">  , <span class="dt">Test</span>, runTest, testName, testLabel, withTypeOf, <span class="dt">TypeName</span>(<span class="fu">..</span>)</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">  , testLabel1, testLabel2, testLabel3</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"></a>
<a class="sourceLine" id="cb1-9" data-line-number="9">  , <span class="kw">module</span> <span class="dt">Prelude</span></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">  , <span class="kw">module</span> <span class="dt">Test.QuickCheck</span></a>
<a class="sourceLine" id="cb1-11" data-line-number="11">  , <span class="kw">module</span> <span class="dt">Test.QuickCheck.Test</span></a>
<a class="sourceLine" id="cb1-12" data-line-number="12">) <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-13" data-line-number="13"></a>
<a class="sourceLine" id="cb1-14" data-line-number="14"><span class="kw">import</span> <span class="dt">Prelude</span></a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  ( <span class="dt">Show</span>(show), <span class="dt">IO</span>, <span class="dt">Bool</span>(<span class="fu">..</span>), <span class="dt">Int</span>, <span class="dt">Maybe</span>(<span class="fu">..</span>), <span class="dt">Either</span>(<span class="fu">..</span>), id, undefined, concat</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">  , putStrLn, (<span class="fu">&gt;&gt;</span>), return, (<span class="fu">++</span>), <span class="dt">String</span>, (<span class="fu">.</span>), (<span class="fu">$</span>), <span class="dt">Integer</span>, const, uncurry</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">  )</a>
<a class="sourceLine" id="cb1-18" data-line-number="18"><span class="kw">import</span> <span class="dt">Test.QuickCheck</span></a>
<a class="sourceLine" id="cb1-19" data-line-number="19">  ( <span class="dt">Testable</span>(<span class="fu">..</span>), <span class="dt">Args</span>(<span class="fu">..</span>), <span class="dt">Arbitrary</span>(<span class="fu">..</span>), <span class="dt">CoArbitrary</span>(<span class="fu">..</span>)</a>
<a class="sourceLine" id="cb1-20" data-line-number="20">  , quickCheckWithResult, stdArgs, variant</a>
<a class="sourceLine" id="cb1-21" data-line-number="21">  )</a>
<a class="sourceLine" id="cb1-22" data-line-number="22"><span class="kw">import</span> <span class="dt">Test.QuickCheck.Test</span> (isSuccess)</a>
<a class="sourceLine" id="cb1-23" data-line-number="23"><span class="kw">import</span> <span class="dt">Text.Show.Functions</span></a>
<a class="sourceLine" id="cb1-24" data-line-number="24"><span class="kw">import</span> <span class="dt">System.Exit</span></a></code></pre></div>
<p>Before we think about numbers or writing programs, let’s start by nailing down some important ideas about truth values. In math there can be a kind of other-worldness about True and False, since they live in the “metalanguage” of mathematical logic rather than the “object language” of whatever we are studying. But it will turn out to be useful to algebraify the truth values themselves.</p>
<div class="definition">
<p><a href="#def-bool"></a> We define a set <span class="math inline">\(\bool = \{\btrue,\bfalse\}\)</span>. The elements of <span class="math inline">\(\bool\)</span> are called <em>booleans</em> or <em>truth values</em>.</p>
</div>
<p>We can model <span class="math inline">\(\bool\)</span> using the built in Haskell type <code>Bool</code>, which looks something like this.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">data</span> <span class="dt">Bool</span> <span class="fu">=</span> <span class="dt">True</span> <span class="fu">|</span> <span class="dt">False</span></a></code></pre></div>
<p>We also define the usual logical operators in turn. First, <span class="math inline">\(\bnot\)</span>:</p>
<div class="definition">
<p><a href="#def-not"></a> We define <span class="math inline">\(\bnot : \bool \rightarrow \bool\)</span> by <span class="math display">\[\begin{eqnarray*}
\bnot(\btrue)  &amp; = &amp; \bfalse \\
\bnot(\bfalse) &amp; = &amp; \btrue.
\end{eqnarray*}\]</span></p>
<p>In Haskell:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1">not<span class="ot"> ::</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2">not <span class="dt">True</span>  <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">not <span class="dt">False</span> <span class="fu">=</span> <span class="dt">True</span></a></code></pre></div>
</div>
<p>Where <span class="math inline">\(\bnot\)</span> is an involution.</p>
<div class="theorem">
<p><a href="#not-involution"></a> For all <span class="math inline">\(a \in \bool\)</span> we have <span class="math inline">\(\bnot(\bnot(a)) = a\)</span>.</p>
<div class="proof">
<p>If <span class="math inline">\(a = \btrue\)</span> we have <span class="math display">\[\bnot(\bnot(\btrue)) = \bnot(\bfalse) = \btrue,\]</span> and if <span class="math inline">\(a = \bfalse\)</span>, we have <span class="math display">\[\bnot(\bnot(\bfalse)) = \bnot(\btrue) = \bfalse\]</span> as claimed.</p>
</div>
<div class="test">
<div class="sourceCode" id="cb4"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="ot">_test_not_involutive ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">_test_not_involutive <span class="fu">=</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  testName <span class="st">&quot;not(not(p)) == p&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">  \p <span class="ot">-&gt;</span> eq (not (not p)) p</a></code></pre></div>
</div>
</div>
<p>Next, <span class="math inline">\(\band\)</span>:</p>
<div class="result">
<div class="defn">
<p>
<p><a name="def-and"></a> We define a map <span class="math inline">\(\band : \bool \times \bool \rightarrow \bool\)</span> by <span class="math display">\[\begin{eqnarray*}
\band(\btrue,\btrue)   &amp; = &amp; \btrue \\
\band(\btrue,\bfalse)  &amp; = &amp; \bfalse \\
\band(\bfalse,\btrue)  &amp; = &amp; \bfalse \\
\band(\bfalse,\bfalse) &amp; = &amp; \bfalse.
\end{eqnarray*}\]</span></p>
<p>In Haskell:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1">and<span class="ot"> ::</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">and <span class="dt">True</span> <span class="dt">True</span> <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">and _    _    <span class="fu">=</span> <span class="dt">False</span></a></code></pre></div>
</p>
</div>
</div>
<p>And <span class="math inline">\(\band\)</span> satisfies the usual properties.</p>
<div class="result">
<div class="thm">
<p>
<p>The following hold for all <span class="math inline">\(a,b,c \in \bool\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(\band(\bfalse,a) = \band(a,\bfalse) = \bfalse\)</span>.</li>
<li><span class="math inline">\(\band(\btrue,a) = \band(a,\btrue) = a\)</span>.</li>
<li><span class="math inline">\(\band(a,\bnot(a)) = \bfalse\)</span>.</li>
<li><span class="math inline">\(\band(a,a) = a\)</span>.</li>
<li><span class="math inline">\(\band(a,b) = \band(b,a)\)</span>.</li>
<li><span class="math inline">\(\band(\band(a,b),c) = \band(a,\band(b,c))\)</span>.</li>
</ol>
</p>
</div>
<div class="proof">
<p>
<ol type="1">
<li>If <span class="math inline">\(a = \btrue\)</span> we have <span class="math display">\[\band(\bfalse,\btrue) = \bfalse = \band(\btrue,\bfalse),\]</span> and if <span class="math inline">\(a = \bfalse\)</span> we have <span class="math display">\[\band(\bfalse,\bfalse) = \bfalse\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span> we have <span class="math display">\[\band(\btrue,\btrue) = \btrue,\]</span> and if <span class="math inline">\(a = \bfalse\)</span> we have <span class="math display">\[\band(\btrue,\bfalse) = \bfalse = \band(\bfalse,\btrue)\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span>, we have <span class="math inline">\(\band(\btrue,\bnot(\btrue)) = \band(\btrue,\bfalse) = \bfalse,\)</span>$ and if <span class="math inline">\(a = \bfalse\)</span>, we have <span class="math display">\[\band(\bfalse,\bnot(\bfalse)) = \bfalse\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span> we have <span class="math display">\[\band(\btrue,\btrue) = \btrue,\]</span> and if <span class="math inline">\(a = \bfalse\)</span> we have <span class="math display">\[\band(\bfalse,\bfalse) = \bfalse\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span> we have <span class="math display">\[\band(\btrue,b) = b = \band(b,\btrue),\]</span> and if <span class="math inline">\(a = \bfalse\)</span> we have <span class="math display">\[\band(\bfalse,b) = \bfalse = \band(b,\bfalse)\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \band(\band(a,b),c) \\
 &amp; = &amp; \band(\band(\btrue,b),c) \\
 &amp; = &amp; \band(b,c) \\
 &amp; = &amp; \band(\btrue,\band(b,c)) \\
 &amp; = &amp; \band(a,\band(b,c))
\end{eqnarray*}\]</span> as claimed. If <span class="math inline">\(a = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \band(\band(a,b),c) \\
 &amp; = &amp; \band(\band(\bfalse,b),c) \\
 &amp; = &amp; \band(\bfalse,c) \\
 &amp; = &amp; \bfalse \\
 &amp; = &amp; \band(\bfalse,\band(b,c))
\end{eqnarray*}\]</span> as claimed.</li>
</ol>
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb6"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="ot">_test_and_false ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">_test_and_false <span class="fu">=</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  testName <span class="st">&quot;and(false,p) == false&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">  \p <span class="ot">-&gt;</span> eq (and <span class="dt">False</span> p) <span class="dt">False</span></a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6"></a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="ot">_test_and_true ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">_test_and_true <span class="fu">=</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">  testName <span class="st">&quot;and(true,p) == p&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb6-10" data-line-number="10">  \p <span class="ot">-&gt;</span> eq (and <span class="dt">True</span> p) p</a>
<a class="sourceLine" id="cb6-11" data-line-number="11"></a>
<a class="sourceLine" id="cb6-12" data-line-number="12"></a>
<a class="sourceLine" id="cb6-13" data-line-number="13"><span class="ot">_test_and_not ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb6-14" data-line-number="14">_test_and_not <span class="fu">=</span></a>
<a class="sourceLine" id="cb6-15" data-line-number="15">  testName <span class="st">&quot;and(p,not(p)) == false&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb6-16" data-line-number="16">  \p <span class="ot">-&gt;</span> eq (and p (not p)) <span class="dt">False</span></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"></a>
<a class="sourceLine" id="cb6-18" data-line-number="18"></a>
<a class="sourceLine" id="cb6-19" data-line-number="19"><span class="ot">_test_and_idempotent ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb6-20" data-line-number="20">_test_and_idempotent <span class="fu">=</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21">  testName <span class="st">&quot;and(p,p) == p&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb6-22" data-line-number="22">  \p <span class="ot">-&gt;</span> eq (and p p) p</a>
<a class="sourceLine" id="cb6-23" data-line-number="23"></a>
<a class="sourceLine" id="cb6-24" data-line-number="24"></a>
<a class="sourceLine" id="cb6-25" data-line-number="25"><span class="ot">_test_and_commutative ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">_test_and_commutative <span class="fu">=</span></a>
<a class="sourceLine" id="cb6-27" data-line-number="27">  testName <span class="st">&quot;and(p,q) == and(q,p)&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb6-28" data-line-number="28">  \p q <span class="ot">-&gt;</span> eq (and p q) (and q p)</a>
<a class="sourceLine" id="cb6-29" data-line-number="29"></a>
<a class="sourceLine" id="cb6-30" data-line-number="30"></a>
<a class="sourceLine" id="cb6-31" data-line-number="31"><span class="ot">_test_and_associative ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb6-32" data-line-number="32">_test_and_associative <span class="fu">=</span></a>
<a class="sourceLine" id="cb6-33" data-line-number="33">  testName <span class="st">&quot;and(and(p,q),r) == and(p,and(q,r))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb6-34" data-line-number="34">  \p q r <span class="ot">-&gt;</span> eq (and (and p q) r) (and p (and q r))</a></code></pre></div>
</p>
</div>
</div>
<p>Finally, <span class="math inline">\(\bor\)</span>:</p>
<div class="result">
<div class="defn">
<p>
<p><a name="def-or"></a> We define <span class="math inline">\(\bor : \bool \times \bool \rightarrow \bool\)</span> by <span class="math display">\[\begin{eqnarray*}
\bor(\btrue,\btrue)   &amp; = &amp; \btrue \\
\bor(\btrue,\bfalse)  &amp; = &amp; \btrue \\
\bor(\bfalse,\btrue)  &amp; = &amp; \btrue \\
\bor(\bfalse,\bfalse) &amp; = &amp; \bfalse.
\end{eqnarray*}\]</span></p>
<p>In Haskell:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" data-line-number="1">or<span class="ot"> ::</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb7-2" data-line-number="2">or <span class="dt">False</span> <span class="dt">False</span> <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">or _     _     <span class="fu">=</span> <span class="dt">True</span></a></code></pre></div>
</p>
</div>
</div>
<p>And <span class="math inline">\(\bor\)</span> satisfies the usual properties.</p>
<div class="result">
<div class="thm">
<p>
<p>The following hold for all <span class="math inline">\(a,b,c \in \bool\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(\bor(\btrue,a) = \bor(a,\btrue) = \btrue\)</span>.</li>
<li><span class="math inline">\(\bor(\bfalse,a) = \bor(a,\bfalse) = a\)</span>.</li>
<li><span class="math inline">\(\bor(p,\bnot(p)) = \btrue\)</span>.</li>
<li><span class="math inline">\(\bor(a,a) = a\)</span>.</li>
<li><span class="math inline">\(\bor(a,b) = \bor(b,a)\)</span>.</li>
<li><span class="math inline">\(\bor(\bor(a,b),c) = \bor(a,\bor(b,c))\)</span>.</li>
</ol>
</p>
</div>
<div class="proof">
<p>
<ol type="1">
<li>If <span class="math inline">\(a = \btrue\)</span>, we have <span class="math display">\[\bor(\btrue,\btrue) = \btrue,\]</span> and if <span class="math inline">\(a = \bfalse\)</span> we have <span class="math display">\[\bor(\btrue,\bfalse) = \btrue = \bor(\bfalse,\btrue)\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span>, we have <span class="math display">\[\bor(\bfalse,\btrue) = \btrue = \bor(\btrue,\bfalse),\]</span> and if <span class="math inline">\(a = \bfalse\)</span> we have <span class="math display">\[\bor(\bfalse,\bfalse) = \bfalse\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span>, we have <span class="math display">\[\bor(\btrue,\bnot(\btrue)) = \btrue,\]</span> and if <span class="math inline">\(a = \bfalse\)</span> we have <span class="math display">\[\bor(\bfalse,\bnot(\bfalse)) = \bor(\bfalse,\btrue) = \btrue\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span> we have <span class="math display">\[\bor(\btrue,\btrue) = \btrue,\]</span> and if <span class="math inline">\(a = \bfalse\)</span> then <span class="math display">\[\bor(\bfalse,\bfalse) = \bfalse\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span> we have <span class="math display">\[\bor(\btrue,b) = \btrue = \bor(b,\btrue),\]</span> and if <span class="math inline">\(a = \bfalse\)</span> we have <span class="math display">\[\bor(\bfalse,b) = b = \bor(b,\bfalse)\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span> we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bor(\bor(a,b),c) \\
 &amp; = &amp; \bor(\bor(\btrue,b),c) \\
 &amp; = &amp; \bor(\btrue,c) \\
 &amp; = &amp; \btrue \\
 &amp; = &amp; \bor(\btrue,\bor(b,c))
\end{eqnarray*}\]</span> as claimed. If <span class="math inline">\(a = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bor(\bor(a,b),c) \\
 &amp; = &amp; \bor(\bor(\bfalse,b),c) \\
 &amp; = &amp; \bor(b,c) \\
 &amp; = &amp; \bor(\bfalse,\bor(b,c))
\end{eqnarray*}\]</span> as claimed.</li>
</ol>
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb8"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="ot">_test_or_true ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">_test_or_true <span class="fu">=</span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  testName <span class="st">&quot;or(true,p) == true&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  \p <span class="ot">-&gt;</span> eq (or <span class="dt">True</span> p) <span class="dt">True</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="ot">_test_or_false ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">_test_or_false <span class="fu">=</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9">  testName <span class="st">&quot;or(false,p) == p&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10">  \p <span class="ot">-&gt;</span> eq (or <span class="dt">False</span> p) p</a>
<a class="sourceLine" id="cb8-11" data-line-number="11"></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="ot">_test_or_not ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb8-14" data-line-number="14">_test_or_not <span class="fu">=</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15">  testName <span class="st">&quot;or(p,not(p)) == true&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16">  \p <span class="ot">-&gt;</span> eq (or p (not p)) <span class="dt">True</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="ot">_test_or_idempotent ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb8-20" data-line-number="20">_test_or_idempotent <span class="fu">=</span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21">  testName <span class="st">&quot;or(p,p) == p&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22">  \p <span class="ot">-&gt;</span> eq (or p p) p</a>
<a class="sourceLine" id="cb8-23" data-line-number="23"></a>
<a class="sourceLine" id="cb8-24" data-line-number="24"></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="ot">_test_or_commutative ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb8-26" data-line-number="26">_test_or_commutative <span class="fu">=</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27">  testName <span class="st">&quot;or(p,q) == or(q,p)&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28">  \p q <span class="ot">-&gt;</span> eq (or p q) (or q p)</a>
<a class="sourceLine" id="cb8-29" data-line-number="29"></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="ot">_test_or_associative ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb8-32" data-line-number="32">_test_or_associative <span class="fu">=</span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33">  testName <span class="st">&quot;or(or(p,q),r) == or(p,or(q,r))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34">  \p q r <span class="ot">-&gt;</span> eq (or (or p q) r) (or p (or q r))</a></code></pre></div>
</p>
</div>
</div>
<p>Now <span class="math inline">\(\bnot\)</span>, <span class="math inline">\(\band\)</span>, and <span class="math inline">\(\bor\)</span> interact in the usual way.</p>
<div class="result">
<div class="thm">
<p>
<p>The following hold for all <span class="math inline">\(a,b,c \in \bool\)</span>.</p>
<ol type="1">
<li><span class="math inline">\(\bnot(\band(a,b)) = \bor(\bnot(a),\bnot(b))\)</span>.</li>
<li><span class="math inline">\(\bnot(\bor(a,b)) = \band(\bnot(a),\bnot(b))\)</span>.</li>
<li><span class="math inline">\(\band(a,\bor(b,c)) = \bor(\band(a,b),\band(a,c))\)</span>.</li>
<li><span class="math inline">\(\bor(a,\band(b,c)) = \band(\bor(a,b),\bor(a,c))\)</span>.</li>
</ol>
</p>
</div>
<div class="proof">
<p>
<ol type="1">
<li>If <span class="math inline">\(a = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bnot(\band(a,b)) \\
 &amp; = &amp; \bnot(\band(\btrue,b)) \\
 &amp; = &amp; \bnot(b) \\
 &amp; = &amp; \bor(\bfalse,\bnot(b)) \\
 &amp; = &amp; \bor(\bnot(\btrue),\bnot(b)) \\
 &amp; = &amp; \bor(\bnot(a),\bnot(b))
\end{eqnarray*}\]</span> as claimed. If <span class="math inline">\(a = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bnot(\band(a,b)) \\
 &amp; = &amp; \bnot(\band(\bfalse,b)) \\
 &amp; = &amp; \bnot(\bfalse) \\
 &amp; = &amp; \btrue \\
 &amp; = &amp; \bor(\btrue,\bnot(b)) \\
 &amp; = &amp; \bor(\bnot(\bfalse),\bnot(b)) \\
 &amp; = &amp; \bor(\bnot(a),\bnot(b))
\end{eqnarray*}\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bnot(\bor(a,b)) \\
 &amp; = &amp; \bnot(\bor(\btrue,b)) \\
 &amp; = &amp; \bnot(\btrue) \\
 &amp; = &amp; \bfalse \\
 &amp; = &amp; \band(\bfalse,\bnot(b)) \\
 &amp; = &amp; \band(\bnot(\btrue),\bnot(b)) \\
 &amp; = &amp; \band(\bnot(a),\bnot(b))
\end{eqnarray*}\]</span> as claimed. If <span class="math inline">\(b = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bnot(\bor(a,b)) \\
 &amp; = &amp; \bnot(\bor(\bfalse,b)) \\
 &amp; = &amp; \bnot(b) \\
 &amp; = &amp; \band(\btrue,\bnot(b)) \\
 &amp; = &amp; \band(\bnot(\bfalse),\bnot(b)) \\
 &amp; = &amp; \band(\bnot(a),\bnot(b))
\end{eqnarray*}\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \band(a,\bor(b,c)) \\
 &amp; = &amp; \band(\btrue,\bor(b,c)) \\
 &amp; = &amp; \bor(b,c) \\
 &amp; = &amp; \bor(\band(\btrue,b),\band(\btrue,c)) \\
 &amp; = &amp; \bor(\band(a,b),\band(a,c))
\end{eqnarray*}\]</span> as claimed. If <span class="math inline">\(a = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \band(a,\bor(b,c)) \\
 &amp; = &amp; \band(\bfalse,\bor(b,c)) \\
 &amp; = &amp; \bfalse \\
 &amp; = &amp; \bor(\bfalse,\bfalse) \\
 &amp; = &amp; \bor(\band(\bfalse,b),\band(\bfalse,c)) \\
 &amp; = &amp; \bor(\band(a,b),\band(a,c))
\end{eqnarray*}\]</span> as claimed.</li>
<li>If <span class="math inline">\(a = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bor(a,\band(b,c)) \\
 &amp; = &amp; \bor(\btrue,\band(b,c)) \\
 &amp; = &amp; \btrue \\
 &amp; = &amp; \band(\btrue,\btrue) \\
 &amp; = &amp; \band(\bor(\btrue,b),\bor(\btrue,c)) \\
 &amp; = &amp; \band(\bor(a,b),\bor(a,c))
\end{eqnarray*}\]</span> as claimed. If <span class="math inline">\(a = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bor(a,\band(b,c)) \\
 &amp; = &amp; \bor(\bfalse,\band(b,c)) \\
 &amp; = &amp; \band(b,c) \\
 &amp; = &amp; \band(\bor(\bfalse,b),\bor(\bfalse,c)) \\
 &amp; = &amp; \band(\bor(a,b),\bor(a,c))
\end{eqnarray*}\]</span> as claimed.</li>
</ol>
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb9"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="ot">_test_not_and ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">_test_not_and <span class="fu">=</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  testName <span class="st">&quot;not(and(p,q)) == or(not(p),not(q))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  \p q <span class="ot">-&gt;</span> eq (not (and p q)) (or (not p) (not q))</a>
<a class="sourceLine" id="cb9-5" data-line-number="5"></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="ot">_test_not_or ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">_test_not_or <span class="fu">=</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9">  testName <span class="st">&quot;not(or(p,q)) == and(not(p),not(q))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10">  \p q <span class="ot">-&gt;</span> eq (not (or p q)) (and (not p) (not q))</a>
<a class="sourceLine" id="cb9-11" data-line-number="11"></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="ot">_test_and_or ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">_test_and_or <span class="fu">=</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15">  testName <span class="st">&quot;and(p,or(q,r)) == or(and(p,q),and(p,r))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16">  \p q r <span class="ot">-&gt;</span> eq (and p (or q r)) (or (and p q) (and p r))</a>
<a class="sourceLine" id="cb9-17" data-line-number="17"></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="ot">_test_or_and ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">_test_or_and <span class="fu">=</span></a>
<a class="sourceLine" id="cb9-21" data-line-number="21">  testName <span class="st">&quot;or(p,and(q,r)) == and(or(p,q),or(p,r))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22">  \p q r <span class="ot">-&gt;</span> eq (or p (and q r)) (and (or p q) (or p r))</a></code></pre></div>
</p>
</div>
</div>
<p>Implication on booleans:</p>
<div class="result">
<div class="defn">
<p>
<p>We define <span class="math inline">\(\bimpl : \bool \times \bool \rightarrow \bool\)</span> by <span class="math display">\[\bimpl(p,q) = \bor(\bnot(p),q).\]</span></p>
<p>In Haskell:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="ot">impl ::</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2">impl p q <span class="fu">=</span> or (not p) q</a></code></pre></div>
</p>
</div>
</div>
<p>And implication has its own properties.</p>
<div class="result">
<div class="thm">
<p>
<p>For all <span class="math inline">\(p,q,r,s \in \bool\)</span> we have the following.</p>
<ol type="1">
<li><span class="math inline">\(\bimpl(\bfalse,p) = \btrue\)</span>.</li>
<li><span class="math inline">\(\bimpl(\btrue,p) = p\)</span>.</li>
<li><span class="math inline">\(\bimpl(p,p)\)</span>.</li>
<li><span class="math inline">\(\bor(\bimpl(p,q),\bimpl(q,p))\)</span>.</li>
<li><span class="math inline">\(\bimpl(p,\bimpl(q,r)) = \bimpl(q,\bimpl(p,r))\)</span>.</li>
<li><span class="math inline">\(\bimpl(\bimpl(p,q),\bimpl(\bimpl(q,r),\bimpl(p,r)))\)</span>.</li>
<li><span class="math inline">\(\bimpl(\bimpl(p,\bimpl(q,r)),\bimpl(\bimpl(p,q),\bimpl(p,r)))\)</span>.</li>
</ol>
</p>
</div>
<div class="proof">
<p>
<ol type="1">
<li>We have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bimpl(\bfalse,p) \\
 &amp; = &amp; \bor(\bnot(\bfalse),p) \\
 &amp; = &amp; \bor(\btrue,p) \\
 &amp; = &amp; \btrue
\end{eqnarray*}\]</span> as claimed.</li>
<li>We have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bimpl(\btrue,p) \\
 &amp; = &amp; \bor(\bnot(\btrue),p) \\
 &amp; = &amp; \bor(\bfalse,p) \\
 &amp; = &amp; p
\end{eqnarray*}\]</span> as claimed.</li>
<li>If <span class="math inline">\(p = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bimpl(\btrue,\btrue) \\
 &amp; = &amp; \bor(\bnot(\btrue),\btrue) \\
 &amp; = &amp; \btrue
\end{eqnarray*}\]</span> as claimed.</li>
<li>We have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bor(\bimpl(p,q),\bimpl(q,p)) \\
 &amp; = &amp; \bor(\bor(\bnot(p),q),\bor(\bnot(q),p)) \\
 &amp; = &amp; \bor(\bnot(p),\bor(q,\bor(\bnot(q),p))) \\
 &amp; = &amp; \bor(\bnot(p),\bor(\bor(q,\bnot(q)),p)) \\
 &amp; = &amp; \bor(\bnot(p),\bor(\btrue,p)) \\
 &amp; = &amp; \bor(\bnot(p),\btrue) \\
 &amp; = &amp; \btrue
\end{eqnarray*}\]</span> as needed.</li>
<li>We have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bimpl(p,\bimpl(q,r)) \\
 &amp; = &amp; \bor(\bnot(p),\bimpl(q,r)) \\
 &amp; = &amp; \bor(\bnot(p),\bor(\bnot(q),r)) \\
 &amp; = &amp; \bor(\bor(\bnot(p),\bnot(q)),r) \\
 &amp; = &amp; \bor(\bor(\bnot(q),\bnot(p)),r) \\
 &amp; = &amp; \bor(\bnot(q),\bor(\bnot(p),r)) \\
 &amp; = &amp; \bor(\bnot(q),\bimpl(p,r)) \\
 &amp;   &amp; \bimpl(q,\bimpl(p,r))
\end{eqnarray*}\]</span> as claimed.</li>
<li>We have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bimpl(\bimpl(p,q),\bimpl(\bimpl(q,r),\bimpl(p,r))) \\
 &amp; = &amp; \bimpl(\bor(\bnot(p),q),\bor(\bnot(\bimpl(q,r)),\bimpl(p,r))) \\
 &amp; = &amp; \bimpl(\bor(\bnot(p),q),\bor(\bnot(\bor(\bnot(q),r)),\bor(\bnot(p),r))) \\
 &amp; = &amp; \bor(\bnot(\bor(\bnot(p),q)),\bor(\bnot(\bor(\bnot(q),r)),\bor(\bnot(p),r))) \\
 &amp; = &amp; \bor(\band(\bnot(\bnot(p)),\bnot(q))),\bor(\bnot(\bor(\bnot(q),r)),\bor(\bnot(p),r))) \\
 &amp; = &amp; \bor(\band(p,\bnot(q)),\bor(\bnot(\bor(\bnot(q),r)),\bor(\bnot(p),r))) \\
 &amp; = &amp; \bor(\band(p,\bnot(q)),\bor(\band(\bnot(\bnot(q)),\bnot(r))),\bor(\bnot(p),r))) \\
 &amp; = &amp; \bor(\band(p,\bnot(q)),\bor(\band(q,\bnot(r)),\bor(\bnot(p),r))) \\
 &amp; = &amp; Q.
\end{eqnarray*}\]</span> If <span class="math inline">\(p = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; Q \\
 &amp; = &amp; \bor(\band(p,\bnot(q)),\bor(\band(q,\bnot(r)),\bor(\bnot(\bfalse),r))) \\
 &amp; = &amp; \bor(\band(p,\bnot(q)),\bor(\band(q,\bnot(r)),\bor(\btrue,r))) \\
 &amp; = &amp; \bor(\band(p,\bnot(q)),\bor(\band(q,\bnot(r)),\btrue)) \\
 &amp; = &amp; \bor(\band(p,\bnot(q)),\btrue) \\
 &amp; = &amp; \btrue.
\end{eqnarray*}\]</span> If <span class="math inline">\(p = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; Q \\
 &amp; = &amp; \bor(\band(\btrue,\bnot(q)),\bor(\band(q,\bnot(r)),\bor(\bnot(\btrue),r))) \\
 &amp; = &amp; \bor(\bnot(q),\bor(\band(q,\bnot(r)),\bor(\bfalse,r))) \\
 &amp; = &amp; \bor(\bnot(q),\bor(\band(q,\bnot(r)),r)) \\
 &amp; = &amp; \bor(\bnot(q),\band(\bor(q,r),\bor(\bnot(r),r))) \\
 &amp; = &amp; \bor(\bnot(q),\band(\bor(q,r),\btrue)) \\
 &amp; = &amp; \bor(\bnot(q),\bor(q,r)) \\
 &amp; = &amp; \bor(\bor(\bnot(q),q),r) \\
 &amp; = &amp; \bor(\btrue,r) \\
 &amp; = &amp; \btrue
\end{eqnarray*}\]</span> as needed.</li>
<li>If <span class="math inline">\(p = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bimpl(\bimpl(p,\bimpl(q,r)),\bimpl(\bimpl(p,q),\bimpl(p,r))) \\
 &amp; = &amp; \bimpl(\bimpl(\bfalse,\bimpl(q,r)),\bimpl(\bimpl(\bfalse,q),\bimpl(\bfalse,r))) \\
 &amp; = &amp; \bimpl(\btrue,\bimpl(\btrue,\btrue)) \\
 &amp; = &amp; \bimpl(\btrue,\btrue) \\
 &amp; = &amp; \btrue.
\end{eqnarray*}\]</span> Suppose instead that <span class="math inline">\(p = \btrue\)</span>. Now <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bimpl(\bimpl(p,\bimpl(q,r)),\bimpl(\bimpl(p,q),\bimpl(p,r))) \\
 &amp; = &amp; \bimpl(\bimpl(\btrue,\bimpl(q,r)),\bimpl(\bimpl(\btrue,q),\bimpl(\btrue,r))) \\
 &amp; = &amp; \bimpl(\bimpl(q,r),\bimpl(\bimpl(q,r)) \\
 &amp; = &amp; \btrue
\end{eqnarray*}\]</span> as claimed.</li>
</ol>
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb11"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="ot">_test_impl_false ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">_test_impl_false <span class="fu">=</span></a>
<a class="sourceLine" id="cb11-3" data-line-number="3">  testName <span class="st">&quot;impl(false,p) == true&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-4" data-line-number="4">  \p <span class="ot">-&gt;</span> eq (impl <span class="dt">False</span> p) <span class="dt">True</span></a>
<a class="sourceLine" id="cb11-5" data-line-number="5"></a>
<a class="sourceLine" id="cb11-6" data-line-number="6"></a>
<a class="sourceLine" id="cb11-7" data-line-number="7"><span class="ot">_test_impl_true ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb11-8" data-line-number="8">_test_impl_true <span class="fu">=</span></a>
<a class="sourceLine" id="cb11-9" data-line-number="9">  testName <span class="st">&quot;impl(true,p) == p&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-10" data-line-number="10">  \p <span class="ot">-&gt;</span> eq (impl <span class="dt">True</span> p) p</a>
<a class="sourceLine" id="cb11-11" data-line-number="11"></a>
<a class="sourceLine" id="cb11-12" data-line-number="12"></a>
<a class="sourceLine" id="cb11-13" data-line-number="13"><span class="ot">_test_impl_reflexive ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb11-14" data-line-number="14">_test_impl_reflexive <span class="fu">=</span></a>
<a class="sourceLine" id="cb11-15" data-line-number="15">  testName <span class="st">&quot;impl(p,p) == true&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-16" data-line-number="16">  \p <span class="ot">-&gt;</span> eq (impl p p) <span class="dt">True</span></a>
<a class="sourceLine" id="cb11-17" data-line-number="17"></a>
<a class="sourceLine" id="cb11-18" data-line-number="18"></a>
<a class="sourceLine" id="cb11-19" data-line-number="19"><span class="ot">_test_impl_total ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb11-20" data-line-number="20">_test_impl_total <span class="fu">=</span></a>
<a class="sourceLine" id="cb11-21" data-line-number="21">  testName <span class="st">&quot;or(impl(p,q),impl(q,p)) == true&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-22" data-line-number="22">  \p q <span class="ot">-&gt;</span> eq (or (impl p q) (impl q p)) <span class="dt">True</span></a>
<a class="sourceLine" id="cb11-23" data-line-number="23"></a>
<a class="sourceLine" id="cb11-24" data-line-number="24"></a>
<a class="sourceLine" id="cb11-25" data-line-number="25"><span class="ot">_test_impl_antecedents_commute ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb11-26" data-line-number="26">_test_impl_antecedents_commute <span class="fu">=</span></a>
<a class="sourceLine" id="cb11-27" data-line-number="27">  testName <span class="st">&quot;impl(p,impl(q,r)) == impl(q,impl(p,r))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-28" data-line-number="28">  \p q r <span class="ot">-&gt;</span> eq (impl p (impl q r)) (impl q (impl p r))</a>
<a class="sourceLine" id="cb11-29" data-line-number="29"></a>
<a class="sourceLine" id="cb11-30" data-line-number="30"></a>
<a class="sourceLine" id="cb11-31" data-line-number="31"><span class="ot">_test_impl_transitive ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb11-32" data-line-number="32">_test_impl_transitive <span class="fu">=</span></a>
<a class="sourceLine" id="cb11-33" data-line-number="33">  testName <span class="st">&quot;impl(impl(p,q),impl(impl(q,r),impl(p,r)))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-34" data-line-number="34">  \p q r <span class="ot">-&gt;</span> impl (impl p q) (impl (impl q r) (impl p r))</a>
<a class="sourceLine" id="cb11-35" data-line-number="35"></a>
<a class="sourceLine" id="cb11-36" data-line-number="36"></a>
<a class="sourceLine" id="cb11-37" data-line-number="37"><span class="ot">_test_impl_distributive ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb11-38" data-line-number="38">_test_impl_distributive <span class="fu">=</span></a>
<a class="sourceLine" id="cb11-39" data-line-number="39">  testName <span class="st">&quot;impl(impl(p,impl(q,r)),impl(impl(p,q),impl(p,r)))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-40" data-line-number="40">  \p q r <span class="ot">-&gt;</span> impl (impl p (impl q r)) (impl (impl p q) (impl p r))</a></code></pre></div>
</p>
</div>
</div>
<p><span class="math inline">\(\bimpl\)</span> interacts with <span class="math inline">\(\band\)</span>.</p>
<div class="result">
<div class="thm">
<p>
For all <span class="math inline">\(p,q,r,s \in \bool\)</span>, if <span class="math inline">\(\bimpl(p,r)\)</span> and <span class="math inline">\(\bimpl(q,s)\)</span>, then <span class="math inline">\(\bimpl(\band(p,q),\band(r,s))\)</span>.
</p>
</div>
<div class="proof">
<p>
If <span class="math inline">\(p = \bfalse\)</span>, then <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bimpl(\band(p,q),\band(r,s)) \\
 &amp; = &amp; \bimpl(\band(\bfalse,q),\band(r,s)) \\
 &amp; = &amp; \bimpl(\bfalse,\band(r,s))
 &amp; = &amp; \btrue.
\end{eqnarray*}\]</span> Similarly if <span class="math inline">\(q = \bfalse\)</span>. Suppose then that <span class="math inline">\(p = q = \btrue\)</span>. Now <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \btrue \\
 &amp; = &amp; \bimpl(p,r) \\
 &amp; = &amp; \bimpl(\btrue,r) \\
 &amp; = &amp; r,
\end{eqnarray*}\]</span> and similarly <span class="math inline">\(s = \btrue\)</span>. Then <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bimpl(\band(p,q),\band(r,s)) \\
 &amp; = &amp; \bimpl(\band(\btrue,\btrue),\band(\btrue,\btrue)) \\
 &amp; = &amp; \bimpl(\btrue,\btrue) \\
 &amp; = &amp; \btrue
\end{eqnarray*}\]</span> as claimed.
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb12"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="ot">_test_impl_and_compatible ::</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">_test_impl_and_compatible <span class="fu">=</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  testName <span class="st">&quot;if and(impl(p,r),impl(q,s)) then impl(and(p,q),and(r,s))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb12-4" data-line-number="4">  \p q r s <span class="ot">-&gt;</span> <span class="kw">if</span> and (impl p r) (impl q s)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5">    <span class="kw">then</span> impl (and p q) (and r s)</a>
<a class="sourceLine" id="cb12-6" data-line-number="6">    <span class="kw">else</span> <span class="dt">True</span></a></code></pre></div>
</p>
</div>
</div>
<p>Wow, that was tedious! But we only have to do it once. :)</p>
<p>Next we nail down conditional expressions.</p>
<div class="result">
<div class="defn">
<p>
<p><a name="def-if"></a> Let <span class="math inline">\(A\)</span> be a set. We define a map <span class="math inline">\(\mathsf{if} : \bool \times A \times A \rightarrow A\)</span> by <span class="math display">\[\begin{eqnarray*}
\bif{\btrue}{u}{v}  &amp; = &amp; u \\
\bif{\bfalse}{u}{v} &amp; = &amp; v.
\end{eqnarray*}\]</span></p>
<p>In Haskell:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="ot">ifThenElse ::</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">ifThenElse <span class="dt">True</span>  x _ <span class="fu">=</span> x</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">ifThenElse <span class="dt">False</span> _ y <span class="fu">=</span> y</a></code></pre></div>
</p>
</div>
</div>
<p>Now <span class="math inline">\(\bif{\ast}{\ast}{\ast}\)</span> also satisfies some useful properties; for instance, it interacts with not in the first argument:</p>
<div class="result">
<div class="thm">
<p>
<a name="thm-ifnot"></a> Let <span class="math inline">\(A\)</span> be a set with <span class="math inline">\(p \in \bool\)</span> and <span class="math inline">\(a,b \in A\)</span>. We have <span class="math display">\[\bif{\bnot(p)}{a}{b} = \bif{p}{b}{a}.\]</span>
</p>
</div>
<div class="proof">
<p>
If <span class="math inline">\(p = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{\bnot(p)}{a}{b} \\
 &amp; = &amp; \bif{\bnot(\btrue)}{a}{b} \\
 &amp; = &amp; \bif{\bfalse}{a}{b} \\
 &amp; = &amp; b \\
 &amp; = &amp; \bif{\btrue}{b}{a} \\
 &amp; = &amp; \bif{p}{b}{a},
\end{eqnarray*}\]</span> and if <span class="math inline">\(p = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{\bnot(p)}{a}{b} \\
 &amp; = &amp; \bif{\bnot(\bfalse)}{a}{b} \\
 &amp; = &amp; \bif{\btrue}{a}{b} \\
 &amp; = &amp; a \\
 &amp; = &amp; \bif{\bfalse}{b}{a} \\
 &amp; = &amp; \bif{p}{b}{a},
\end{eqnarray*}\]</span> as needed.
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb14"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="ot">_test_if_not ::</span> (<span class="dt">Equal</span> a) <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">_test_if_not _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  testName <span class="st">&quot;if(not(p),a,b) == if(p,b,a)&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">  \p a b <span class="ot">-&gt;</span> eq (ifThenElse (not p) a b) (ifThenElse p b a)</a></code></pre></div>
</p>
</div>
</div>
<p>If interacts with function application:</p>
<div class="result">
<div class="thm">
<p>
<a name="thm-iffunc"></a> Let <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> be sets with <span class="math inline">\(f : A \rightarrow B\)</span> a map. For all <span class="math inline">\(p \in \bool\)</span> and <span class="math inline">\(u,v \in A\)</span>, we have <span class="math display">\[f(\bif{p}{u}{v}) = \bif{p}{f(u)}{f(v)}.\]</span>
</p>
</div>
<div class="proof">
<p>
If <span class="math inline">\(p = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; f(\bif{p}{u}{v}) \\
 &amp; = &amp; f(\bif{\btrue}{u}{v}) \\
 &amp; = &amp; f(u) \\
 &amp; = &amp; \bif{\btrue}{f(u)}{f(v)} \\
 &amp; = &amp; \bif{p}{f(u)}{f(v)}
\end{eqnarray*}\]</span> as claimed. If <span class="math inline">\(p = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; f(\bif{p}{u}{v}) \\
 &amp; = &amp; f(\bif{\bfalse}{u}{v}) \\
 &amp; = &amp; f(v) \\
 &amp; = &amp; \bif{\bfalse}{f(u)}{f(v)} \\
 &amp; = &amp; \bif{p}{f(u)}{f(v)}
\end{eqnarray*}\]</span> as claimed.
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb15"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="ot">_test_if_func ::</span> (<span class="dt">Equal</span> a)</a>
<a class="sourceLine" id="cb15-2" data-line-number="2">  <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Test</span> ((a <span class="ot">-&gt;</span> a) <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">_test_if_func _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  testName <span class="st">&quot;f(if(p,a,b)) == if(p,f(a),f(b))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5">  \f p a b <span class="ot">-&gt;</span> eq (f (ifThenElse p a b)) (ifThenElse p (f a) (f b))</a></code></pre></div>
</p>
</div>
</div>
<p>Nested <span class="math inline">\(\bif{\ast}{\ast}{\ast}\)</span>s commute (sort of).</p>
<div class="result">
<div class="thm">
<p>
<a name="thm-ifnest"></a> Let <span class="math inline">\(A\)</span> be a set with <span class="math inline">\(p,q \in \bool\)</span> and <span class="math inline">\(a,b,c,d \in A\)</span>. Then we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{\bif{q}{a}{b}}{\bif{q}{c}{d}} \\
 &amp; = &amp; \bif{q}{\bif{p}{a}{c}}{\bif{p}{b}{d}}.
\end{eqnarray*}\]</span>
</p>
</div>
<div class="proof">
<p>
We have four possibilities for <span class="math inline">\((p,q)\)</span>. If <span class="math inline">\(p = \btrue\)</span> and <span class="math inline">\(q = \btrue\)</span>, <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{\bif{q}{a}{b}}{\bif{q}{c}{d}} \\
 &amp; = &amp; \bif{\btrue}{\bif{\btrue}{a}{b}}{\bif{q}{c}{d}} \\
 &amp; = &amp; \bif{\btrue}{a}{b} \\
 &amp; = &amp; a \\
 &amp; = &amp; \bif{\btrue}{a}{c} \\
 &amp; = &amp; \bif{\btrue}{\bif{\btrue}{a}{c}}{\bif{p}{b}{d}} \\
 &amp; = &amp; \bif{q}{\bif{p}{a}{c}}{\bif{p}{b}{d}} \\
\end{eqnarray*}\]</span> as claimed. If <span class="math inline">\(p = \btrue\)</span> and <span class="math inline">\(q = \bfalse\)</span>, <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{\bif{q}{a}{b}}{\bif{q}{c}{d}} \\
 &amp; = &amp; \bif{\btrue}{\bif{\bfalse}{a}{b}}{\bif{q}{c}{d}} \\
 &amp; = &amp; \bif{\bfalse}{a}{b} \\
 &amp; = &amp; b \\
 &amp; = &amp; \bif{\btrue}{b}{d} \\
 &amp; = &amp; \bif{\bfalse}{\bif{p}{a}{c}}{\bif{\btrue}{b}{d}} \\
 &amp; = &amp; \bif{q}{\bif{p}{a}{c}}{\bif{p}{b}{d}} \\
\end{eqnarray*}\]</span> as claimed. If <span class="math inline">\(p = \bfalse\)</span> and <span class="math inline">\(q = \btrue\)</span>, <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{\bif{q}{a}{b}}{\bif{q}{c}{d}} \\
 &amp; = &amp; \bif{\bfalse}{\bif{q}{a}{b}}{\bif{\btrue}{c}{d}} \\
 &amp; = &amp; \bif{\btrue}{c}{d} \\
 &amp; = &amp; c \\
 &amp; = &amp; \bif{\bfalse}{a}{c} \\
 &amp; = &amp; \bif{\btrue}{\bif{\bfalse}{a}{c}}{\bif{p}{b}{d}} \\
 &amp; = &amp; \bif{q}{\bif{p}{a}{c}}{\bif{p}{b}{d}} \\
\end{eqnarray*}\]</span> as claimed. If <span class="math inline">\(p = \bfalse\)</span> and <span class="math inline">\(q = \bfalse\)</span>, <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{\bif{q}{a}{b}}{\bif{q}{c}{d}} \\
 &amp; = &amp; \bif{\bfalse}{\bif{q}{a}{b}}{\bif{\bfalse}{c}{d}} \\
 &amp; = &amp; \bif{\bfalse}{c}{d} \\
 &amp; = &amp; d \\
 &amp; = &amp; \bif{\bfalse}{b}{d} \\
 &amp; = &amp; \bif{\bfalse}{\bif{p}{a}{c}}{\bif{\bfalse}{b}{d}} \\
 &amp; = &amp; \bif{q}{\bif{p}{a}{c}}{\bif{p}{b}{d}} \\
\end{eqnarray*}\]</span> as claimed.
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb16"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="ot">_test_if_nest ::</span> (<span class="dt">Equal</span> a)</a>
<a class="sourceLine" id="cb16-2" data-line-number="2">  <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">_test_if_nest _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb16-4" data-line-number="4">  testName <span class="st">&quot;if(p,if(q,a,b),if(q,c,d)) == if(q,if(p,a,c),if(p,b,d))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb16-5" data-line-number="5">  \p q a b c d <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb16-6" data-line-number="6">    eq</a>
<a class="sourceLine" id="cb16-7" data-line-number="7">      (ifThenElse p (ifThenElse q a b) (ifThenElse q c d))</a>
<a class="sourceLine" id="cb16-8" data-line-number="8">      (ifThenElse q (ifThenElse p a c) (ifThenElse p b d))</a></code></pre></div>
</p>
</div>
</div>
<p>Nested ifs on the same boolean can be pruned.</p>
<div class="result">
<div class="thm">
<p>
<p><a name="thm-ifprune"></a> Let <span class="math inline">\(A\)</span> be a set with <span class="math inline">\(p \in \bool\)</span> and <span class="math inline">\(a,b,c \in A\)</span>. We have the following.</p>
<ol type="1">
<li><span class="math inline">\(\bif{p}{\bif{p}{a}{b}}{c} = \bif{p}{a}{c}\)</span></li>
<li><span class="math inline">\(\bif{p}{a}{\bif{p}{b}{c}} = \bif{p}{a}{c}\)</span></li>
</ol>
</p>
</div>
<div class="proof">
<p>
<ol type="1">
<li>If <span class="math inline">\(p = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{\bif{p}{a}{b}}{c} \\
 &amp; = &amp; \bif{p}{\bif{\btrue}{a}{b}}{c} \\
 &amp; = &amp; \bif{p}{a}{c}
\end{eqnarray*}\]</span> as needed. If <span class="math inline">\(p = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{\bif{p}{a}{b}}{c} \\
 &amp; = &amp; \bif{\bfalse}{\bif{\bfalse}{a}{b}}{c} \\
 &amp; = &amp; c \\
 &amp; = &amp; \bif{\bfalse}{a}{c} \\
 &amp; = &amp; \bif{p}{a}{c}
\end{eqnarray*}\]</span> as needed.</li>
<li>If <span class="math inline">\(p = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{a}{\bif{p}{b}{c}} \\
 &amp; = &amp; \bif{\btrue}{a}{\bif{p}{b}{c}} \\
 &amp; = &amp; a \\
 &amp; = &amp; \bif{\btrue}{a}{c} \\
 &amp; = &amp; \bif{p}{a}{c}
\end{eqnarray*}\]</span> as claimed, and if <span class="math inline">\(p = \bfalse\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{a}{\bif{p}{b}{c}} \\
 &amp; = &amp; \bif{p}{a}{\bif{\bfalse}{b}{c}} \\
 &amp; = &amp; \bif{p}{a}{c}
\end{eqnarray*}\]</span> as claimed.</li>
</ol>
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb17"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="ot">_test_if_prune ::</span> (<span class="dt">Equal</span> a)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">  <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">_test_if_prune _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb17-4" data-line-number="4">  testName <span class="st">&quot;if(p,if(p,a,b),c) == if(p,a,c) == if(p,a,if(p,b,c))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb17-5" data-line-number="5">  \p a b c <span class="ot">-&gt;</span></a>
<a class="sourceLine" id="cb17-6" data-line-number="6">    and</a>
<a class="sourceLine" id="cb17-7" data-line-number="7">      (eq (ifThenElse p (ifThenElse p a b) c) (ifThenElse p a c))</a>
<a class="sourceLine" id="cb17-8" data-line-number="8">      (eq (ifThenElse p a (ifThenElse p b c)) (ifThenElse p a c))</a></code></pre></div>
</p>
</div>
</div>
<p><span class="math inline">\(\bif{\ast}{\ast}{\ast}\)</span> is sort of commutative.</p>
<div class="result">
<div class="thm">
<p>
Let <span class="math inline">\(A\)</span> be a set. For all <span class="math inline">\(p,q \in \bool\)</span> and <span class="math inline">\(a,b \in A\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{a}{\bif{q}{a}{b}} \\
 &amp; = &amp; \bif{q}{a}{\bif{p}{a}{b}}.
\end{eqnarray*}\]</span>
</p>
</div>
<div class="proof">
<p>
If <span class="math inline">\(p = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{a}{\bif{q}{a}{b}} \\
 &amp; = &amp; a \\
 &amp; = &amp; \bif{q}{a}{a} \\
 &amp; = &amp; \bif{q}{a}{\bif{p}{a}{c}}
\end{eqnarray*}\]</span> as claimed. Likewise, the equality holds if <span class="math inline">\(q = \btrue\)</span>. Suppose then that <span class="math inline">\(p = q = \bfalse\)</span>; now <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{p}{a}{\bif{q}{a}{b}} \\
 &amp; = &amp; \bif{q}{a}{b} \\
 &amp; = &amp; b \\
 &amp; = &amp; \bif{p}{a}{b} \\
 &amp; = &amp; \bif{q}{a}{\bif{p}{a}{b}}
\end{eqnarray*}\]</span> as claimed.
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb18"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb18-1" data-line-number="1"><span class="ot">_test_if_commute_left ::</span> (<span class="dt">Equal</span> a)</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">  <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb18-3" data-line-number="3">_test_if_commute_left _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb18-4" data-line-number="4">  testName <span class="st">&quot;if(p,a,if(q,a,b)) == if(q,a,if(p,a,b))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb18-5" data-line-number="5">  \p q a b <span class="ot">-&gt;</span> eq</a>
<a class="sourceLine" id="cb18-6" data-line-number="6">    (ifThenElse p a (ifThenElse q a b))</a>
<a class="sourceLine" id="cb18-7" data-line-number="7">    (ifThenElse q a (ifThenElse p a b))</a></code></pre></div>
</p>
</div>
</div>
<p><span class="math inline">\(\bif{\ast}{\ast}{\ast}\)</span> on booleans is equivalent to an or.</p>
<div class="result>
<div class=" thm"><p>
$$\bif{p}{\btrue}{q} = \bor(p,q).$$
</p></div>
<p>
If <span class="math inline">\(p = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{\btrue}{\btrue}{q} \\
 &amp; = &amp; \btrue \\
 &amp; = &amp; \bor(\btrue,q),
\end{eqnarray*}\]</span> and if $p = we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{\bfalse}{\btrue}{q} \\
 &amp; = &amp; q \\
 &amp; = &amp; \bor(\bfalse,q)
\end{eqnarray*}\]</span> as needed.
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb19"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="ot">_test_if_or ::</span> (<span class="dt">Equal</span> a)</a>
<a class="sourceLine" id="cb19-2" data-line-number="2">  <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Test</span> (<span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">_test_if_or _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb19-4" data-line-number="4">  testName <span class="st">&quot;if(p,true,q) == or(p,q)&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5">  \p q <span class="ot">-&gt;</span> eq (<span class="kw">if</span> p <span class="kw">then</span> <span class="dt">True</span> <span class="kw">else</span> q) (or p q)</a></code></pre></div>
</p>
</div>
<div class="sourceCode" id="cb20"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="fu">/</span>div<span class="fu">&gt;</span></a></code></pre></div>
<p><span class="math inline">\(\bif{\ast}{\ast}{\ast}\)</span> interacts with <span class="math inline">\(\bor\)</span>.</p>
<div class="result">
<div class="thm">
<p>
Let <span class="math inline">\(A\)</span> be a set with <span class="math inline">\(a,b \in A\)</span>, and let <span class="math inline">\(p,q \in \bool\)</span>. Then we have <span class="math display">\[\bif{p}{a}{\bif{q}{a}{b}} = \bif{\bor(p,q)}{a}{b}.\]</span>
</p>
</div>
<div class="proof">
<p>
If <span class="math inline">\(p = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{\bor(p,q)}{a}{b} \\
 &amp; = &amp; \bif{\btrue}{a}{b} \\
 &amp; = &amp; a
 &amp; = &amp; \bif{\btrue}{a}{\bif{q}{a}{b}} \\
 &amp; = &amp; \bif{p}{a}{\bif{q}{a}{b}}
\end{eqnarray*}\]</span> as needed, and if <span class="math inline">\(p = \bfalse\)</span> we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; \bif{\bor(p,q)}{a}{b} \\
 &amp; = &amp; \bif{q}{a}{b} \\
 &amp; = &amp; \bif{\bfalse}{a}{\bif{q}{a}{b}} \\
 &amp; = &amp; \bif{p}{a}{\bif{q}{a}{b}}
\end{eqnarray*}\]</span> as needed.
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb21"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="ot">_test_if_or_nest ::</span> (<span class="dt">Equal</span> a)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2">  <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Test</span> (a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">_test_if_or_nest _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb21-4" data-line-number="4">  testName <span class="st">&quot;if(or(p,q),a,b) == if(p,a,if(q,a,b))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5">  \a b p q <span class="ot">-&gt;</span> eq</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">    (<span class="kw">if</span> or p q <span class="kw">then</span> a <span class="kw">else</span> b)</a>
<a class="sourceLine" id="cb21-7" data-line-number="7">    (<span class="kw">if</span> p <span class="kw">then</span> a <span class="kw">else</span> <span class="kw">if</span> q <span class="kw">then</span> a <span class="kw">else</span> b)</a></code></pre></div>
</p>
</div>
</div>
<p><span class="math inline">\(\bif{\ast}{\ast}{\ast}\)</span> interacts with functions of two arguments.</p>
<div class="result">
<div class="thm">
<p>
We have <span class="math display">\[f(\bif{p}{a}{c},\bif{p}{b}{d}) = \bif{p}{f(a,b)}{f(c,d)}.\]</span>
</p>
</div>
<div class="proof">
<p>
If <span class="math inline">\(p = \btrue\)</span>, we have <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; f(\bif{p}{a}{c},\bif{p}{b}{d}) \\
 &amp; = &amp; f(a,b)
\end{eqnarray*}\]</span> and if $p = , <span class="math display">\[\begin{eqnarray*}
 &amp;   &amp; f(\bif{p}{a}{c},\bif{p}{b}{d}) \\
 &amp; = &amp; f(c,d)
\end{eqnarray*}\]</span> as claimed.
</p>
</div>
<div class="test">
<p>
<div class="sourceCode" id="cb22"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="ot">_test_if_two_args ::</span> (<span class="dt">Equal</span> a)</a>
<a class="sourceLine" id="cb22-2" data-line-number="2">  <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Test</span> ((a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a) <span class="ot">-&gt;</span> <span class="dt">Bool</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span>)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">_test_if_two_args _ <span class="fu">=</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4">  testName <span class="st">&quot;f(if(p,a,c),if(p,b,x)) == if(p,f(a,b),f(c,d))&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5">  \f p a b c d <span class="ot">-&gt;</span> eq</a>
<a class="sourceLine" id="cb22-6" data-line-number="6">    (f (<span class="kw">if</span> p <span class="kw">then</span> a <span class="kw">else</span> c) (<span class="kw">if</span> p <span class="kw">then</span> b <span class="kw">else</span> d))</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">    (<span class="kw">if</span> p <span class="kw">then</span> f a b <span class="kw">else</span> f c d)</a></code></pre></div>
</p>
</div>
</div>
<h2 id="equality">Equality</h2>
<p>Now that we’ve algebraified truth values, we will also algebraify equality. Typically I think of equality (as in the <span class="math inline">\(=\)</span> symbol) as a metalanguage expression. Sure, we can define a relation that captures equality on a given set, but really equality is a “logical” thing, not a “mathematical” one. We’ll express this using a type class in Haskell like so.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw">class</span> <span class="dt">Equal</span> a <span class="kw">where</span></a>
<a class="sourceLine" id="cb23-2" data-line-number="2"><span class="ot">  eq ::</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"></a>
<a class="sourceLine" id="cb23-4" data-line-number="4"><span class="ot">  neq ::</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Bool</span></a>
<a class="sourceLine" id="cb23-5" data-line-number="5">  neq x y <span class="fu">=</span> not (eq x y)</a></code></pre></div>
<p>(Why not use the built in <code>Eq</code> class? No good reason.) For example, here is the <code>Equal</code> instance for <code>Bool</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="kw">instance</span> <span class="dt">Equal</span> <span class="dt">Bool</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">  eq <span class="dt">True</span>  <span class="dt">True</span>  <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb24-3" data-line-number="3">  eq <span class="dt">True</span>  <span class="dt">False</span> <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb24-4" data-line-number="4">  eq <span class="dt">False</span> <span class="dt">True</span>  <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb24-5" data-line-number="5">  eq <span class="dt">False</span> <span class="dt">False</span> <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb24-6" data-line-number="6"></a>
<a class="sourceLine" id="cb24-7" data-line-number="7"><span class="kw">instance</span> <span class="dt">Equal</span> () <span class="kw">where</span></a>
<a class="sourceLine" id="cb24-8" data-line-number="8">  eq () () <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb24-9" data-line-number="9"></a>
<a class="sourceLine" id="cb24-10" data-line-number="10"><span class="kw">instance</span> <span class="dt">Equal</span> a <span class="ot">=&gt;</span> <span class="dt">Equal</span> (<span class="dt">Maybe</span> a) <span class="kw">where</span></a>
<a class="sourceLine" id="cb24-11" data-line-number="11">  eq <span class="dt">Nothing</span>  <span class="dt">Nothing</span>  <span class="fu">=</span> <span class="dt">True</span></a>
<a class="sourceLine" id="cb24-12" data-line-number="12">  eq <span class="dt">Nothing</span>  (<span class="dt">Just</span> _) <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb24-13" data-line-number="13">  eq (<span class="dt">Just</span> _) <span class="dt">Nothing</span>  <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb24-14" data-line-number="14">  eq (<span class="dt">Just</span> x) (<span class="dt">Just</span> y) <span class="fu">=</span> eq x y</a>
<a class="sourceLine" id="cb24-15" data-line-number="15"></a>
<a class="sourceLine" id="cb24-16" data-line-number="16"><span class="kw">instance</span> (<span class="dt">Equal</span> a, <span class="dt">Equal</span> b) <span class="ot">=&gt;</span> <span class="dt">Equal</span> (a,b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb24-17" data-line-number="17">  eq (a1,b1) (a2,b2) <span class="fu">=</span> and (eq a1 a2) (eq b1 b2)</a>
<a class="sourceLine" id="cb24-18" data-line-number="18"></a>
<a class="sourceLine" id="cb24-19" data-line-number="19"><span class="kw">instance</span> (<span class="dt">Equal</span> a, <span class="dt">Equal</span> b) <span class="ot">=&gt;</span> <span class="dt">Equal</span> (<span class="dt">Either</span> a b) <span class="kw">where</span></a>
<a class="sourceLine" id="cb24-20" data-line-number="20">  eq (<span class="dt">Left</span> a1)  (<span class="dt">Left</span> a2)  <span class="fu">=</span> eq a1 a2</a>
<a class="sourceLine" id="cb24-21" data-line-number="21">  eq (<span class="dt">Left</span> a1)  (<span class="dt">Right</span> b2) <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb24-22" data-line-number="22">  eq (<span class="dt">Right</span> b1) (<span class="dt">Left</span> a2)  <span class="fu">=</span> <span class="dt">False</span></a>
<a class="sourceLine" id="cb24-23" data-line-number="23">  eq (<span class="dt">Right</span> b1) (<span class="dt">Right</span> b2) <span class="fu">=</span> eq b1 b2</a></code></pre></div>
<h2 id="testing">Testing</h2>
<p>One of our main uses for <code>Bool</code> will be checking the results of tests, so this is as good a place as any to introduce a couple of QuickCheck helper functions for this.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw">type</span> <span class="dt">Test</span> prop <span class="fu">=</span> (<span class="dt">String</span>, prop)</a>
<a class="sourceLine" id="cb25-2" data-line-number="2"></a>
<a class="sourceLine" id="cb25-3" data-line-number="3"><span class="ot">testName ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> prop <span class="ot">-&gt;</span> <span class="dt">Test</span> prop</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">testName name prop <span class="fu">=</span> (name, prop)</a>
<a class="sourceLine" id="cb25-5" data-line-number="5"></a>
<a class="sourceLine" id="cb25-6" data-line-number="6"><span class="ot">runTest ::</span> <span class="dt">Testable</span> prop <span class="ot">=&gt;</span> <span class="dt">Args</span> <span class="ot">-&gt;</span> <span class="dt">Test</span> prop <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb25-7" data-line-number="7">runTest args (name, prop) <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb25-8" data-line-number="8">  putStrLn (<span class="st">&quot;\x1b[1;34m&quot;</span> <span class="fu">++</span> name <span class="fu">++</span> <span class="st">&quot;\x1b[0;39;49m&quot;</span>)</a>
<a class="sourceLine" id="cb25-9" data-line-number="9">  result <span class="ot">&lt;-</span> quickCheckWithResult args prop</a>
<a class="sourceLine" id="cb25-10" data-line-number="10">  <span class="kw">if</span> isSuccess result</a>
<a class="sourceLine" id="cb25-11" data-line-number="11">    <span class="kw">then</span> return ()</a>
<a class="sourceLine" id="cb25-12" data-line-number="12">    <span class="kw">else</span> putStrLn (show result) <span class="fu">&gt;&gt;</span> exitFailure</a>
<a class="sourceLine" id="cb25-13" data-line-number="13"></a>
<a class="sourceLine" id="cb25-14" data-line-number="14"><span class="ot">testLabel ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb25-15" data-line-number="15">testLabel msg <span class="fu">=</span> putStrLn (<span class="st">&quot;\n\x1b[1;32m&quot;</span> <span class="fu">++</span> msg <span class="fu">++</span> <span class="st">&quot;\x1b[0;39;49m&quot;</span>)</a>
<a class="sourceLine" id="cb25-16" data-line-number="16"></a>
<a class="sourceLine" id="cb25-17" data-line-number="17"><span class="ot">testLabel1 ::</span> (<span class="dt">TypeName</span> a) <span class="ot">=&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb25-18" data-line-number="18">testLabel1 str a <span class="fu">=</span> testLabel <span class="fu">$</span> concat</a>
<a class="sourceLine" id="cb25-19" data-line-number="19">  [ str, <span class="st">&quot;: &quot;</span>, typeName a ]</a>
<a class="sourceLine" id="cb25-20" data-line-number="20"></a>
<a class="sourceLine" id="cb25-21" data-line-number="21"><span class="ot">testLabel2 ::</span> (<span class="dt">TypeName</span> a, <span class="dt">TypeName</span> b) <span class="ot">=&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb25-22" data-line-number="22">testLabel2 str a b <span class="fu">=</span> testLabel <span class="fu">$</span> concat</a>
<a class="sourceLine" id="cb25-23" data-line-number="23">  [ str, <span class="st">&quot;: &quot;</span>, typeName a, <span class="st">&quot;, &quot;</span>, typeName b ]</a>
<a class="sourceLine" id="cb25-24" data-line-number="24"></a>
<a class="sourceLine" id="cb25-25" data-line-number="25"><span class="ot">testLabel3 ::</span> (<span class="dt">TypeName</span> a, <span class="dt">TypeName</span> b, <span class="dt">TypeName</span> c) <span class="ot">=&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> b <span class="ot">-&gt;</span> c <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb25-26" data-line-number="26">testLabel3 str a b c <span class="fu">=</span> testLabel <span class="fu">$</span> concat</a>
<a class="sourceLine" id="cb25-27" data-line-number="27">  [ str, <span class="st">&quot;: &quot;</span>, typeName a, <span class="st">&quot;, &quot;</span>, typeName b, <span class="st">&quot;, &quot;</span>, typeName c ]</a>
<a class="sourceLine" id="cb25-28" data-line-number="28"></a>
<a class="sourceLine" id="cb25-29" data-line-number="29"></a>
<a class="sourceLine" id="cb25-30" data-line-number="30"><span class="ot">withTypeOf ::</span> a <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a</a>
<a class="sourceLine" id="cb25-31" data-line-number="31">withTypeOf x _ <span class="fu">=</span> x</a>
<a class="sourceLine" id="cb25-32" data-line-number="32"></a>
<a class="sourceLine" id="cb25-33" data-line-number="33"><span class="kw">class</span> <span class="dt">TypeName</span> t <span class="kw">where</span></a>
<a class="sourceLine" id="cb25-34" data-line-number="34"><span class="ot">  typeName ::</span> t <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb25-35" data-line-number="35"></a>
<a class="sourceLine" id="cb25-36" data-line-number="36"><span class="kw">instance</span> <span class="dt">TypeName</span> <span class="dt">Bool</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb25-37" data-line-number="37">  typeName _ <span class="fu">=</span> <span class="st">&quot;Bool&quot;</span></a></code></pre></div>
<p>And the suite:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="ot">_test_boolean ::</span> (<span class="dt">Equal</span> a, <span class="dt">Arbitrary</span> a, <span class="dt">CoArbitrary</span> a, <span class="dt">Show</span> a)</a>
<a class="sourceLine" id="cb26-2" data-line-number="2">  <span class="ot">=&gt;</span> a <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">Int</span> <span class="ot">-&gt;</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb26-3" data-line-number="3">_test_boolean x size num <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb26-4" data-line-number="4">  testLabel <span class="st">&quot;Bool&quot;</span></a>
<a class="sourceLine" id="cb26-5" data-line-number="5"></a>
<a class="sourceLine" id="cb26-6" data-line-number="6">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb26-7" data-line-number="7">    args <span class="fu">=</span> stdArgs</a>
<a class="sourceLine" id="cb26-8" data-line-number="8">      { maxSuccess <span class="fu">=</span> num</a>
<a class="sourceLine" id="cb26-9" data-line-number="9">      , maxSize <span class="fu">=</span> size</a>
<a class="sourceLine" id="cb26-10" data-line-number="10">      }</a>
<a class="sourceLine" id="cb26-11" data-line-number="11"></a>
<a class="sourceLine" id="cb26-12" data-line-number="12">  runTest args _test_not_involutive</a>
<a class="sourceLine" id="cb26-13" data-line-number="13"></a>
<a class="sourceLine" id="cb26-14" data-line-number="14">  runTest args _test_and_false</a>
<a class="sourceLine" id="cb26-15" data-line-number="15">  runTest args _test_and_true</a>
<a class="sourceLine" id="cb26-16" data-line-number="16">  runTest args _test_and_not</a>
<a class="sourceLine" id="cb26-17" data-line-number="17">  runTest args _test_and_idempotent</a>
<a class="sourceLine" id="cb26-18" data-line-number="18">  runTest args _test_and_commutative</a>
<a class="sourceLine" id="cb26-19" data-line-number="19">  runTest args _test_and_associative</a>
<a class="sourceLine" id="cb26-20" data-line-number="20"></a>
<a class="sourceLine" id="cb26-21" data-line-number="21">  runTest args _test_or_true</a>
<a class="sourceLine" id="cb26-22" data-line-number="22">  runTest args _test_or_false</a>
<a class="sourceLine" id="cb26-23" data-line-number="23">  runTest args _test_or_not</a>
<a class="sourceLine" id="cb26-24" data-line-number="24">  runTest args _test_or_idempotent</a>
<a class="sourceLine" id="cb26-25" data-line-number="25">  runTest args _test_or_commutative</a>
<a class="sourceLine" id="cb26-26" data-line-number="26">  runTest args _test_or_associative</a>
<a class="sourceLine" id="cb26-27" data-line-number="27"></a>
<a class="sourceLine" id="cb26-28" data-line-number="28">  runTest args _test_not_and</a>
<a class="sourceLine" id="cb26-29" data-line-number="29">  runTest args _test_not_or</a>
<a class="sourceLine" id="cb26-30" data-line-number="30">  runTest args _test_and_or</a>
<a class="sourceLine" id="cb26-31" data-line-number="31">  runTest args _test_or_and</a>
<a class="sourceLine" id="cb26-32" data-line-number="32"></a>
<a class="sourceLine" id="cb26-33" data-line-number="33">  runTest args _test_impl_false</a>
<a class="sourceLine" id="cb26-34" data-line-number="34">  runTest args _test_impl_true</a>
<a class="sourceLine" id="cb26-35" data-line-number="35">  runTest args _test_impl_reflexive</a>
<a class="sourceLine" id="cb26-36" data-line-number="36">  runTest args _test_impl_total</a>
<a class="sourceLine" id="cb26-37" data-line-number="37">  runTest args _test_impl_antecedents_commute</a>
<a class="sourceLine" id="cb26-38" data-line-number="38">  runTest args _test_impl_transitive</a>
<a class="sourceLine" id="cb26-39" data-line-number="39">  runTest args _test_impl_distributive</a>
<a class="sourceLine" id="cb26-40" data-line-number="40">  runTest args _test_impl_and_compatible</a>
<a class="sourceLine" id="cb26-41" data-line-number="41"></a>
<a class="sourceLine" id="cb26-42" data-line-number="42">  runTest args (_test_if_not x)</a>
<a class="sourceLine" id="cb26-43" data-line-number="43">  runTest args (_test_if_func x)</a>
<a class="sourceLine" id="cb26-44" data-line-number="44">  runTest args (_test_if_nest x)</a>
<a class="sourceLine" id="cb26-45" data-line-number="45">  runTest args (_test_if_prune x)</a>
<a class="sourceLine" id="cb26-46" data-line-number="46">  runTest args (_test_if_commute_left x)</a>
<a class="sourceLine" id="cb26-47" data-line-number="47">  runTest args (_test_if_or x)</a>
<a class="sourceLine" id="cb26-48" data-line-number="48">  runTest args (_test_if_or_nest x)</a>
<a class="sourceLine" id="cb26-49" data-line-number="49">  runTest args (_test_if_two_args x)</a></code></pre></div>
<p>Main:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="ot">main_boolean ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">main_boolean <span class="fu">=</span> _test_boolean <span class="dt">True</span> <span class="dv">20</span> <span class="dv">100</span></a></code></pre></div>



<!-- END BODY -->
</div>

<div id="footer">
  Site generated by
  <a href="http://jaspervdj.be/hakyll">Hakyll</a>
</div>
</body>
</html>
