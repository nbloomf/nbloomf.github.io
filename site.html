<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>nbloomf.blog - site.lhs</title>
<link rel="stylesheet" type="text/css" href="./css/default.css" />
<link rel="icon" href="./raw/gfx/icon/favicon-32.png" />
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="./raw/gfx/icon/favicon-57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="./raw/gfx/icon/favicon-114.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="./raw/gfx/icon/favicon-152.png" />
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>

<body>
<div id="header">
  <div id="logo">
    <a href="./index.html">nbloomf</a>
  </div>
  <div id="navigation">
    <a href="./index.html">Home</a>
    <a href="./pages/about.html">About</a>
    <a href="./pages/projects.html">Projects</a>
    <a href="./archive.html">Blog</a>
  </div>
</div>

<div id="content">
<h1>site.lhs</h1>
<!-- BEGIN CONTENT -->
<p>It is traditional for sites built with Hakyll to provide the code used to generate them: here is mine. I borrowed heavily from Hakyll’s default example and from other sites to cobble this together; maybe someone else will find it useful.</p>
<p>This post is literate Haskell; code lines start with a <code>&gt;</code>, and all other lines (even lines that look like code!) are comments.</p>
<p>This file is not static and was not written all at once. Over time new bits get added and old bits get changed as my needs evolve.</p>
<h2 id="frontmatter">Frontmatter</h2>
<p>As usual we begin with some pragmas and imports, to be used later. The <code>OverloadedStrings</code> pragma allows us to define globs and filenames as ordinary strings; otherwise we’d be saying <code>fromGlob</code> everywhere.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="ot">{-# LANGUAGE OverloadedStrings #-}</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">module</span> <span class="dt">Main</span> <span class="kw">where</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw">import</span> <span class="dt">Hakyll</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw">import</span> <span class="dt">Hakyll.Shortcode</span></a>
<a class="sourceLine" id="cb1-7" data-line-number="7"><span class="kw">import</span> <span class="dt">Control.Monad</span> (foldM)</a>
<a class="sourceLine" id="cb1-8" data-line-number="8"><span class="kw">import</span> <span class="dt">Data.Monoid</span> (mconcat)</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"><span class="kw">import</span> <span class="dt">Data.List.Utils</span> (replace)</a>
<a class="sourceLine" id="cb1-10" data-line-number="10"><span class="kw">import</span> <span class="dt">Data.Maybe</span> (catMaybes)</a>
<a class="sourceLine" id="cb1-11" data-line-number="11"><span class="kw">import</span> <span class="kw">qualified</span> <span class="dt">Data.Set</span> <span class="kw">as</span> <span class="dt">S</span> (fromList, union)</a>
<a class="sourceLine" id="cb1-12" data-line-number="12"><span class="kw">import</span> <span class="dt">Text.Pandoc.Options</span> </a>
<a class="sourceLine" id="cb1-13" data-line-number="13">  ( <span class="dt">Extension</span>(<span class="fu">..</span>)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14">  , enableExtension</a>
<a class="sourceLine" id="cb1-15" data-line-number="15">  , readerExtensions</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">  , writerExtensions</a>
<a class="sourceLine" id="cb1-17" data-line-number="17">  , writerHTMLMathMethod</a>
<a class="sourceLine" id="cb1-18" data-line-number="18">  , <span class="dt">HTMLMathMethod</span>(<span class="dt">MathJax</span>)</a>
<a class="sourceLine" id="cb1-19" data-line-number="19">  )</a></code></pre></div>
<h2 id="the-main-function">The Main Function</h2>
<p>Hakyll is a declarative DSL for building static websites. A typical Hakyll program is of the following form:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="ot">main ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">main <span class="fu">=</span> hakyllWith config rules</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="ot">rules ::</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">rules <span class="fu">=</span> undefined</a></code></pre></div>
<p>where <code>Rules</code> is a special monad for turning source files into web pages. Come to think of it, Hakyll feels a lot like <code>make</code>. The examples in the Hakyll docs typically define an element of <code>Rules</code> using one giant <code>do</code> block, maybe with smaller <code>do</code> blocks nested in it. I’m not a big fan of this style. Personally I prefer smaller functions with good names and explicit type signatures, so instead I will break up the rules into separate functions. Here’s my <code>main</code>:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="ot">main ::</span> <span class="dt">IO</span> ()</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">main <span class="fu">=</span> hakyllWith config siteRules</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="ot">    config ::</span> <span class="dt">Configuration</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">    config <span class="fu">=</span> defaultConfiguration</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">      { previewPort <span class="fu">=</span> <span class="dv">31337</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7">      }</a>
<a class="sourceLine" id="cb3-8" data-line-number="8"></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="ot">siteRules ::</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb3-11" data-line-number="11">siteRules <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12">  <span class="co">-- gather up context</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13">  slugs <span class="ot">&lt;-</span> getSlugs <span class="st">&quot;posts/**&quot;</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14">  tags <span class="ot">&lt;-</span> buildTags <span class="st">&quot;posts/**&quot;</span> (fromCapture <span class="st">&quot;tag/*.html&quot;</span>)</a>
<a class="sourceLine" id="cb3-15" data-line-number="15"></a>
<a class="sourceLine" id="cb3-16" data-line-number="16">  <span class="co">-- convert from source</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17">  matchRawFiles</a>
<a class="sourceLine" id="cb3-18" data-line-number="18">  matchCssFiles</a>
<a class="sourceLine" id="cb3-19" data-line-number="19">  matchLoneFiles</a>
<a class="sourceLine" id="cb3-20" data-line-number="20">  matchPages slugs</a>
<a class="sourceLine" id="cb3-21" data-line-number="21">  matchClasses</a>
<a class="sourceLine" id="cb3-22" data-line-number="22">  matchProjectPages</a>
<a class="sourceLine" id="cb3-23" data-line-number="23">  matchTemplates</a>
<a class="sourceLine" id="cb3-24" data-line-number="24">  matchPosts tags slugs</a>
<a class="sourceLine" id="cb3-25" data-line-number="25"></a>
<a class="sourceLine" id="cb3-26" data-line-number="26">  <span class="co">-- create from context</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27">  createBlogArchive</a>
<a class="sourceLine" id="cb3-28" data-line-number="28">  create404</a>
<a class="sourceLine" id="cb3-29" data-line-number="29">  createTagPages tags</a></code></pre></div>
<h2 id="the-rules">The Rules</h2>
<p>The <code>matchRawFiles</code> rule handles files that should be copied verbatim, with no extra processing.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="ot">matchRawFiles ::</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">matchRawFiles <span class="fu">=</span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">    raw <span class="fu">=</span> anyPattern</a>
<a class="sourceLine" id="cb4-5" data-line-number="5">      [ <span class="st">&quot;LICENSE&quot;</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6">      , <span class="st">&quot;raw/**&quot;</span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">      , <span class="st">&quot;pdf/**&quot;</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8">      ]</a>
<a class="sourceLine" id="cb4-9" data-line-number="9">  <span class="kw">in</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10">    match raw <span class="fu">$</span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11">      route idRoute <span class="fu">&gt;&gt;</span> compile copyFileCompiler</a></code></pre></div>
<p>The <code>matchCssFiles</code> rule is almost identical to <code>matchRawFiles</code>; this time we use the Hakyll function <code>compressCssCompiler</code>, which minifies CSS. It looks like this compiler just removes extra whitespace and newlines.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="ot">matchCssFiles ::</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb5-2" data-line-number="2">matchCssFiles <span class="fu">=</span> match <span class="st">&quot;css/*&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3">  route idRoute <span class="fu">&gt;&gt;</span> compile compressCssCompiler</a></code></pre></div>
<p>The <code>matchLoneFiles</code> rule handles standalone pages, like <code>about</code> and <code>contact</code>. The easiest way to add a new page (not a post) is to add it to the list of names handled by <code>matchLoneFiles</code>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="ot">matchLoneFiles ::</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">matchLoneFiles <span class="fu">=</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">  <span class="kw">let</span></a>
<a class="sourceLine" id="cb6-4" data-line-number="4">    names <span class="fu">=</span> fromList</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">      [ <span class="st">&quot;site.lhs&quot;</span>, <span class="st">&quot;index.md&quot;</span> ]</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">  <span class="kw">in</span></a>
<a class="sourceLine" id="cb6-7" data-line-number="7">    match names <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-8" data-line-number="8">      route <span class="fu">$</span> setExtension <span class="st">&quot;html&quot;</span></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">      compile <span class="fu">$</span> getResourceBody</a>
<a class="sourceLine" id="cb6-10" data-line-number="10">        <span class="fu">&gt;&gt;=</span> pandocStringCompiler</a>
<a class="sourceLine" id="cb6-11" data-line-number="11">        <span class="fu">&gt;&gt;=</span> applyShortcodes allServices</a>
<a class="sourceLine" id="cb6-12" data-line-number="12">        <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate</a>
<a class="sourceLine" id="cb6-13" data-line-number="13">              <span class="st">&quot;templates/default.html&quot;</span> postCtx</a>
<a class="sourceLine" id="cb6-14" data-line-number="14">        <span class="fu">&gt;&gt;=</span> relativizeUrls</a>
<a class="sourceLine" id="cb6-15" data-line-number="15"></a>
<a class="sourceLine" id="cb6-16" data-line-number="16"></a>
<a class="sourceLine" id="cb6-17" data-line-number="17"><span class="ot">matchPages ::</span> [(<span class="dt">String</span>, <span class="dt">String</span>)] <span class="ot">-&gt;</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb6-18" data-line-number="18">matchPages slugs <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-19" data-line-number="19">  match <span class="st">&quot;pages/**&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb6-20" data-line-number="20">    route <span class="fu">$</span> setExtension <span class="st">&quot;html&quot;</span></a>
<a class="sourceLine" id="cb6-21" data-line-number="21">    compile <span class="fu">$</span> getResourceBody</a>
<a class="sourceLine" id="cb6-22" data-line-number="22">      <span class="fu">&gt;&gt;=</span> expandSlugs slugs</a>
<a class="sourceLine" id="cb6-23" data-line-number="23">      <span class="fu">&gt;&gt;=</span> pandocStringCompiler</a>
<a class="sourceLine" id="cb6-24" data-line-number="24">      <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate</a>
<a class="sourceLine" id="cb6-25" data-line-number="25">            <span class="st">&quot;templates/default.html&quot;</span> postCtx</a>
<a class="sourceLine" id="cb6-26" data-line-number="26">      <span class="fu">&gt;&gt;=</span> relativizeUrls</a></code></pre></div>
<p>The <code>matchPosts</code> rule is a little different from the others we’ve seen so far. It handles blog posts. But instead of listing out the source files by name, we capture them in a glob: <code>&quot;posts/*&quot;</code>. These work similarly to shell globs but (as usual) have their own quirks; see the <a href="https://jaspervdj.be/hakyll/reference/Hakyll-Core-Identifier-Pattern.html">documentation</a> for details.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="ot">matchPosts ::</span> <span class="dt">Tags</span> <span class="ot">-&gt;</span> [(<span class="dt">String</span>, <span class="dt">String</span>)] <span class="ot">-&gt;</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">matchPosts tags slugs <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3">  match (anyPattern [<span class="st">&quot;posts/**.md&quot;</span>, <span class="st">&quot;posts/**.lhs&quot;</span>]) <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4">    route <span class="fu">$</span> setExtension <span class="st">&quot;html&quot;</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"></a>
<a class="sourceLine" id="cb7-6" data-line-number="6">    <span class="kw">let</span> ctx <span class="fu">=</span> postWithTagsCtx tags</a>
<a class="sourceLine" id="cb7-7" data-line-number="7"></a>
<a class="sourceLine" id="cb7-8" data-line-number="8">    compile <span class="fu">$</span> getResourceBody</a>
<a class="sourceLine" id="cb7-9" data-line-number="9">      <span class="fu">&gt;&gt;=</span> expandSlugs slugs</a>
<a class="sourceLine" id="cb7-10" data-line-number="10">      <span class="fu">&gt;&gt;=</span> pandocStringCompiler</a>
<a class="sourceLine" id="cb7-11" data-line-number="11">      <span class="fu">&gt;&gt;=</span> applyShortcodes allServices</a>
<a class="sourceLine" id="cb7-12" data-line-number="12">      <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">            <span class="st">&quot;templates/hr.html&quot;</span> ctx</a>
<a class="sourceLine" id="cb7-14" data-line-number="14">      <span class="fu">&gt;&gt;=</span> applyTagTemplates ctx</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">            [ (<span class="st">&quot;literate-haskell&quot;</span>,</a>
<a class="sourceLine" id="cb7-16" data-line-number="16">                <span class="st">&quot;templates/literate-haskell.html&quot;</span>)</a>
<a class="sourceLine" id="cb7-17" data-line-number="17">            , (<span class="st">&quot;software-tools-in-haskell&quot;</span>,</a>
<a class="sourceLine" id="cb7-18" data-line-number="18">                <span class="st">&quot;templates/sth-tools.html&quot;</span>)</a>
<a class="sourceLine" id="cb7-19" data-line-number="19">            , (<span class="st">&quot;arithmetic-made-difficult&quot;</span>,</a>
<a class="sourceLine" id="cb7-20" data-line-number="20">                <span class="st">&quot;templates/amd.html&quot;</span>)</a>
<a class="sourceLine" id="cb7-21" data-line-number="21">            , (<span class="st">&quot;project-euler&quot;</span>,</a>
<a class="sourceLine" id="cb7-22" data-line-number="22">                <span class="st">&quot;templates/project-euler-solutions.html&quot;</span>)</a>
<a class="sourceLine" id="cb7-23" data-line-number="23">            , (<span class="st">&quot;ml&quot;</span>,</a>
<a class="sourceLine" id="cb7-24" data-line-number="24">                <span class="st">&quot;templates/ml.html&quot;</span>)</a>
<a class="sourceLine" id="cb7-25" data-line-number="25">            ]</a>
<a class="sourceLine" id="cb7-26" data-line-number="26">      <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate</a>
<a class="sourceLine" id="cb7-27" data-line-number="27">            <span class="st">&quot;templates/post.html&quot;</span> ctx</a>
<a class="sourceLine" id="cb7-28" data-line-number="28">      <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate</a>
<a class="sourceLine" id="cb7-29" data-line-number="29">            <span class="st">&quot;templates/default.html&quot;</span> ctx</a>
<a class="sourceLine" id="cb7-30" data-line-number="30">      <span class="fu">&gt;&gt;=</span> relativizeUrls</a></code></pre></div>
<p>Here we also used a custom compiler, <code>applyTagTemplate</code>, which loads a given template only if a post has a given tag. This is a cheap way to give some and only some posts a custom header or style.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb8-1" data-line-number="1">applyTagTemplates ctx ts x <span class="fu">=</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="kw">let</span> foo z (tag,temp) <span class="fu">=</span> applyTagTemplate tag temp ctx z</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="kw">in</span> foldM foo x ts</a>
<a class="sourceLine" id="cb8-4" data-line-number="4"></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"></a>
<a class="sourceLine" id="cb8-6" data-line-number="6">applyTagTemplate tag template context x <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">  path <span class="ot">&lt;-</span> getUnderlying</a>
<a class="sourceLine" id="cb8-8" data-line-number="8">  tags <span class="ot">&lt;-</span> getTags path</a>
<a class="sourceLine" id="cb8-9" data-line-number="9">  <span class="kw">if</span> elem tag tags</a>
<a class="sourceLine" id="cb8-10" data-line-number="10">    <span class="kw">then</span> loadAndApplyTemplate template context x</a>
<a class="sourceLine" id="cb8-11" data-line-number="11">    <span class="kw">else</span> return x</a></code></pre></div>
<p>We also apply a custom filter for converting “shortcodes” (borrowing a WordPress term) into <code>iframes</code>. This is inspired by code shamelessly cribbed from <a href="http://www.jonashietala.se/blog/2014/09/01/embedding_youtube_videos_with_hakyll/">Jonas Hietala</a> (<a href="http://web.archive.org/web/20161005181904/http://www.jonashietala.se/blog/2014/09/01/embedding_youtube_videos_with_hakyll/">archive</a>), but the guts are in a separate library, <a href="https://github.com/nbloomf/hakyll-shortcode"><code>hakyll-shortcode</code></a>.</p>
<p>The <code>matchClasses</code> rule is similar to <code>matchPosts</code>; it handles the source files for my course pages.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="ot">matchClasses ::</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">matchClasses <span class="fu">=</span> match <span class="st">&quot;classes/**&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">  route <span class="fu">$</span> setExtension <span class="st">&quot;html&quot;</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4">  compile <span class="fu">$</span> getResourceBody</a>
<a class="sourceLine" id="cb9-5" data-line-number="5">    <span class="fu">&gt;&gt;=</span> pandocStringCompiler</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">    <span class="fu">&gt;&gt;=</span> applyShortcodes allServices</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">          <span class="st">&quot;templates/default.html&quot;</span> postCtx</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">    <span class="fu">&gt;&gt;=</span> relativizeUrls</a></code></pre></div>
<p>The <code>matchProjectPages</code> rule is also similar to <code>matchPosts</code>; these rules are separated so we can use custom templates.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="ot">matchProjectPages ::</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb10-2" data-line-number="2">matchProjectPages <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">  match <span class="st">&quot;pages/sth/tool/*&quot;</span> <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4">    route <span class="fu">$</span> setExtension <span class="st">&quot;html&quot;</span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5">    compile <span class="fu">$</span> getResourceBody</a>
<a class="sourceLine" id="cb10-6" data-line-number="6">      <span class="fu">&gt;&gt;=</span> pandocStringCompiler</a>
<a class="sourceLine" id="cb10-7" data-line-number="7">      <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate</a>
<a class="sourceLine" id="cb10-8" data-line-number="8">            <span class="st">&quot;templates/sth-tools.html&quot;</span> defaultContext</a>
<a class="sourceLine" id="cb10-9" data-line-number="9">      <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate</a>
<a class="sourceLine" id="cb10-10" data-line-number="10">            <span class="st">&quot;templates/default.html&quot;</span>   defaultContext</a>
<a class="sourceLine" id="cb10-11" data-line-number="11">      <span class="fu">&gt;&gt;=</span> relativizeUrls</a></code></pre></div>
<p>The <code>matchTemplates</code> rule simply loads our HTML templates for use by Hakyll (I think).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb11-1" data-line-number="1">matchTemplates <span class="fu">=</span> match <span class="st">&quot;templates/**&quot;</span> <span class="fu">$</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">  compile templateCompiler</a></code></pre></div>
<p>The <code>createBlogArchive</code> rule is different from the others as it generates a new file, rather than simply transforming an existing file.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="ot">createBlogArchive ::</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb12-2" data-line-number="2">createBlogArchive <span class="fu">=</span> create [<span class="st">&quot;archive.html&quot;</span>] <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb12-3" data-line-number="3">  route idRoute</a>
<a class="sourceLine" id="cb12-4" data-line-number="4">  compile <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb12-5" data-line-number="5">    posts <span class="ot">&lt;-</span> recentFirst <span class="fu">=&lt;&lt;</span> loadAll <span class="st">&quot;posts/**&quot;</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"></a>
<a class="sourceLine" id="cb12-7" data-line-number="7">    <span class="kw">let</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8">      archiveCtx <span class="fu">=</span> mconcat</a>
<a class="sourceLine" id="cb12-9" data-line-number="9">        [ listField <span class="st">&quot;posts&quot;</span> postCtx (return posts)</a>
<a class="sourceLine" id="cb12-10" data-line-number="10">        , constField <span class="st">&quot;title&quot;</span> <span class="st">&quot;Archives&quot;</span></a>
<a class="sourceLine" id="cb12-11" data-line-number="11">        , defaultContext</a>
<a class="sourceLine" id="cb12-12" data-line-number="12">        ]</a>
<a class="sourceLine" id="cb12-13" data-line-number="13"></a>
<a class="sourceLine" id="cb12-14" data-line-number="14">    makeItem <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb12-15" data-line-number="15">      <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/archive.html&quot;</span> archiveCtx</a>
<a class="sourceLine" id="cb12-16" data-line-number="16">      <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/default.html&quot;</span> archiveCtx</a>
<a class="sourceLine" id="cb12-17" data-line-number="17">      <span class="fu">&gt;&gt;=</span> relativizeUrls</a></code></pre></div>
<p>Custom 404 page for broken links.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="ot">create404 ::</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb13-2" data-line-number="2">create404 <span class="fu">=</span> create [<span class="st">&quot;404.html&quot;</span>] <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb13-3" data-line-number="3">  route idRoute</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">  compile <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb13-5" data-line-number="5">    <span class="kw">let</span></a>
<a class="sourceLine" id="cb13-6" data-line-number="6">      ctx <span class="fu">=</span> mconcat</a>
<a class="sourceLine" id="cb13-7" data-line-number="7">        [ constField <span class="st">&quot;title&quot;</span> <span class="st">&quot;404 - Not Found&quot;</span></a>
<a class="sourceLine" id="cb13-8" data-line-number="8">        , constField <span class="st">&quot;body&quot;</span> <span class="fu">$</span> concat</a>
<a class="sourceLine" id="cb13-9" data-line-number="9">            [ <span class="st">&quot;&lt;div class='four-oh-four'&gt;&quot;</span></a>
<a class="sourceLine" id="cb13-10" data-line-number="10">            , <span class="st">&quot;You step in the stream,&lt;br /&gt;&quot;</span></a>
<a class="sourceLine" id="cb13-11" data-line-number="11">            , <span class="st">&quot;But the water has moved on.&lt;br /&gt;&quot;</span></a>
<a class="sourceLine" id="cb13-12" data-line-number="12">            , <span class="st">&quot;This page is not here.&quot;</span></a>
<a class="sourceLine" id="cb13-13" data-line-number="13">            , <span class="st">&quot;&lt;/div&gt;&quot;</span></a>
<a class="sourceLine" id="cb13-14" data-line-number="14">            ]</a>
<a class="sourceLine" id="cb13-15" data-line-number="15">        , defaultContext</a>
<a class="sourceLine" id="cb13-16" data-line-number="16">        ]</a>
<a class="sourceLine" id="cb13-17" data-line-number="17"></a>
<a class="sourceLine" id="cb13-18" data-line-number="18">    makeItem <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb13-19" data-line-number="19">      <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/default.html&quot;</span> ctx</a></code></pre></div>
<p>The <code>createTagPages</code> rule generates a bunch of pages for each tag, and an index of all tags. Woo!</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="ot">createTagPages ::</span> <span class="dt">Tags</span> <span class="ot">-&gt;</span> <span class="dt">Rules</span> ()</a>
<a class="sourceLine" id="cb14-2" data-line-number="2">createTagPages tags <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3">  tagsRules tags <span class="fu">$</span> \tag pattern <span class="ot">-&gt;</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4">    <span class="kw">let</span> title <span class="fu">=</span> <span class="st">&quot;Posts tagged \&quot;&quot;</span> <span class="fu">++</span> tag <span class="fu">++</span> <span class="st">&quot;\&quot;&quot;</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5">    route idRoute</a>
<a class="sourceLine" id="cb14-6" data-line-number="6">    compile <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7">      posts <span class="ot">&lt;-</span> recentFirst <span class="fu">=&lt;&lt;</span> loadAll pattern</a>
<a class="sourceLine" id="cb14-8" data-line-number="8"></a>
<a class="sourceLine" id="cb14-9" data-line-number="9">      <span class="kw">let</span></a>
<a class="sourceLine" id="cb14-10" data-line-number="10">        ctx <span class="fu">=</span> mconcat</a>
<a class="sourceLine" id="cb14-11" data-line-number="11">          [ constField <span class="st">&quot;title&quot;</span> title</a>
<a class="sourceLine" id="cb14-12" data-line-number="12">          , listField <span class="st">&quot;posts&quot;</span> postCtx (return posts)</a>
<a class="sourceLine" id="cb14-13" data-line-number="13">          , defaultContext</a>
<a class="sourceLine" id="cb14-14" data-line-number="14">          ]</a>
<a class="sourceLine" id="cb14-15" data-line-number="15"></a>
<a class="sourceLine" id="cb14-16" data-line-number="16">      makeItem <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb14-17" data-line-number="17">        <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/tag.html&quot;</span> ctx</a>
<a class="sourceLine" id="cb14-18" data-line-number="18">        <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/default.html&quot;</span> ctx</a>
<a class="sourceLine" id="cb14-19" data-line-number="19">        <span class="fu">&gt;&gt;=</span> relativizeUrls</a>
<a class="sourceLine" id="cb14-20" data-line-number="20"></a>
<a class="sourceLine" id="cb14-21" data-line-number="21">  create [<span class="st">&quot;tags/index.html&quot;</span>] <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb14-22" data-line-number="22">    route idRoute</a>
<a class="sourceLine" id="cb14-23" data-line-number="23">    compile <span class="fu">$</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb14-24" data-line-number="24"></a>
<a class="sourceLine" id="cb14-25" data-line-number="25">      <span class="kw">let</span></a>
<a class="sourceLine" id="cb14-26" data-line-number="26">        ctx <span class="fu">=</span> mconcat</a>
<a class="sourceLine" id="cb14-27" data-line-number="27">          [ constField <span class="st">&quot;title&quot;</span> <span class="st">&quot;Tags&quot;</span> </a>
<a class="sourceLine" id="cb14-28" data-line-number="28">          , defaultContext</a>
<a class="sourceLine" id="cb14-29" data-line-number="29">          ]</a>
<a class="sourceLine" id="cb14-30" data-line-number="30"></a>
<a class="sourceLine" id="cb14-31" data-line-number="31">      renderTagList tags</a>
<a class="sourceLine" id="cb14-32" data-line-number="32">        <span class="fu">&gt;&gt;=</span> makeItem</a>
<a class="sourceLine" id="cb14-33" data-line-number="33">        <span class="fu">&gt;&gt;=</span> loadAndApplyTemplate <span class="st">&quot;templates/default.html&quot;</span> ctx</a>
<a class="sourceLine" id="cb14-34" data-line-number="34">        <span class="fu">&gt;&gt;=</span> relativizeUrls</a></code></pre></div>
<h2 id="compilers">Compilers</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="ot">postCtx ::</span> <span class="dt">Context</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">postCtx <span class="fu">=</span> mconcat</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">  [ dateField <span class="st">&quot;date&quot;</span> <span class="st">&quot;%Y-%m-%d&quot;</span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4">  , defaultContext</a>
<a class="sourceLine" id="cb15-5" data-line-number="5">  ]</a>
<a class="sourceLine" id="cb15-6" data-line-number="6"></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="ot">postWithTagsCtx ::</span> <span class="dt">Tags</span> <span class="ot">-&gt;</span> <span class="dt">Context</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8">postWithTagsCtx tags <span class="fu">=</span> mconcat</a>
<a class="sourceLine" id="cb15-9" data-line-number="9">  [ tagsField <span class="st">&quot;tags&quot;</span> tags</a>
<a class="sourceLine" id="cb15-10" data-line-number="10">  , postCtx</a>
<a class="sourceLine" id="cb15-11" data-line-number="11">  ]</a>
<a class="sourceLine" id="cb15-12" data-line-number="12"></a>
<a class="sourceLine" id="cb15-13" data-line-number="13"><span class="ot">pandocStringCompiler ::</span> <span class="dt">Item</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">Compiler</span> (<span class="dt">Item</span> <span class="dt">String</span>)</a>
<a class="sourceLine" id="cb15-14" data-line-number="14">pandocStringCompiler text <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb15-15" data-line-number="15">  pandoc <span class="ot">&lt;-</span> readPandocWith defaultHakyllReaderOptions text</a>
<a class="sourceLine" id="cb15-16" data-line-number="16">  return <span class="fu">$</span> writePandocWith customWriterOptions pandoc</a>
<a class="sourceLine" id="cb15-17" data-line-number="17"></a>
<a class="sourceLine" id="cb15-18" data-line-number="18">customReaderOptions <span class="fu">=</span> defaultHakyllReaderOptions</a>
<a class="sourceLine" id="cb15-19" data-line-number="19">  { readerExtensions <span class="fu">=</span></a>
<a class="sourceLine" id="cb15-20" data-line-number="20">      <span class="kw">let</span></a>
<a class="sourceLine" id="cb15-21" data-line-number="21">        defaults <span class="fu">=</span> readerExtensions defaultHakyllReaderOptions</a>
<a class="sourceLine" id="cb15-22" data-line-number="22"></a>
<a class="sourceLine" id="cb15-23" data-line-number="23">        exts <span class="fu">=</span></a>
<a class="sourceLine" id="cb15-24" data-line-number="24">          [ <span class="dt">Ext_fenced_divs</span></a>
<a class="sourceLine" id="cb15-25" data-line-number="25">          ]</a>
<a class="sourceLine" id="cb15-26" data-line-number="26"></a>
<a class="sourceLine" id="cb15-27" data-line-number="27">      <span class="kw">in</span></a>
<a class="sourceLine" id="cb15-28" data-line-number="28">        foldr enableExtension defaults exts</a>
<a class="sourceLine" id="cb15-29" data-line-number="29">  }</a>
<a class="sourceLine" id="cb15-30" data-line-number="30"></a>
<a class="sourceLine" id="cb15-31" data-line-number="31">customWriterOptions <span class="fu">=</span> defaultHakyllWriterOptions </a>
<a class="sourceLine" id="cb15-32" data-line-number="32">  { writerExtensions <span class="fu">=</span></a>
<a class="sourceLine" id="cb15-33" data-line-number="33">      <span class="kw">let</span></a>
<a class="sourceLine" id="cb15-34" data-line-number="34">        defaults <span class="fu">=</span> writerExtensions defaultHakyllWriterOptions</a>
<a class="sourceLine" id="cb15-35" data-line-number="35"></a>
<a class="sourceLine" id="cb15-36" data-line-number="36">        exts <span class="fu">=</span></a>
<a class="sourceLine" id="cb15-37" data-line-number="37">          [ <span class="dt">Ext_tex_math_dollars</span></a>
<a class="sourceLine" id="cb15-38" data-line-number="38">          , <span class="dt">Ext_tex_math_double_backslash</span></a>
<a class="sourceLine" id="cb15-39" data-line-number="39">          , <span class="dt">Ext_latex_macros</span></a>
<a class="sourceLine" id="cb15-40" data-line-number="40">          , <span class="dt">Ext_grid_tables</span></a>
<a class="sourceLine" id="cb15-41" data-line-number="41">          ]</a>
<a class="sourceLine" id="cb15-42" data-line-number="42">      <span class="kw">in</span></a>
<a class="sourceLine" id="cb15-43" data-line-number="43">        foldr enableExtension defaults exts</a>
<a class="sourceLine" id="cb15-44" data-line-number="44"></a>
<a class="sourceLine" id="cb15-45" data-line-number="45">  , writerHTMLMathMethod <span class="fu">=</span> <span class="dt">MathJax</span> <span class="st">&quot;&quot;</span></a>
<a class="sourceLine" id="cb15-46" data-line-number="46">  }</a></code></pre></div>
<h2 id="helpers">Helpers</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="ot">anyPattern ::</span> [<span class="dt">Pattern</span>] <span class="ot">-&gt;</span> <span class="dt">Pattern</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">anyPattern <span class="fu">=</span> foldl1 (<span class="fu">.||.</span>)</a></code></pre></div>
<p>Apply an arbitrary <code>String -&gt; String</code> function in a compiler; handy for experimenting.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="ot">mapText ::</span> (<span class="dt">Monad</span> m, <span class="dt">Functor</span> f)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">  <span class="ot">=&gt;</span> (<span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span>) <span class="ot">-&gt;</span> f <span class="dt">String</span> <span class="ot">-&gt;</span> m (f <span class="dt">String</span>)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3">mapText f text <span class="fu">=</span> return <span class="fu">$</span> fmap f text</a></code></pre></div>
<p>The next few functions give us cheap cross references. If a post has <code>slug: FOO</code> metafield, then <code>@FOO@</code> expands to the post’s URL. For example, <code>@FOO@#name</code> expands to the URL of a named anchor. If this expansion is done before pandoc does it’s magic, we can use it in links</p>
<pre><code>[like this](@FOO@#name)</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode literate haskell"><code class="sourceCode haskell"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co">-- get the (slug, url) pairs for a given pattern</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="ot">getSlugs ::</span> (<span class="dt">MonadMetadata</span> m) <span class="ot">=&gt;</span> <span class="dt">Pattern</span> <span class="ot">-&gt;</span> m [(<span class="dt">String</span>, <span class="dt">String</span>)]</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">getSlugs pattern <span class="fu">=</span> getMatches pattern <span class="fu">&gt;&gt;=</span> (fmap catMaybes <span class="fu">.</span> mapM getSlug)</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="ot">    getSlug ::</span> <span class="dt">MonadMetadata</span> m <span class="ot">=&gt;</span> <span class="dt">Identifier</span> <span class="ot">-&gt;</span> m (<span class="dt">Maybe</span> (<span class="dt">String</span>,<span class="dt">String</span>))</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">    getSlug identifier <span class="fu">=</span> <span class="kw">do</span></a>
<a class="sourceLine" id="cb19-7" data-line-number="7">      metadata <span class="ot">&lt;-</span> getMetadata identifier</a>
<a class="sourceLine" id="cb19-8" data-line-number="8">      <span class="kw">case</span> lookupString <span class="st">&quot;slug&quot;</span> metadata <span class="kw">of</span></a>
<a class="sourceLine" id="cb19-9" data-line-number="9">        <span class="dt">Nothing</span> <span class="ot">-&gt;</span> return <span class="dt">Nothing</span></a>
<a class="sourceLine" id="cb19-10" data-line-number="10">        <span class="dt">Just</span> x  <span class="ot">-&gt;</span> return <span class="fu">$</span> <span class="dt">Just</span> (x, makeURL identifier)</a>
<a class="sourceLine" id="cb19-11" data-line-number="11"></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="ot">    makeURL ::</span> <span class="dt">Identifier</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13">    makeURL <span class="fu">=</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14">      replace <span class="st">&quot;.md&quot;</span> <span class="st">&quot;.html&quot;</span> <span class="fu">.</span> replace <span class="st">&quot;.lhs&quot;</span> <span class="st">&quot;.html&quot;</span> <span class="fu">.</span> toUrl <span class="fu">.</span> toFilePath</a>
<a class="sourceLine" id="cb19-15" data-line-number="15"></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="co">-- expand the slugs</span></a>
<a class="sourceLine" id="cb19-18" data-line-number="18">expandSlugs</a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="ot">  ::</span> (<span class="dt">Functor</span> f, <span class="dt">Monad</span> m)</a>
<a class="sourceLine" id="cb19-20" data-line-number="20">  <span class="ot">=&gt;</span> [(<span class="dt">String</span>, <span class="dt">String</span>)] <span class="ot">-&gt;</span> f <span class="dt">String</span> <span class="ot">-&gt;</span> m (f <span class="dt">String</span>)</a>
<a class="sourceLine" id="cb19-21" data-line-number="21">expandSlugs slugs <span class="fu">=</span> mapText expandAll</a>
<a class="sourceLine" id="cb19-22" data-line-number="22">  <span class="kw">where</span></a>
<a class="sourceLine" id="cb19-23" data-line-number="23"><span class="ot">    expandAll ::</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb19-24" data-line-number="24">    expandAll text <span class="fu">=</span> foldr expandOne text slugs</a>
<a class="sourceLine" id="cb19-25" data-line-number="25"></a>
<a class="sourceLine" id="cb19-26" data-line-number="26"><span class="ot">    expandOne ::</span> (<span class="dt">String</span>, <span class="dt">String</span>) <span class="ot">-&gt;</span> <span class="dt">String</span> <span class="ot">-&gt;</span> <span class="dt">String</span></a>
<a class="sourceLine" id="cb19-27" data-line-number="27">    expandOne (slug,url) text <span class="fu">=</span> replace (<span class="st">&quot;@&quot;</span> <span class="fu">++</span> slug <span class="fu">++</span> <span class="st">&quot;@&quot;</span>) url text</a></code></pre></div>
<!-- END CONTENT -->
</div>

<div id="footer">
  Site generated by
  <a href="http://jaspervdj.be/hakyll">Hakyll</a>
</div>
</body>
</html>
