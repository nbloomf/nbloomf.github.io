<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>nbloomf.github.io - Software Tools in Haskell: charfullwidth</title>
<link rel="stylesheet" type="text/css" href="../../../css/default.css" />
<link rel="icon" href="../../../icon/favicon-32.png" />
<link rel="apple-touch-icon-precomposed" sizes="57x57" href="../../../icon/favicon-57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../../../icon/favicon-114.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../icon/favicon-152.png" />
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>
</head>

<body>
<div id="header">
  <div id="logo">
    <a href="../../../index.html">nbloomf</a>
  </div>
  <div id="navigation">
    <a href="../../../index.html">Home</a>
    <a href="../../../about.html">About</a>
    <a href="../../../projects.html">Projects</a>
    <a href="../../../contact.html">Contact</a>
    <a href="../../../archive.html">Blog</a>
  </div>
</div>

<div id="content">
<h1>Software Tools in Haskell: charfullwidth</h1>
<!-- BEGIN BODY -->
<h2>replace chars with fullwidth equivalents</h2>

<div class="info">
This page is part of a series on <a href="../../../pages/sth/index.html">Software Tools in Haskell</a>.
</div>

<p>Replacing “normal” characters with fullwidth forms is much simpler. We reuse the structure of <code>copy --char</code>, with a filter to map characters.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="co">-- sth-charfullwidth: replace characters with fullwidth equivalents</span>

<span class="kw">module</span> <span class="dt">Main</span> <span class="kw">where</span>

<span class="kw">import </span><span class="dt">System.Exit</span> (exitSuccess)
<span class="kw">import </span><span class="dt">STH.Lib</span> (charFilter, toFullwidth)


<span class="ot">main ::</span> <span class="dt">IO</span> ()
main <span class="fu">=</span> <span class="kw">do</span>
  charFilter (map toFullwidth)
  exitSuccess</code></pre></div>
<p>And the map:</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">toFullwidth ::</span> <span class="dt">Char</span> <span class="ot">-&gt;</span> <span class="dt">Char</span>
toFullwidth <span class="fu">=</span> applyListMap full
  <span class="kw">where</span>
    full <span class="fu">=</span>
      [ (<span class="ch">'!'</span>,<span class="ch">'！'</span>), (<span class="ch">'&quot;'</span>,<span class="ch">'＂'</span>),  (<span class="ch">'#'</span>,<span class="ch">'＃'</span>), (<span class="ch">'$'</span>,<span class="ch">'＄'</span>), (<span class="ch">'%'</span>,<span class="ch">'％'</span>)
      , (<span class="ch">'&amp;'</span>,<span class="ch">'＆'</span>), (<span class="ch">'\''</span>,<span class="ch">'＇'</span>), (<span class="ch">'('</span>,<span class="ch">'（'</span>), (<span class="ch">')'</span>,<span class="ch">'）'</span>), (<span class="ch">'*'</span>,<span class="ch">'＊'</span>)
      , (<span class="ch">'+'</span>,<span class="ch">'＋'</span>), (<span class="ch">','</span>,<span class="ch">'，'</span>),  (<span class="ch">'-'</span>,<span class="ch">'－'</span>), (<span class="ch">'.'</span>,<span class="ch">'．'</span>), (<span class="ch">'/'</span>,<span class="ch">'／'</span>)
      , (<span class="ch">'0'</span>,<span class="ch">'０'</span>), (<span class="ch">'1'</span>,<span class="ch">'１'</span>),  (<span class="ch">'2'</span>,<span class="ch">'２'</span>), (<span class="ch">'3'</span>,<span class="ch">'３'</span>), (<span class="ch">'4'</span>,<span class="ch">'４'</span>)
      , (<span class="ch">'5'</span>,<span class="ch">'５'</span>), (<span class="ch">'6'</span>,<span class="ch">'６'</span>),  (<span class="ch">'7'</span>,<span class="ch">'７'</span>), (<span class="ch">'8'</span>,<span class="ch">'８'</span>), (<span class="ch">'9'</span>,<span class="ch">'９'</span>)
      , (<span class="ch">':'</span>,<span class="ch">'：'</span>), (<span class="ch">';'</span>,<span class="ch">'；'</span>),  (<span class="ch">'&lt;'</span>,<span class="ch">'＜'</span>), (<span class="ch">'='</span>,<span class="ch">'＝'</span>), (<span class="ch">'&gt;'</span>,<span class="ch">'＞'</span>)
      , (<span class="ch">'?'</span>,<span class="ch">'？'</span>), (<span class="ch">'@'</span>,<span class="ch">'＠'</span>),  (<span class="ch">'A'</span>,<span class="ch">'Ａ'</span>), (<span class="ch">'B'</span>,<span class="ch">'Ｂ'</span>), (<span class="ch">'C'</span>,<span class="ch">'Ｃ'</span>)
      , (<span class="ch">'D'</span>,<span class="ch">'Ｄ'</span>), (<span class="ch">'E'</span>,<span class="ch">'Ｅ'</span>),  (<span class="ch">'F'</span>,<span class="ch">'Ｆ'</span>), (<span class="ch">'G'</span>,<span class="ch">'Ｇ'</span>), (<span class="ch">'H'</span>,<span class="ch">'Ｈ'</span>)
      , (<span class="ch">'I'</span>,<span class="ch">'Ｉ'</span>), (<span class="ch">'J'</span>,<span class="ch">'Ｊ'</span>),  (<span class="ch">'K'</span>,<span class="ch">'Ｋ'</span>), (<span class="ch">'L'</span>,<span class="ch">'Ｌ'</span>), (<span class="ch">'M'</span>,<span class="ch">'Ｍ'</span>)
      , (<span class="ch">'N'</span>,<span class="ch">'Ｎ'</span>), (<span class="ch">'O'</span>,<span class="ch">'Ｏ'</span>),  (<span class="ch">'P'</span>,<span class="ch">'Ｐ'</span>), (<span class="ch">'Q'</span>,<span class="ch">'Ｑ'</span>), (<span class="ch">'R'</span>,<span class="ch">'Ｒ'</span>)
      , (<span class="ch">'S'</span>,<span class="ch">'Ｓ'</span>), (<span class="ch">'T'</span>,<span class="ch">'Ｔ'</span>),  (<span class="ch">'U'</span>,<span class="ch">'Ｕ'</span>), (<span class="ch">'V'</span>,<span class="ch">'Ｖ'</span>), (<span class="ch">'W'</span>,<span class="ch">'Ｗ'</span>)
      , (<span class="ch">'X'</span>,<span class="ch">'Ｘ'</span>), (<span class="ch">'Y'</span>,<span class="ch">'Ｙ'</span>),  (<span class="ch">'Z'</span>,<span class="ch">'Ｚ'</span>), (<span class="ch">'['</span>,<span class="ch">'［'</span>), (<span class="ch">'\\'</span>,<span class="ch">'＼'</span>)
      , (<span class="ch">']'</span>,<span class="ch">'］'</span>), (<span class="ch">'^'</span>,<span class="ch">'＾'</span>),  (<span class="ch">'_'</span>,<span class="ch">'＿'</span>), (<span class="ch">'`'</span>,<span class="ch">'｀'</span>), (<span class="ch">'a'</span>,<span class="ch">'ａ'</span>)
      , (<span class="ch">'b'</span>,<span class="ch">'ｂ'</span>), (<span class="ch">'c'</span>,<span class="ch">'ｃ'</span>),  (<span class="ch">'d'</span>,<span class="ch">'ｄ'</span>), (<span class="ch">'e'</span>,<span class="ch">'ｅ'</span>), (<span class="ch">'f'</span>,<span class="ch">'ｆ'</span>)
      , (<span class="ch">'g'</span>,<span class="ch">'ｇ'</span>), (<span class="ch">'h'</span>,<span class="ch">'ｈ'</span>),  (<span class="ch">'i'</span>,<span class="ch">'ｉ'</span>), (<span class="ch">'j'</span>,<span class="ch">'ｊ'</span>), (<span class="ch">'k'</span>,<span class="ch">'ｋ'</span>)
      , (<span class="ch">'l'</span>,<span class="ch">'ｌ'</span>), (<span class="ch">'m'</span>,<span class="ch">'ｍ'</span>),  (<span class="ch">'n'</span>,<span class="ch">'ｎ'</span>), (<span class="ch">'o'</span>,<span class="ch">'ｏ'</span>), (<span class="ch">'p'</span>,<span class="ch">'ｐ'</span>)
      , (<span class="ch">'q'</span>,<span class="ch">'ｑ'</span>), (<span class="ch">'r'</span>,<span class="ch">'ｒ'</span>),  (<span class="ch">'s'</span>,<span class="ch">'ｓ'</span>), (<span class="ch">'t'</span>,<span class="ch">'ｔ'</span>), (<span class="ch">'u'</span>,<span class="ch">'ｕ'</span>)
      , (<span class="ch">'v'</span>,<span class="ch">'ｖ'</span>), (<span class="ch">'w'</span>,<span class="ch">'ｗ'</span>),  (<span class="ch">'x'</span>,<span class="ch">'ｘ'</span>), (<span class="ch">'y'</span>,<span class="ch">'ｙ'</span>), (<span class="ch">'z'</span>,<span class="ch">'ｚ'</span>)
      , (<span class="ch">'{'</span>,<span class="ch">'｛'</span>), (<span class="ch">'|'</span>,<span class="ch">'｜'</span>),  (<span class="ch">'}'</span>,<span class="ch">'｝'</span>), (<span class="ch">'~'</span>,<span class="ch">'～'</span>), (<span class="ch">' '</span>,<span class="ch">'　'</span>)
      ]</code></pre></div>
<p>This probably looks terrible in your browser because unicode coverage. The <code>applyListMap</code> function treats a list of pairs like a mapping.</p>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="ot">applyListMap ::</span> (<span class="dt">Eq</span> a) <span class="ot">=&gt;</span> [(a,a)] <span class="ot">-&gt;</span> a <span class="ot">-&gt;</span> a
applyListMap zs x <span class="fu">=</span> <span class="kw">case</span> lookup x zs <span class="kw">of</span>
  <span class="dt">Nothing</span> <span class="ot">-&gt;</span> x
  <span class="dt">Just</span> y  <span class="ot">-&gt;</span> y</code></pre></div>
<!-- END BODY -->
</div>

<div id="footer">
  Site generated by
  <a href="http://jaspervdj.be/hakyll">Hakyll</a>
</div>
</body>
</html>
